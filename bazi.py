#!/usr/bin/env python3
# -*- coding: utf-8 -*-
# Author: original authors
# CreateDate: 2019-2-21

import argparse
import collections
import pprint
import datetime
import re

from lunar_python import Lunar, Solar
from colorama import init

from datas import *
from sizi import summarys
from common import *
from yue import months

"""
Output sanitizer: remove citations (如 母法P24-41、P79-4、pd40、基56 等)、
ANSI 控制碼，並簡單規整空白，提升可讀性。
"""

_ANSI_RE = re.compile(r"\x1b\[[0-9;]*m")
_CITE_RE = re.compile(r"\b\S*P\d{1,3}-\d{1,3}\S*", re.IGNORECASE)
_NUM_RANGE_RE = re.compile(r"\b\d{1,3}-\d{1,3}\b")
_PD_RE = re.compile(r"\bpd\s*\d{1,3}\b", re.IGNORECASE)
_JI_BASE_RE = re.compile(r"(?:基礎|基础|基)\s*\d{1,3}")

_orig_print = print
GENDER_FEMALE = None  # set after argparse

def _clean_text(text: str) -> str:
    if not text:
        return text
    t = _ANSI_RE.sub("", text)
    t = _CITE_RE.sub("", t)
    t = _NUM_RANGE_RE.sub("", t)
    t = _PD_RE.sub("", t)
    t = _JI_BASE_RE.sub("", t)
    # 壓縮多餘空白
    t = re.sub(r"[ \t]{2,}", " ", t)
    # 規一化分隔線：長度較長的純連字號行，轉為等號行
    def _normalize_separators(s: str) -> str:
        lines = s.splitlines(True)
        out = []
        for ln in lines:
            core = ln.strip()
            if core and set(core) == {'-'} and len(core) >= 50:
                out.append(ln.replace('-', '='))
            else:
                out.append(ln)
        return ''.join(out)
    t = _normalize_separators(t)
    # 性別導向內容過濾
    female_keys = ("女命", "女子", "女日主", "女柱", "女性", "女：", "女:")
    male_keys = ("男命", "男日主", "男性", "男子", "男：", "男:")
    global GENDER_FEMALE
    lines = t.splitlines(True)
    filtered = []
    for ln in lines:
        ln_stripped = ln.strip()
        if not ln_stripped:
            filtered.append(ln)
            continue
        # 保留使用者指定希望顯示的內容（不再過濾相關段落）
        if GENDER_FEMALE is False:
            # 男：隱藏女向描述
            if any(k in ln for k in female_keys):
                continue
        if GENDER_FEMALE is True:
            # 女：隱藏男向描述
            if any(k in ln for k in male_keys):
                continue
        filtered.append(ln)
    t = ''.join(filtered)
    return t

def print(*args, **kwargs):  # type: ignore[override]
    sep = kwargs.pop('sep', ' ')
    end = kwargs.pop('end', '\n')
    text = sep.join(str(a) for a in args)
    _orig_print(_clean_text(text), end=end, **kwargs)

def get_gen(gan, zhis):
    zhus = []
    zhongs = []
    weis = []
    result = ""
    for item in zhis:
        zhu = zhi5_list[item][0]
        if ten_deities[gan]['本'] == ten_deities[zhu]['本']:
            zhus.append(item)

    for item in zhis:
        if len(zhi5_list[item]) ==1:
            continue
        zhong = zhi5_list[item][1]
        if ten_deities[gan]['本'] == ten_deities[zhong]['本']:
            zhongs.append(item)

    for item in zhis:
        if len(zhi5_list[item]) < 3:
            continue
        zhong = zhi5_list[item][2]
        if ten_deities[gan]['本'] == ten_deities[zhong]['本']:
            weis.append(item)

    if not (zhus or zhongs or weis):
        return "无根"
    else:
        result = result + "强：{}{}".format(''.join(zhus), chr(12288)) if zhus else result
        result = result + "中：{}{}".format(''.join(zhongs), chr(12288)) if zhongs else result
        result = result + "弱：{}".format(''.join(weis)) if weis else result
        return result


def gan_zhi_he(zhu):
    gan, zhi = zhu
    if ten_deities[gan]['合'] in zhi5[zhi]:
        return "|"
    return ""

def get_gong(zhis):
    result = []
    for i in range(3):
        if  gans[i] != gans[i+1]:
            continue
        zhi1 = zhis[i]
        zhi2 = zhis[i+1]
        if abs(Zhi.index(zhi1) - Zhi.index(zhi2)) == 2:
            value = Zhi[(Zhi.index(zhi1) + Zhi.index(zhi2))//2]
            #if value in ("丑", "辰", "未", "戌"):
            result.append(value)
        if (zhi1 + zhi2 in gong_he) and (gong_he[zhi1 + zhi2] not in zhis):
            result.append(gong_he[zhi1 + zhi2]) 
            
        #if (zhi1 + zhi2 in gong_hui) and (gong_hui[zhi1 + zhi2] not in zhis):
            #result.append(gong_hui[zhi1 + zhi2])             
        
    return result


def get_shens(gans, zhis, gan_, zhi_):
    
    all_shens = []
    for item in year_shens:
        if zhi_ in year_shens[item][zhis.year]:    
            all_shens.append(item)
                
    for item in month_shens:
        if gan_ in month_shens[item][zhis.month] or zhi_ in month_shens[item][zhis.month]:     
            all_shens.append(item)
                
    for item in day_shens:
        if zhi_ in day_shens[item][zhis.day]:     
            all_shens.append(item)
                
    for item in g_shens:
        if zhi_ in g_shens[item][me]:    
            all_shens.append(item) 
    if all_shens:  
        return "  神:" + ' '.join(all_shens)
    else:
        return ""
                
def jin_jiao(first, second):
    return True if Zhi.index(second) - Zhi.index(first) == 1 else False

def is_ku(zhi):
    return True if zhi in "辰戌丑未" else False  

def zhi_ku(zhi, items):
    return True if is_ku(zhi) and min(zhi5[zhi], key=zhi5[zhi].get) in items else False

def is_yang():
    return True if Gan.index(me) % 2 == 0 else False

def not_yang():
    return False if Gan.index(me) % 2 == 0 else True

def gan_ke(gan1, gan2):
    return True if ten_deities[gan1]['克'] == ten_deities[gan2]['本'] or ten_deities[gan2]['克'] == ten_deities[gan1]['本'] else False
    
description = '''

'''

parser = argparse.ArgumentParser(description=description,
                                 formatter_class=argparse.RawTextHelpFormatter)
parser.add_argument('year', action="store", help=u'year')
parser.add_argument('month', action="store", help=u'month')
parser.add_argument('day', action="store", help=u'day')
parser.add_argument('time', action="store",help=u'time')    
parser.add_argument("--start", help="start year", type=int, default=1850)
parser.add_argument("--end", help="end year", default='2030')
parser.add_argument('-b', action="store_true", default=False, help=u'直接输入八字')
parser.add_argument('-g', action="store_true", default=False, help=u'是否采用公历')
parser.add_argument('-r', action="store_true", default=False, help=u'是否为闰月，仅仅使用于农历')
parser.add_argument('-n', action="store_true", default=False, help=u'是否为女，默认为男')
parser.add_argument('--version', action='version',
                    version='%(prog)s 1.0 Rongzhong xu 2022 06 15')
options = parser.parse_args()
GENDER_FEMALE = options.n

Gans = collections.namedtuple("Gans", "year month day time")
Zhis = collections.namedtuple("Zhis", "year month day time")

print("-"*120)

if options.b:
    import sxtwl
    gans = Gans(year=options.year[0], month=options.month[0], 
                day=options.day[0],  time=options.time[0])
    zhis = Gans(year=options.year[1], month=options.month[1], 
                day=options.day[1],  time=options.time[1])
    jds = sxtwl.siZhu2Year(getGZ(options.year), getGZ(options.month), getGZ(options.day), getGZ(options.time), options.start, int(options.end));
    for jd in jds:
        t = sxtwl.JD2DD(jd )
        print("可能出生时间: python bazi.py -g %d %d %d %d :%d:%d"%(t.Y, t.M, t.D, t.h, t.m, round(t.s)))   
    
else:

    if options.g:
        solar = Solar.fromYmdHms(int(options.year), int(options.month), int(options.day), int(options.time), 0, 0)
        lunar = solar.getLunar()
    else:
        month_ = int(options.month)*-1 if options.r else int(options.month)
        lunar = Lunar.fromYmdHms(int(options.year), month_, int(options.day),int(options.time), 0, 0)
        solar = lunar.getSolar()

    day = lunar
    ba = lunar.getEightChar() 
    gans = Gans(year=ba.getYearGan(), month=ba.getMonthGan(), day=ba.getDayGan(), time=ba.getTimeGan())
    zhis = Zhis(year=ba.getYearZhi(), month=ba.getMonthZhi(), day=ba.getDayZhi(), time=ba.getTimeZhi())


me = gans.day
month = zhis.month
alls = list(gans) + list(zhis)
zhus = [item for item in zip(gans, zhis)]

gan_shens = []
for seq, item in enumerate(gans):    
    if seq == 2:
        gan_shens.append('--')
    else:
        gan_shens.append(ten_deities[me][item])
#print(gan_shens)

zhi_shens = [] # 地支的主气神
for item in zhis:
    d = zhi5[item]
    zhi_shens.append(ten_deities[me][max(d, key=d.get)])
#print(zhi_shens)
shens = gan_shens + zhi_shens

zhi_shens2 = [] # 地支的所有神，包含余气和尾气, 混合在一起
zhi_shen3 = [] # 地支所有神，字符串格式
for item in zhis:
    d = zhi5[item]
    tmp = ''
    for item2 in d:
        zhi_shens2.append(ten_deities[me][item2])
        tmp += ten_deities[me][item2]
    zhi_shen3.append(tmp)
shens2 = gan_shens + zhi_shens2
    


# 计算五行分数 http://www.131.com.tw/word/b3_2_14.htm

scores = {"金":0, "木":0, "水":0, "火":0, "土":0}
gan_scores = {"甲":0, "乙":0, "丙":0, "丁":0, "戊":0, "己":0, "庚":0, "辛":0,
              "壬":0, "癸":0}   

for item in gans:  
    scores[gan5[item]] += 5
    gan_scores[item] += 5


for item in list(zhis) + [zhis.month]:  
    for gan in zhi5[item]:
        scores[gan5[gan]] += zhi5[item][gan]
        gan_scores[gan] += zhi5[item][gan]


# 计算八字强弱
# 子平真诠的计算
weak = True
me_status = []
for item in zhis:
    me_status.append(ten_deities[me][item])
    if ten_deities[me][item] in ('长', '帝', '建'):
        weak = False
        

if weak:
    if shens.count('比') + me_status.count('库') >2:
        weak = False

# 计算大运
seq = Gan.index(gans.year)
if options.n:
    if seq % 2 == 0:
        direction = -1
    else:
        direction = 1
else:
    if seq % 2 == 0:
        direction = 1
    else:
        direction = -1

dayuns = []
gan_seq = Gan.index(gans.month)
zhi_seq = Zhi.index(zhis.month)
for i in range(12):
    gan_seq += direction
    zhi_seq += direction
    dayuns.append(Gan[gan_seq%10] + Zhi[zhi_seq%12])

# 网上的计算
me_attrs_ = ten_deities[me].inverse
strong = gan_scores[me_attrs_['比']] + gan_scores[me_attrs_['劫']] \
    + gan_scores[me_attrs_['枭']] + gan_scores[me_attrs_['印']]


if not options.b:
    #print("direction",direction)
    sex = '女' if options.n else '男'
    print("{}命".format(sex), end=' ')
    print("\t公历:", end=' ')
    print("{}年{}月{}日".format(solar.getYear(), solar.getMonth(), solar.getDay()), end=' ')
    yun = ba.getYun(not options.n)   
    print("  农历:", end=' ')
    print("{}年{}月{}日 穿=害 上运时间：{} 命宫:{} 胎元:{}\n".format(lunar.getYear(), lunar.getMonth(), 
        lunar.getDay(), yun.getStartSolar().toFullString().split()[0], ba.getMingGong(), ba.getTaiYuan()), end=' ')
    print("\t", siling[zhis.month], lunar.getPrevJieQi(True), lunar.getPrevJieQi(True).getSolar().toYmdHms(),lunar.getNextJieQi(True), 
        lunar.getNextJieQi(True).getSolar().toYmdHms())


print("-"*120)

#print(zhi_3hes, "生：寅申巳亥 败：子午卯酉　库：辰戌丑未")
#print("地支六合:", zhi_6hes)
out = ' '
for item in list(xiuqius[zhis.month].items()):
    out = out + "{}:{} ".format(item[0], item[1])

for item in list(scores.items()):
    out = out + " {}{} ".format(item[0], item[1])

out = "{} {}:{} {} {} {}".format(out, "强弱", strong, "中值29", "强根:", '无' if weak else '有')



print('\033[1;36;40m' + ' '.join(list(gans)), ' '*5, ' '.join(list(gan_shens)) + '\033[0m',' '*3, out)

# 输出详细分数信息
shen_qiangruo = "【身強】" if strong > 29 else "【身弱】"
print("五行分數", scores, "   八字強弱：", strong, "通常>29爲強，需要參考月份、坐支等", shen_qiangruo)

temps_scores = temps[gans.year] + temps[gans.month] + temps[me] + temps[gans.time] + temps[zhis.year] + temps[zhis.month]*2 + temps[zhis.day] + temps[zhis.time]
out = str(temps_scores) + " 湿度[-6,6] 拱：" + str(get_gong(zhis))
print("溼度分數", temps_scores, "正爲暖燥，負爲寒溼，正常區間[-6,6]", "拱：", get_gong(zhis))

# 输出十神分数
ten_shen_scores = []
for gan in Gan:
    score = gan_scores[gan]
    ten_shen = ten_deities[me][gan]
    ten_shen_scores.append(f"{gan}[{ten_shen}]-{score}")
print(" ".join(ten_shen_scores))

# 财库判定：依据日元确定对应财库地支，检查是否在四柱中
caiku_map = {
    '甲': ['辰'], '乙': ['辰'],
    '丙': ['未'], '丁': ['未'],
    '戊': ['辰', '戌'],
    '己': ['未', '丑'],
    '庚': ['戌'], '辛': ['戌'],
    '壬': ['丑'], '癸': ['丑'],
}
target_kus = caiku_map.get(me, [])
present_kus = [z for z in target_kus if z in zhis]
caiku_note = " 财库：{}({})".format("有" if present_kus else "无", ''.join(present_kus) if present_kus else ''.join(target_kus))

remark = " *备注：仅代表在运势（储蓄/赚钱能力）上的潜在优势，不等同于实际财富结论。"
print('\033[1;36;40m' + ' '.join(list(zhis)), ' '*5, ' '.join(list(zhi_shens)) + '\033[0m', ' '*3, out, "四柱：" + ' '.join([''.join(item) for item in zip(gans, zhis)]) + caiku_note + remark,)

# 十神名称映射
ten_god_title_map = {
    '官': '正官', '杀': '七杀', '印': '正印', '枭': '偏印',
    '财': '正财', '才': '偏财', '食': '食神', '伤': '伤官',
    '比': '比肩', '劫': '劫财',
}

# 计算安坐、相生、相剋（天干和地支分开计算）
# 安坐：天干的十神和地支的十神
an_zuo_gan = []  # 天干的十神
an_zuo_zhi = []  # 地支的十神
for i in range(4):
    if i == 2:  # 日柱，天干是日主
        an_zuo_gan.append('--')
    else:
        an_zuo_gan.append(ten_deities[me][gans[i]])
    # 地支主气的十神
    zhi_main_gan = max(zhi5[zhis[i]], key=zhi5[zhis[i]].get)
    an_zuo_zhi.append(ten_deities[me][zhi_main_gan])

# 相生：天干之间的相生关系和地支之间的相生关系（分开计算）
xiang_sheng_gan_set = set()  # 天干之间的相生关系（使用set去重）
xiang_sheng_zhi_set = set()  # 地支之间的相生关系（使用set去重）

# 天干之间的相生关系
gan_items = []
gan_wuhangs = []
for i in range(4):
    gan_items.append((i, gans[i]))
    gan_wuhangs.append(gan5[gans[i]])

# 五行相生关系
sheng_map = {'金': '水', '水': '木', '木': '火', '火': '土', '土': '金'}
for i in range(len(gan_items)):
    for j in range(i + 1, len(gan_items)):
        wu1 = gan_wuhangs[i]
        wu2 = gan_wuhangs[j]
        if sheng_map.get(wu1) == wu2:  # wu1生wu2
            shen1 = ten_deities[me][gan_items[i][1]]
            shen2 = ten_deities[me][gan_items[j][1]]
            shen1_name = ten_god_title_map.get(shen1, shen1)
            shen2_name = ten_god_title_map.get(shen2, shen2)
            xiang_sheng_gan_set.add(f"{shen1_name}生{shen2_name}")
        elif sheng_map.get(wu2) == wu1:  # wu2生wu1
            shen1 = ten_deities[me][gan_items[j][1]]
            shen2 = ten_deities[me][gan_items[i][1]]
            shen1_name = ten_god_title_map.get(shen1, shen1)
            shen2_name = ten_god_title_map.get(shen2, shen2)
            xiang_sheng_gan_set.add(f"{shen1_name}生{shen2_name}")

xiang_sheng_gan = sorted(list(xiang_sheng_gan_set))  # 转换为列表并排序

# 地支之间的相生关系
zhi_items = []
zhi_wuhangs_list = []
for i in range(4):
    zhi_items.append((i, zhis[i]))
    zhi_wuhangs_list.append(zhi_wuhangs[zhis[i]])

for i in range(len(zhi_items)):
    for j in range(i + 1, len(zhi_items)):
        wu1 = zhi_wuhangs_list[i]
        wu2 = zhi_wuhangs_list[j]
        if sheng_map.get(wu1) == wu2:  # wu1生wu2
            zhi_main_gan1 = max(zhi5[zhi_items[i][1]], key=zhi5[zhi_items[i][1]].get)
            zhi_main_gan2 = max(zhi5[zhi_items[j][1]], key=zhi5[zhi_items[j][1]].get)
            shen1 = ten_deities[me][zhi_main_gan1]
            shen2 = ten_deities[me][zhi_main_gan2]
            shen1_name = ten_god_title_map.get(shen1, shen1)
            shen2_name = ten_god_title_map.get(shen2, shen2)
            xiang_sheng_zhi_set.add(f"{shen1_name}生{shen2_name}")
        elif sheng_map.get(wu2) == wu1:  # wu2生wu1
            zhi_main_gan1 = max(zhi5[zhi_items[j][1]], key=zhi5[zhi_items[j][1]].get)
            zhi_main_gan2 = max(zhi5[zhi_items[i][1]], key=zhi5[zhi_items[i][1]].get)
            shen1 = ten_deities[me][zhi_main_gan1]
            shen2 = ten_deities[me][zhi_main_gan2]
            shen1_name = ten_god_title_map.get(shen1, shen1)
            shen2_name = ten_god_title_map.get(shen2, shen2)
            xiang_sheng_zhi_set.add(f"{shen1_name}生{shen2_name}")

xiang_sheng_zhi = sorted(list(xiang_sheng_zhi_set))  # 转换为列表并排序

# 相剋：天干之间的相克关系和地支之间的相克关系（分开计算）
xiang_ke_gan_set = set()  # 天干之间的相克关系（使用set去重）
xiang_ke_zhi_set = set()  # 地支之间的相克关系（使用set去重）

# 五行相克关系
ke_map = {'金': '木', '木': '土', '土': '水', '水': '火', '火': '金'}
for i in range(len(gan_items)):
    for j in range(i + 1, len(gan_items)):
        wu1 = gan_wuhangs[i]
        wu2 = gan_wuhangs[j]
        if ke_map.get(wu1) == wu2:  # wu1克wu2
            shen1 = ten_deities[me][gan_items[i][1]]
            shen2 = ten_deities[me][gan_items[j][1]]
            shen1_name = ten_god_title_map.get(shen1, shen1)
            shen2_name = ten_god_title_map.get(shen2, shen2)
            xiang_ke_gan_set.add(f"{shen1_name}剋{shen2_name}")

for i in range(len(zhi_items)):
    for j in range(i + 1, len(zhi_items)):
        wu1 = zhi_wuhangs_list[i]
        wu2 = zhi_wuhangs_list[j]
        if ke_map.get(wu1) == wu2:  # wu1克wu2
            zhi_main_gan1 = max(zhi5[zhi_items[i][1]], key=zhi5[zhi_items[i][1]].get)
            zhi_main_gan2 = max(zhi5[zhi_items[j][1]], key=zhi5[zhi_items[j][1]].get)
            shen1 = ten_deities[me][zhi_main_gan1]
            shen2 = ten_deities[me][zhi_main_gan2]
            shen1_name = ten_god_title_map.get(shen1, shen1)
            shen2_name = ten_god_title_map.get(shen2, shen2)
            xiang_ke_zhi_set.add(f"{shen1_name}剋{shen2_name}")

xiang_ke_gan = sorted(list(xiang_ke_gan_set))  # 转换为列表并排序
xiang_ke_zhi = sorted(list(xiang_ke_zhi_set))  # 转换为列表并排序

# 输出安坐、相生、相剋（天干和地支分开显示）
print("\n命局分析")
# 安坐：天干列显示天干的十神，地支列显示地支的十神
print("安坐\t天干\t||\t地支")
print("\t", end='')
# 天干列
gan_an_zuo_str = ""
for i in range(4):
    if an_zuo_gan[i] in ten_god_title_map:
        gan_an_zuo_str += ten_god_title_map[an_zuo_gan[i]] + " \t"
    else:
        gan_an_zuo_str += an_zuo_gan[i] + " \t"
print(gan_an_zuo_str.rstrip('\t '), end='')
# 使用固定数量的制表符对齐"||"（确保在同一列）
print('\t\t', end='')  # 固定2个制表符
# 分隔符
print("||\t", end='')
# 地支列
for i in range(4):
    if an_zuo_zhi[i] in ten_god_title_map:
        print(ten_god_title_map[an_zuo_zhi[i]], end=' \t' if i < 3 else ' \n')
    else:
        print(an_zuo_zhi[i], end=' \t' if i < 3 else ' \n')

# 相生：天干列显示天干之间的相生关系，地支列显示地支之间的相生关系
print("相生\t", end='')
# 天干列
if xiang_sheng_gan:
    gan_sheng_str = ""
    for i, sheng in enumerate(xiang_sheng_gan):
        gan_sheng_str += sheng + " \t" if i < len(xiang_sheng_gan) - 1 else sheng + " \t"
    print(gan_sheng_str.rstrip('\t '), end='')
    # 使用固定数量的制表符对齐"||"
    print('\t\t', end='')
else:
    print("--", end='\t\t')
# 分隔符
print("||\t", end='')
# 地支列
if xiang_sheng_zhi:
    for i, sheng in enumerate(xiang_sheng_zhi):
        print(sheng, end=' \t' if i < len(xiang_sheng_zhi) - 1 else ' \n')
else:
    print("--")

# 相剋：天干列显示天干之间的相克关系，地支列显示地支之间的相克关系
print("相剋\t", end='')
# 天干列
if xiang_ke_gan:
    gan_ke_str = ""
    for i, ke in enumerate(xiang_ke_gan):
        gan_ke_str += ke + " \t" if i < len(xiang_ke_gan) - 1 else ke + " \t"
    print(gan_ke_str.rstrip('\t '), end='')
    # 使用固定数量的制表符对齐"||"
    print('\t\t', end='')
else:
    print("--", end='\t\t')
# 分隔符
print("||\t", end='')
# 地支列
if xiang_ke_zhi:
    for i, ke in enumerate(xiang_ke_zhi):
        print(ke, end=' \t' if i < len(xiang_ke_zhi) - 1 else ' \n')
else:
    print("--")

# 立即輸出：月柱十神解讀（根據月支十神）
ten_god_detail = {
    '正印': (
        '【正印】',
        '品性：天生聰穎，記憶力佳，好學不倦，心地仁慈，責任感重，健康少病；惟偶有依賴心重、缺乏主見、過度保守之弊。',
        '意象：如書房、文書、教育，象征權柄與智慧，亦含長輩庇護、房屋契約、貴人相助、知識傳承、精神滋養與內心穩定感。',
        '適業：適合教師、藝術創作、出版、文書工作、醫護、宗教哲學、學術研究、教育培訓、文化研究、心理咨詢、資格認證相關領域。',
        '六親：代表長輩、貴人、老師；於男性為母親，於女性為祖母與婆婆。',
    ),
    '偏印': (
        '【偏印】',
        '品性：心思細膩，觀察入微，學習力強，多才多藝，能以獨特方式取得成功（異路功名）；然常感孤獨，喜靜不喜鬧，不善交際，易生憂鬱、偏執敏感。',
        '意象：適合鑽研玄學、特殊學問、冷門技藝，象征精神寄託、深度研究、靈感啟發、非傳統路徑，亦含奪食克子、隱性助力之義。',
        '適業：研究、創意、科技、演藝、咨詢、發明設計、軍師參謀、玄學研究、心理咨詢、冷門技藝、創新研發、非主流文化領域等需要專精的領域。',
        '六親：代表男性之祖父，女性之母親；亦含非主流長輩與特殊領域啟蒙師。',
    ),
    '正财': (
        '【正財】',
        '品性：踏實本分，誠信勤儉，顧家愛妻，值得信賴，負責任；然偶有吝嗇保守、刻薄寡恩、缺乏魄力、過度看重物質之失。',
        '意象：代表穩定、正當的收入，象征物質基礎、家庭保障、長期儲蓄、合法經營、價值交換、生活必需品與經濟安全感。',
        '適業：金融、會計、銀行、財政、物流、政府、基礎服務、傳統商業、固定收益行業等傳統穩定領域。',
        '六親：代表男性之妻；於女性為父親/祖父, 或與穩定收入來源，亦含長期合作夥伴。',
    ),
    '偏财': (
        '【偏財】',
        '品性：慷慨大方，善交朋友，聰明靈活，樂觀進取，應變力強，重義輕財；然需防範揮霍浪費、感情不專、花心浮躁、賭性強、短期功利之弊。',
        '意象：如俠客仗義，善於經營，易得意外之財，象征副業收入、靈活收入、人脈變現、跨界合作、資源整合、短期高回報機會與社交圈資源。',
        '適業：商業、投資、金融、咨詢、彩票、娛樂行業、風險投資、創業孵化、短期項目、仲介經紀、非固定收益領域等變動性強的行業。',
        '六親：代表男性之父親與情人，女性之父親與婆婆；亦含臨時性合作夥伴。',
    ),
    '食神': (
        '【食神】',
        '品性：懂享受，愛好藝術，心胸寬廣，福氣豐厚，生活品味佳，情感溫和；然偶有清高自滿、好吃懶做、缺乏鬥志、過度安逸之虞。',
        '意象：象征福氣、豐足與創造，含衣食無憂、生活品質、創意輸出、情感慰藉、健康運勢、晚輩助力、才華落地與長期積累的幸福感。',
        '適業：演藝、美術、飲食、美容、教育、養生業、食品行業、文化傳播、生活服務業、服裝設計、藝術創作等與美和享受相關的行業。',
        '六親：代表晚輩、學生、下屬與服務提供者；於男性為孫兒與女婿，於女性為女兒。',
    ),
    '伤官': (
        '【傷官】',
        '品性：聰明有才，膽識過人，能言善辯，創新思維，魄力十足，敢闖敢言；然易驕傲任性，言語尖銳，報復心強，目無法紀，須學會收斂。',
        '意象：男性易有口舌是非，女性須注意夫妻關係（克夫招非）；象征才華外露、創新突破、表達自由、文化傳播、突破傳統、思想解放與個性張揚的影響力。',
        '適業：文學、藝術、表演、政治、教育、書畫、音樂、影視、公關、創意設計、廣告、媒體、策展、新媒體、文化批判領域等需要才華與表現的行業。',
        '六親：代表晚輩、學生、下屬與創作合作者；於男性為祖母與孫女，於女性為兒子。',
    ),
    '比肩': (
        '【比肩】',
        '品性：重情義，意志堅定，獨立自主，敦厚忠實，人緣佳，團隊意識強；然有時固執己見，不善變通，剛愎自用，刻薄寡恩，攀比心重。',
        '意象：朋友多，宜合作求財，象征同輩助力、人脈資源、團隊協作、共同目標、自我認同、集體榮譽、資源共享，忌則克財耗身（含同輩競合關係）。',
        '適業：運動、技術、中介、自由業、創業、礦業、團隊管理、社群運營、同業聯盟、共享經濟領域等需靠人脈與毅力的行業。',
        '六親：代表同輩、朋友、同學與股東；於男性為兄弟，於女性為姐妹，亦含團隊戰友。',
    ),
    '劫财': (
        '【劫財】',
        '品性：機智靈活，善於交際，口才圓滑，應變力強，臨機處變能力佳，善於活躍氣氛；然易有投機心態，貪賭好色，失信狡詐，吹牛抬槓，目無法紀。',
        '意象：象征破財、爭鬥、競爭爭奪、意外破財、投機風險、短期機遇、資源重組、人際波動、跨界嘗試，須防範受騙與克父克妻之虞。',
        '適業：貿易、投資、服務業、直銷、股票經紀、期貨交易、短期項目合作、活動策劃、仲介斡旋、風險性創業等需口才與應變的行業。',
        '六親：代表異性朋友、同輩與競爭者；於男性為姐妹，於女性為兄弟，亦含臨時合作夥伴。',
    ),
    '正官': (
        '【正官】',
        '品性：正直守信，愛惜名譽，行事穩重，有責任感，廉明公正，重視名節；然偶有保守固執、好面子、膽小怕事、易陷官非訴訟之弊。',
        '意象：如領導、兄長，象征地位與尊重、文職官運、功名地位、社會規範、道德準則、官方認證、長期事業規劃、公眾形象與自我約束。',
        '適業：公職、法律、管理、政治、法官、記者、企業管理、文秘、公關、學術機構管理、官方認證行業等需要公正與領導力的行業。',
        '六親：代表男性之女兒；於女性為丈夫（正緣），亦含受人敬重的權威者與長期事業合作夥伴。',
    ),
    '七杀': (
        '【七殺】',
        '品性：勇猛果敢，意志堅強，不畏困難，執行力強，俠義果敢，魄力非凡，應變迅速；然脾氣急躁，容易衝動，霸道好鬥，叛逆魯莽，報復心強，須學會克制。',
        '意象：如將軍征戰，象征武職權威、風險挑戰、競爭環境、突發機遇、權力博弈、危機應對能力，亦含壓力、小人災傷、惡性疾病與短期高回報機會。',
        '適業：軍警、司法、管理、公檢法、軍人、安保、競技體育、企業副職、危機公關、風險管理、創業初期團隊、極限行業等需要魄力與決斷的行業。',
        '六親：代表男性之兒子；於女性為情人（偏緣），亦含強勢合作夥伴與競爭對手。',
    ),
}

# 十神分類映射（將具體十神映射到分類）
ten_god_category_map = {
    '正官': '官殺',
    '七杀': '官殺',
    '正财': '財星',
    '偏财': '財星',
    '正印': '印綬',
    '偏印': '印綬',
    '食神': '食傷',
    '伤官': '食傷',
    '比肩': '比劫',
    '劫财': '比劫',
}

# 十神分類詳細解讀
ten_god_category_detail = {
    '官殺': '''官殺：活在危機感中的現實主義者
官殺，代表克制我的五行，象徵我們在生活中遇到的限制、壓力和規範。它被傳統社會所推崇，因為它的人格特質最符合對「官吏」的期望。

人格本質：一種對外部環境強烈的危機感與恐懼感。

這種彷彿隨時會被環境吞噬的恐懼，是官殺人格的底層驅動力。為了應對這種不安全感，他們發展出強大的現實感知力，並不斷向內雕琢自己。

理性： 這並非天生的聰明，而是危機感驅動下的「最壞打算」。在他們眼中，世界充滿陷阱，一招不慎就會墜入懸崖。因此，他們會摒除一切天真的幻想，冷靜地洞察事物背後的風險與真實規則。

自制力： 因為恐懼，所以不敢放肆。他們會主動約束自己的行為、時間和人生規劃，彷彿頭上永遠懸著一把無形的刀，迫使他們保持警覺。

重規則： 規則代表「確定性」。一個有條理、可預測的環境，能讓官殺感到安全。他們要么是規則的忠實執行者，要么會主動去創造規則。

權利慾： 與其被動順應環境，不如直接掌控環境。追求權力，是他們獲取安全感的根本方法。因此，官殺的人容易走向管理職位，成為深諳人性的高手。

日常表現：
在官殺人眼中，世界是由「弱肉強食」、「價值交換」等冰冷規則構成的。職場對他們而言是淘汰場，婚姻是尋求生存競爭力夥伴的現實選擇。他們常顯得悲觀、早熟，喜歡「未雨綢繆」，內心容易反复預演危機，因此也是失眠的高風險群。

正官 vs. 七殺：規則內的菁英 vs. 規則外的開創者
正官（有情之克）： 像是「中庸的管教」。正官面臨的管束是點到為止的，這讓他們學會了在體制內如魚得水。他們守規矩、服從管理、做事圓融，善於在「現有的資源蛋糕」中，為自己分得最大的一塊。他們是優秀的守業者、職業經理人。

七殺（無情之克）： 像是「嚴酷的廝殺」。七殺面臨的環境更為苛刻，這讓他們一邊極具危機感，一邊渾身充滿不服。他們不畏懼衝突，不滿足於現狀，更願意跳出框架，去「做一塊屬於自己的新蛋糕」。他們是創業者、改革者、大將，在戰鬥中獲得安全感。

識別特徵： 人狠話不多、做事麻利的，常帶「殺氣」；笑臉迎人、善於照顧氛圍的，常帶「官氣」。''',
    '財星': '''財星：渴望與世界連結的感受家
財星代表我所能掌控的五行，象徵物質財產、妻子/戀人、父親等。核心是「我們所能擁有、利用和控制的事物」。

人格本質：一種去感受和體驗外部世界的強大驅動力。

財星人天生就對外部世界充滿興趣，一人一物一花一草，都是他們渴望探索和連結的對象。他們一生都在做兩件事：對外投入關注與愛，並渴望獲得外界的關注與回饋。

敏感與高情商： 因為能量向外灌注，外部的一點風吹草動都會在他們心中放大，這使他們對他人情緒有極強的讀取能力。

溫柔： 他們追求人與物、人與人之間的和諧融合，不喜歡分別與衝突，習慣用呵護的姿態對待外界。

重物慾： 他們容易沉溺於有實體感的美好事物，如美食、華服、珠寶、家居擺設。

多情： 對人的喜愛是真心的，且難以厭棄舊人，他們的愛常伴隨著柔軟的付出。

賺錢能力強： 對世界的愛與敏感，使他們能迅速嗅到社會的新需求與趨勢，並轉化為賺取「世界硬通貨」——金錢——的行動。

財星人容易活在當下，是十神中最有意願去愛、也最懂得享受片刻美好的人。他們樂觀，也容易被感動。缺點是可能過於註重細節和物質享受，而忽略了宏觀的戰略規劃。

正財 vs. 偏財：精打細算 vs. 慷慨多情
正財（有情之克）： 他們的付出，建立在「不侵害自身長期價值」的基礎上。正財給人的印像是「節儉」、「精打細算」。他們花錢講究性價比，會為高品質的門窗花大錢，但嫌棄景區的飲料太貴。對配偶，他們關係越深越投入，動機是「只對有價值的人大方」。

偏財（無情之克）： 他們更「縱容」自己的喜好，容易拿錢不當回事。偏財以「大方」、「多情」著稱。他們愛請客、為紅顏一笑一擲千金，在感情上也更難專一。這種特質在現代商業社會容易獲得高回報，但跌倒時也更慘痛。''',
    '印綬': '''印綬：依賴環境滋養的庇護者
印綬是生助我的五行，象徵母親、貴人、學歷、房產等一切能給予我們支持的事物。

人格本質：一種對環境（空間與歷史）的深刻依存性。

他們傾向於與外部環境形成緊密聯合，從中獲得資源與安全感。

學業出色： 學習是對過往知識的積累，而印綬本能地珍視和依賴這些「既有」的智慧，因此更擅長吸收與領悟。

服從性好： 在親子與職場關係中，他們是很好的執行者與貫徹者。

貴人緣： 他們的依從性，讓前輩更願意提攜，所謂「憑風好借力，送我上青雲」。

房產多： 房子是恆久不變的依賴物，能給他們帶來根深蒂固的安全感。

宗教緣： 對縱向的歷史與人類集體智慧有很強的感應力。

印綬是索取性和依賴性為主導的能量，與財星的奉獻性相反。

正印 vs. 偏印：信任的乖寶寶 vs. 孤僻的探索者
正印（有情之生）： 像母親一樣的生助，讓他們對外界有較強的安全感。正印思維中庸、情緒平和、依賴性強，顯得文雅體面。但若過度，容易把別人的幫助視為理所當然。

偏印（無情之生）： 像繼母一樣不情願的生助，讓他們對外界缺乏信任。偏印思想極致、性情孤僻、愛獨處，不安全感驅使他們進行深度探索，但也導致內耗重，思緒反复。''',
    '食傷': '''食傷：急於表達內心的夢想家
食傷代表我生出的五行，象徵話語、創作、情緒、孩子等我們所抒發的事物。

人格本質：一種將內心認知與欲望發洩出來的強烈衝動。

他們的內在欲望遠遠強於對外部環境的順從，因此顯得與眾不同。

愛自由： 他們的公式是「自我 > 環境」，對任何管束都本能地反抗。

正義感： 他們尊重心底的聲音，維護「事實本該如此」，常為理想不求回報。

聰慧有才： 這份才華是老天對他們「忠於內心」的犒賞。他們的靈感來自不受污染的真誠感受。

愛幻想： 他們是內心的放大鏡，常罔顧現實，極力描繪心中的願景，是夢想家，也可能是開天闢地的成就者。

敏感易受傷： 過於重視自尊，外部的不認可會對他們造成巨大打擊。

懶： 沉溺在內在的思緒與幻想中，非常耗費能量，導致「慧極必傷」。

食神 vs. 傷官：溫和的藝術家 vs. 偏激的革命家
食神（同性之生）： 有限度、溫和的生。食神愛好閒適典雅，如書畫、美食。他們輸出耐心，性情隨和，傲氣但堅定。

傷官（異性之生）： 激烈、極致的生。傷官追求真理與顛覆，喜歡搖滾或深奧思想。他們心直口快，好勝心強，易衝動，是辯論高手，但也容易「傷」到自己。''',
    '比劫': '''比劫：自我膨脹的捍衛者
比劫代表與我相同的五行，象徵自我、朋友、兄弟、同儕等。

人格本質：一種在維護自我立場的基礎上，向外界抗爭的動力。

他們眼中的「自我」被放得很大，外部世界則相對很小。

自我： 話語中高頻出現「我」字，常無視外部限制。

好面子： 極度需要外界承認自身的重要性。

控制慾強： 對外部訊息遲鈍，常以自己的意願覆蓋他人，顯得霸道。

講義氣： 對「自己人」傾力相助，看重自己在群體中的權威。

比劫的「自我」特質會壓抑共情與物質體驗，即「克財」。但一個人若比劫太弱，也將無法承受財富與壓力，變得優柔寡斷。

比肩 vs. 劫財：厚道的夥伴 vs. 霸氣的戰士
比肩（同性之比）： 支持中帶有競爭。比肩容易把他人當作自己，人際上較友好，但會內耗，也容易因同理心而借錢給朋友，在婚姻中對配偶較為厚道。

劫財（異性之比）： 全力、熱烈地支持。劫財自信到近乎固執，不怕衝突，在利益上斤斤計較，合作時一定要白紙黑字。他們投資風格激進，在婚姻中也較少讓步。''',
}

_mdc = zhi_shens[1]
_mdt = ten_god_title_map.get(_mdc)
# 创建十神名称到shens2字符的映射
ten_god_to_char = {
    '正官': '官', '七杀': '杀', '正印': '印', '偏印': '枭',
    '正财': '财', '偏财': '才', '食神': '食', '伤官': '伤',
    '比肩': '比', '劫财': '劫',
}
if _mdt and _mdt in ten_god_detail:
    _orig_print("\n" + "="*120)
    # 如果该十神总数>=3，显示总数
    _char = ten_god_to_char.get(_mdt)
    if _char and shens2.count(_char) >= 3:
        _orig_print("月柱十神解讀：【{}】 (總數(含藏干): {})".format(_mdt, shens2.count(_char)))
    else:
        _orig_print("月柱十神解讀：【{}】".format(_mdt))
    for _line in ten_god_detail[_mdt][1:]:  # 跳過內文首行標題，避免重複
        _orig_print(_line)
    _orig_print("="*120)
    # 顯示分類解讀
    _category = ten_god_category_map.get(_mdt)
    if _category and _category in ten_god_category_detail:
        # 创建分类到字符的映射，用于统计总数
        category_to_chars = {
            '比劫': ('比', '劫'),
            '食傷': ('食', '伤'),
            '財星': ('财', '才'),
            '印綬': ('印', '枭'),
            '官殺': ('官', '杀'),
        }
        # 如果该分类总数>=3，显示总数
        chars = category_to_chars.get(_category)
        if chars:
            total_count = shens2.count(chars[0]) + shens2.count(chars[1])
            if total_count >= 3:
                _orig_print("十神分類解讀：【{}】 (總數(含藏干): {})".format(_category, total_count))
            else:
                _orig_print("十神分類解讀：【{}】".format(_category))
        else:
            _orig_print("十神分類解讀：【{}】".format(_category))
        # 移除空行（连续的换行符）
        _category_text = ten_god_category_detail[_category]
        # 将多个连续换行符替换为单个换行符，但保留单个换行符
        _category_text = re.sub(r'\n\s*\n+', '\n', _category_text)  # 移除空行
        _orig_print(_category_text)
    _orig_print("="*120)

# 日柱詳細解讀
day_pillar_detail = {
    '甲子': '''
甲木為棟樑之木，木主仁，坐下正印，其人身高體健，慈祥愷悌，相貌俊秀。印為文書，身坐文書，主才學超群，有權柄。印又有生身助學之功，故主人記憶力強，學習成績優秀。
甲子為"木遇水生"之象，子水中癸透，生扶甲木，一氣純粹。生於此日者，多具仁心慈念，溫厚好學。甲木坐正印，心性安舒，易受母輩影響而偏倚親情；一生多得學緣及文士之助。印旺財官弱，理財宜後習；子中辛金長生，化生庚殺形成"殺印相生"，子息多聰慧。然水旺傷心，父輩或易患心目之疾。若命局木盛，則如喬木挺立；木無根，則似浮蓮隨水，常有宗教玄緣。幼年或有與水相關之驚險。''',
    
    '乙丑': '''
乙木為花果之木，木主仁，坐下偏財、七殺、偏印。乙丑日生慷慨大方，喜愛春風，多學少成，幼年現災，父母重拜；九流中人，夫妻無刑，兒女不孤，六親少靠；女人賢良純和，但求財心切，需體恤家庭。
乙丑為福星貴，主人秀氣有福。又為金神貴，身坐金庫，木無根，最喜月支逢火星，若坐下七殺無制，則自信心太過，往往一意孤行。
乙木植於濕土，丑中藏己辛癸，生剋錯綜。己為財，辛為殺，癸為印，一生多財機與磨煉並存。乙木柔弱，賴癸水滋養而不固，氣象為"財殺混雜"。宜以知識與技藝立命。偏印多憂思，故有思慮鬱結、筋骨勞損之虞。婚姻多波折，宜相互包容。父輩多能助力，但勞累成疾。子女平穩安守，福厚而不顯貴。''',
    
    '丙寅': '''
丙火為太陽之火，火主禮，坐下偏印、食神、比肩。丙寅日生多學少成，心性不定；口快舌硬，身閒心直，手足不停，利官近貴，女人賢良，聰明伶俐，辛勤收穫！
丙為太陽，身坐長生，有光彩之象，主人聰明，但坐下梟神奪食，不吉。
丙火坐寅木，木火生輝，為長生產氣。命主多充滿熱情、行動力強。寅中甲木偏印，若太旺則奪食生慮；若平衡則能"食神生財"，福祿綿長。其人性明朗豁達，具領導力與創造欲。婚緣上，比肩坐日，多互助亦多競爭。宜循光明正業，如教育、醫療、藝術。火旺金衰，父系呼吸系統宜護。形貌俊朗，少女佳婦類秀麗端莊。''',
    
    '丁卯': '''
丁火為燈燭之火，火主禮，坐下偏印。丁卯日生手足不停，身心不閒，內外有勞，衣祿不少，性巧聰明，做事有頭少尾，男人福份之命，女人企圖寧靜，操勞中有幸而獲，防不知足？
丁火坐印通根，主人聰明有學問。若四柱出現亥卯未三合局或寅卯辰三會局，為大貴人，但身坐偏印，只能為副職，輔佐他人。
丁火得卯木偏印而生，智慧靈敏，心思細膩。然過度思慮易憂鬱。仕途多變，宜安於學術與專業。婚緣溫厚，然情感表達不暢，宜溝通維護。與父母子女皆有距離之象，守中道則和諧。生存力強，適合靜業與耐心工作，如文藝、設計、教育類。''',
    
    '戊辰': '''
戊土為城牆之土，土主信，坐下正財、比肩、正官。戊辰日生喜氣春風，利官近貴，骨肉刑傷，兒女不孤，女人溫良賢達，有口無心，烏鴉嘴豆腐心，主招好夫，需防止他人誤會！
戊辰日柱通根身旺，坐財、官、比肩，但支中藏干比肩、財星化火為印，變成官印相生，故主高貴。支內戊癸化火生土，而辰本為濕土，內中有火，溫暖中和，能生萬物，必然根深葉茂，秀氣有成。
戊土坐辰庫，藏癸乙戊，財官同庫而貴氣潛存。主穩重踏實，具理財與管理天賦。婚緣得助，配偶賢明。土厚故心存高望，宜戒驕矜，知足則安。父母多助而觀念易異。性格實幹，適宜地產、金融或行政之業。土旺克水，宜防呼吸與脾胃之疾。''',
    
    '己巳': '''
己土為田園之土，土主信，坐下正印、傷官、劫財。己巳日生聰明才智，手足伶俐，小有功名，做事如意；夫妻和睦相處，諸事可為；女人衣食住行不缺，善良待人；男人多出風頭，小有計謀，資性英敏，福厚之命。
己巳日為金神貴，主人剛毅、聰明，月支有火則貴，卻火則不吉。坐下正印、劫財、傷官，傷官佩印，貴不可言，但傷官遇劫，易遭小人陷害。
己土居巳火，火生土旺。印生身強，具剛毅與責任心。事業射干，宜實業或軍警文教類。性格厚直，然印旺抑財，經濟由勤儉積累。友人益多，父親勞多體弱。中年後心智成熟，女命多賢母。喜火土事業，慎防血脈與牙疾。''',
    
    '庚午': '''
庚金為斧鉞之金，金主義，坐下正官、正印。庚午日生口快心直，利官近貴，小有殊榮，衣祿豐盈。男人權柄，辛勤持家，外面固執，有人欽佩；女人秀氣，略顯美感，榮夫益子，鄰里欽佩。
庚午日生，身坐正官正印，氣質清純，必主官貴，但金坐火地，須經火煉，千錘百鍊始成鋼，所以仕途坎坷，有大起，也有大落。
庚金臨午火，火克金而土生金，克泄並見。情緒多端，遇貴人貴氣自彰。女命配偶賢而性格需穩。宜南方發展，忌北水地。貴以修心，慎勿"傷官見官"。事業多變，健康宜護胃脾。''',
    
    '辛未': '''
辛金為首飾之金，金主義，坐下偏印、偏官、偏財。辛未日生生有志氣，心性寬容尚仁義，少年災病；中年略好，頭胎見女更吉，生男有刑克；夫妻和睦相處，事業順利；女人持家方興旺，男人顧家多利業！
辛未日柱得庫通根，身旺，坐下偏財、偏印、七殺，一片順生，主小貴，吉。女命辛未愛情專一，奪夫權，守家，獨裁。
辛金得未庫為財鄉，土生金旺。命有貴氣，宜理財行商。殺印相生，武仕或經商皆利。異性緣深，宜守正道。水火木全則運亨。身體宜護肺皮膚。''',
    
    '壬申': '''
壬水為江河之水，水主智，坐下偏印、偏官、比肩。壬申日生性巧聰明，才智少顯，計謀多變，誠信待人接物功名有份；有賢妻子，為人英敏，受人喜歡；女人美麗，博得人助！階段富貴，榮華自珍！福氣子孫。
壬申日柱，身坐長生，太旺，主人好動不拘。納音劍鋒金，男命敢於拼打爭鬥，常不善終。女命重武好鬥，具男性風格。
壬水坐申長生，氣滿神清，智慧深厚。喜流動變化，多貴人助。宜學術科研、交通水運等行。父系體弱，子女獨立。健康宜防肝手之疾。''',
    
    '癸酉': '''
癸水為雨露之水，水主智，坐下偏印。癸酉日生心直公平，伶牙俐齒，防言多失；衣祿自儉，有備無患，平穩足用；六親冷淡，自謀求生；社會交往，多有人愛，雖事不成，少取勿貪，百業可為；女人助夫，勤儉持家；晚年幸福！
癸水坐偏印金神，外表柔和，內心陰毒。富於心計，會掙錢，但也會花錢。
酉金生癸水，偏印旺。聰慧而內斂，言語宜慎。命主多幽微思緒。桃花凶易，宜持節制。合適教育、金融、理性行業。戒酒與過度應酬。''',
    
    '甲戌': '''
甲木為棟樑之木，木主仁，坐下偏財、正官、傷官。甲戌日生口快舌伶，身閒心不空，少年貧民，中年奔波，略有權職，心機謀略，多學少成，小有名聲；晚景福祿延年，自珍自愛益壽；助人惹怨，妒嫉常伴隨而來。女人旺夫，勤儉興家。
甲戌得庫通根身旺，坐下偏財正官、傷官，主人剛強正直，光明正大，為官清廉，但性格過於直爽，易得罪人，難免受到打擊、排擠。
甲木克戊財，得丁火傷官，寓"傷官生財"。心性高潔，智慧敏銳；女命感情多磨合。好學藝文，且與宗教哲義有緣。父助有力，若能修心，則成雅士風流。''',
    
    '乙亥': '''
乙木為花果之木，木主仁，坐下正印、劫財。乙亥日生為人和順，幼年多災，父母有刑，誠實待人接物，出外稍好；女人夫好，和睦相處、偕老，存心中正，中年財旺，防勞致病；婚遲子晚，子女防克，重拜義母，嚴教成才。
乙亥雖處死地，卻坐下為正印、劫財幫身，故有枯木逢春之象。男命乙亥主得賢妻；女命乙亥主得貴夫，而且對夫忠誠。另外，女命乙亥非常漂亮。
乙木坐亥，水旺木寒，需火暖扶身。氣質柔弱而靈秀。母緣深，財運流動，宜教育文化業。謹防筋骨寒濕與疲勞，保暖養氣為要。''',
    
    '丙子': '''
丙火為太陽之火，火主禮，坐下正官。丙子日生膽大言廣，有權謀，心機詭詐，早年平平，中年成就，晚景大好，女人饒舌，言多有失，安分守己，避免麻煩，幸福自來。
丙子為福星貴，主人聰明，博學多能，易顯威望。丙火坐子無根，主人身矮。丙為太陽主光明，而子鼠狡猾，子中癸水陰濕，故亦主人雙重性格。身坐正官，一權在握，往往自以為是，獨裁固執。
丙火坐子水，陰陽對立而成調和之象。火遇水克，然癸水潤丙，光暈柔和，主聰慧中帶堅定。此日生人，多具理性與感性兼容之氣，外溫內毅，志趣文雅。丙火臨正官，宜守正途；子為官鄉，主婚緣佳而多磨，感情需互諒方穩。性情仁厚而敏感，易為情所動。事業宜取教育、醫學、能源、社會服務諸業，以火水互制為中道。健康宜護眼與心；修心以和，情可化吉。''',
    
    '丁丑': '''
丁火為燈燭之火，火主禮，坐下食神、偏官、偏財。丁丑日生為人和睦，衣祿不愁，初年有旺祿常在，晚景大好，更有結餘，婚遲子晚，夫妻和睦相處，則百事順利。女人旺夫愛子，孝敬，持家賢良。
丁火坐丑無根，身弱，但丁為星光，無妨。坐下偏財、七殺、食神，食神生偏財，偏財生殺，也一片順生，故屬吉利。
丁火坐丑土，為火潤於濕土之象。火得食神，氣息含蓄，主性情內斂、思考細密。此日生人勤謹穩重，凡事注重實效。偏印暗藏，思慮深，稍多憂懷。宜學術、設計、金融、文藝等實務工作。感情平和而淡遠，配偶溫厚；過度憂慮則損氣。健康宜防脾胃與血氣鬱滯。''',
    
    '戊寅': '''
戊土為城牆之土，土主信，坐下七殺、偏印、比肩。戊寅日生計算聰明，才智有餘，文武兩通，兒女早產防克；結婚當晚，財運良好，運氣頗佳，用情不專，家花、野花，警慎為佳！女人自珍，賢慧發福！
戊寅日柱坐長生，身旺。生於春，則坐下七殺太重，一生勞苦，多為人造福。
戊土據寅，木火相生，藏七殺、偏印與比肩。土得印生而不燥，志氣高昂，具領導力。此日生人果決堅毅，處事公正。若火木兼旺，則財官生而顯貴；若水多克之，宜守實業。利於管理、建設、教育、軍警等職。健康防血壓與筋骨疲勞；修身守正，剛中有容。''',
    
    '己卯': '''
己土為田園之土，土主信，坐下七殺。己卯日生為人交往廣泛，風流倜倘、豪傑，衣祿豐足，閒情逸緻，嬉戲娛樂，有人遵從；六親冷淡，自立為上，骨肉難為，妻招年長，配偶和睦；女人注意鄰居關係，自我解脫，曠達胸懷，長壽，親族賢達。
己卯坐殺截腳，為最差之日，人命己卯，易殘疾、受傷，一生勞苦。年上己卯，祖上傷殘，不善終；月上己卯，父母不團圓；日上己卯，青年時期命危；時上己卯，老年不得善終，子女不好。
己土坐卯木，木剋土，為克中見生。命主柔中帶剛，能受壓而不折。性格沉著慎謹，勤於自省，宜技藝、學術、教育或農木之業。感情互依互剋，宜以理調和。多思而能忍，若火來生土，則志行堅實。健康防肝與筋骨之弊，動靜適度則安。''',
    
    '庚辰': '''
庚金為斧鉞之金，金主義，坐下偏印、正財、傷官。庚辰日生春風和氣，勞祿霜雪一生，利官近貴，名利雙全，衣食足用；中年平順，晚年大興，女人勤儉，持家有方，受人敬仰，坎坷風波。個別命運身體衰弱，注意健康，平安為福。
庚辰為魁罡，身坐正財、傷官、偏印，主人有財祿，聰明有學識，支中藏干傷官帶偏印有貴氣，而戊癸化火為官殺，變成日坐財官，可做官，但隱含傷官，可能喜開殺戒。
庚金居辰，土生金而藏水木。庚得生扶，聰敏多變，處事果斷。地支辰中癸水為傷官，乙木為財，兼具靈慧與財能。若能節氣制衡，乃智與才並舉之命。宜工程、醫藥、金融、科研等業。言宜慎和，勿矜才。健康防胃氣與目疾。''',
    
    '辛巳': '''
辛金為首飾之金，金主義，坐下正官、劫財、正印。辛巳日生友善機謀，能應變，志氣過人，衣食足用；有貴人扶助，中年和順，老有福運，心安理得，知足常樂，可以長壽。
辛巳日柱，身坐正印、正官、劫財，辛金柔弱，有正印生身，劫財幫助，由弱轉旺，而正官丙火制衡，使干支中和，必主官貴，富於成功。
辛金鍛於巳火，為"金煉成器"之象。火煉之金，質潔而光。此日生人多秀外慧中，心思精微，氣質端雅。居官而有度，經商亦能權衡。巳中庚戊生扶，根氣厚實。若水木輔之，則文理皆通。健康防肺與皮膚疾，慎火。事宜金融、醫學、美術與策劃；以靜制剛為吉。''',
    
    '壬午': '''
壬水為江河之水，水主智，坐下正財、正官。壬午日生為人勤儉，父母刑傷，早年財物不順利，存儲不多，中年勞心，稍有所得，晚景旺子，事應積蓄，防備缺乏。女人興家，賢能自達，恆心有獲。
壬午坐下財官，無雜氣，多主官貴，丁壬合財，主得妻財或因妻致富。但壬午不如癸巳，癸巳財官雙美無雜氣，又為日貴。另外，壬水蓋頭有掩火之嫌，故雖有官貴，也難免大起大落。
壬水坐午火，水火交融，為財官雙現之象。命主聰慧和順，處事中和，財緣深長。心性開朗而具責任感，適宜管理、金融或學術領域。感情溫厚而理性，合中有克，需互諒相惜。健康宜護心與血；守誠正則福祿長。''',
    
    '癸未': '''
癸水為雨露之水，水主智，坐下偏官、偏財、食神。癸未日生心急口快，為人伶俐；救人無恩，反招是非，曲直難辯，多有誤會。有財無庫，過眼煙雲，財來財去，精打細算，可免禍災；女人賢慧，勤儉持家；晚景平安。
癸未坐下有食神生財、財生殺，因坐偏財、七殺，故男女命逢癸未，重婚較多，但男女均俊秀漂亮，愛情專一。
癸水居未庫，土多水滲。氣質柔利，性情敦厚而思敏。此日生人多具靈感與藝術氣質，善思而重情。事業以創意、教育、公益為宜。情感貞摯但多思，親情深而易憂。健康防脾胃與濕邪，宜靜養心性。''',
    
    '甲申': '''
甲木為棟樑之木，木主仁，坐下七殺、偏印、偏財。甲申日生衣祿不少，心性溫柔，出入有為，技壓群芳，初年不順，中年勞神，晚景利達；夫妻和順，兒女遲到，女人操勞，忍耐莫逆，家事平安。
甲申坐絕地，一輩子辛苦、奔波，但死木逢殺克削，也不失可用。
甲木臨申金，木被金制，為剋中藏生之象。此日生人外柔而內勁，歷試而精。七殺得印化，若配合得宜則成"殺印相生"，能化險為宜。性格剛正，具有冒險與突破精神。宜管理、科研、軍警及技術性行業。感情波折，重守信義；多動可通利，宜遠行而成。''',
    
    '乙酉': '''
乙木為花果之木，木主仁，坐下七殺。乙酉日生口快心直，軒昂大方，樂觀；衣祿足用，兄弟雖有，難為助力；與人為善，事業成功；女人興旺，小有蓄財，平穩，求安康。
乙酉日柱自坐七殺截腳，生在春天有救，生在土月助殺攻身則不妙。命逢乙酉多不善終或不高壽。女命乙酉漂亮，浪漫，早戀愛或早結婚，但是戀愛過程或婚後感情問題卻往往層出不窮。
乙木坐酉金，金剋木，氣寒而秀。此日生人性敏而勤，才華潛而不顯。以柔制剛，宜以學識立身，如教育、藝術、法務、醫療等業。感情好而多磨，婚緣宜晚。健康防肝膽與循環系統。修德守心，能化剋為生。''',
    
    '丙戌': '''
丙火為太陽之火，火主禮，坐下食神、正財、劫財。丙戌日生性情溫和，技藝護身，衣祿不愁，豪傑和順，自能有財；獨立家業；前運不周，利益不順，中年操勞，錢財有進；晚年榮華。女人中年奔波，辛苦求財，老年稍微聚財發旺，珍惜為盼！
丙戌坐火庫，身旺，火光熠熠，聰明、漂亮，人緣好。此日生之人多有溫和的品格，注重勤勉，然而似有多管閒事的癖好。又戌土支中藏干為戊、辛、丁，丁為劫財，又日支坐墓，故夫妻間相處不易。
丙火坐戌土，火土相依，為"食神生財"之象。性情坦率而具修養，志高而務實。此日生人重情重義，常自求完善。財星藏庫，運開而財聚；火暖土潤，主家庭安穩。宜從教育、醫療、文化、建設等業。婚姻感情誠篤，唯心易憂。健康防眼疾與心腹火症。''',
    
    '丁亥': '''
丁火為燈燭之火，火主禮，坐下正印、正官。丁亥日生性巧聰明，小有才智；獨立自營，奔波操勞，兒女有利，見遲方好；好為善事，稍微旺財；女人貞節自愛，得貴人幫助，幸有財運，衣祿平穩。
丁亥日柱，坐下正印、官星，官印相生，主聰明超群，丁壬合化印星，坐貴，主官貴，與大貴人有緣。女命丁亥，可嫁貴夫。
丁火居亥水之上，為"官印相生"。性情柔而明，聰慧且仁慈。此日生人正直守禮，具服務精神，適合教育、公職、研究等領域。感情平和，配偶端和；多貴人輔助而不乏機緣。健康宜護血氣與腎，心靜自安。''',
    
    '戊子': '''
戊土為城牆之土，土主信，坐下正財。戊子日生計算聰明，才智有餘，文武兩通，兒女早產防克；結婚當晚，財運良好，運氣頗佳，用情不專，家花、野花，警慎為佳！女人自珍，賢慧發福！
戊子為六秀日，主人聰明秀氣，坐正財，得賢妻，因妻致富，干支戊癸化火生身，主高貴。
戊土坐子水，以財為根，為"土制水而財聚"。命主務實能行，思維清晰。此日生人善於理財、管理，重實績而少虛言。性堅定而知節。宜金融、房地產、貿易諸業。健康防脾胃氣滯與眼疾，守和則安。''',
    
    '己丑': '''
己土為田園之土，土主信，坐下比肩、食神、偏財。己丑日生口快心直，通技藝人，能掌實權，誠意待人，博得眾望，衣祿不少；男人防再娶，家庭當和睦相處。女人晚年發福。
己丑通根，比丁丑好，生於得令之時為強，恐有比肩奪財爭鬥之狀；生於失令時則有兄弟幫忙。己丑日出生的人在天性上是善良的、富責任感、有度量、內向、是做事細膩的人，行動上有點慢吞吞的。
己土居丑，土氣濕潤，藏辛癸之氣。命主性慎實厚，多感於情。此日生人具耐性與持久力，處事穩而堅；然思多、易憂。財氣浮沈，宜積以時。利於務實產業，如土地、農牧、經管、工藝。健康防胃弱與水濕凝滯；勤學自進可轉機運。''',
    
    '庚寅': '''
庚金為斧鉞之金，金主義，坐下偏財、七殺、偏印。庚寅日生心性急快，有口無心，大事有藏；易好易怒，性情反覆無常，傷人還不知道；易結人緣，也易失人緣，衣祿足用；早年不聚財物，中年奔波，晚景豐隆。女人內助，理事發達，勤儉有得。
庚寅坐絕地，無根，蓋頭（干克支），女命克夫再嫁，做偏房可以，男命庚寅難得善終，但坐殺印有開拓精神，為官多清廉，支藏偏印宜做副手。
庚金坐寅木，金剋木，剛中見強。性格果敢，作風直率。若木火調氣，則剛中含柔，能成卓越之才。若金旺木衰，易過於激烈。宜武職工程、司法、科技等實務行業。健康防頭目筋骨；修心以誠，剛柔兼濟。''',
    
    '辛卯': '''
辛金為首飾之金，金主義，坐下偏財。辛卯日生口快心直，有志氣，有權柄，利官近貴，身閒心不空；六親少靠，自立家業，少年勞祿，晚年大利；女人持家，操勞，勤儉節約可興隆。
辛卯坐偏財，為福貴雙全日。辛卯日柱坐偏財，多桃花，男命喜歡女色，女命稍好，但漂亮卻難免有招蜂引蝶之嫌。
辛金坐卯木，金克木為刑中有智。命主心思銳敏，見解獨立。此日生人多具藝術與鑑賞天賦，舉止端潔。若過剛則易孤，宜以和氣自調。事宜理財、文化、醫學相關行。健康防呼吸、牙齒或筋絡之疾；勤修柔忍為福。''',
    
    '壬辰': '''
壬水為江河之水，水主智，坐下偏官、劫財、傷官。壬辰日生勞祿之人，手腳停不下來；早年難守，財來財去，晚景發達。女人操家，勤奮興旺。
壬辰日坐水庫通根身旺，坐下有劫財生食，食神制殺，身旺用殺，主貴。壬辰日為壬騎龍背，亥時生，為龍歸大海，主大貴，午時生則龍死為下等命。
壬水坐辰庫，水旺土藏，為"智潛不露"之象。性情聰慧而易動，氣勢起伏。若能以土制水，則智守分寸，福祿俱成；若水泛，則多慮多變。宜學術、流通、顧問、交通行業。婚姻平常，重情而敏感。健康防腎脾失調與肢體勞損。''',
    
    '癸巳': '''
癸水為雨露之水，水主智，坐下正財、正官、正印。癸巳日生聰明伶俐，近貴人，中年風霜，春風之徒；慎重守護已成之事業，可暫發福；好心對人，卻被人反目，晚景稍好。
癸巳日身坐正官、正印、正財，財官印連生，循環清正，主高貴、富貴或清貴，生活富裕，女命癸巳，可嫁貴夫。此日生人，主夫妻有病，或酒色荒淫。
癸水處巳火，陰陽相交。命主聰慧含蓄，富洞察力。官印並存，若能平衡五行則貴氣自顯。性情溫理，處世明潔。宜金融、設計、教育及文化產業。健康防眼疾與心煩失眠。''',
    
    '甲午': '''
甲木為棟樑之木，木主仁，坐下傷官、正財。甲午日生為人和氣，好娛樂；青春好風盪，交往朋友，利官近貴，逢凶化吉，骨肉少靠。女人口快，心直能言；愛情路上，需防禍不單行！
甲午日身坐死地，一生勞苦奔波，干生支，對妻子好，傷官生財，對長輩孝順。日主泄出丁火，主利他人，故對別人照顧有加，可自己到老，卻一無所有。
甲木臨午火，木生火旺，為"傷官生財"之象。命主思敏，富想像力而具表現欲。若能抑強守柔，則成才華之人；若氣過則多爭競。宜創意文化、教育、經商之業。感情熱烈而需節制；健康防血壓與情緒激動。''',
    
    '乙未': '''
乙木為花果之木，木主仁，坐下偏財、比肩、食神。乙未日生少年勤儉，初年平順；兄弟少靠；子息不孤；晚年聚財，可以興旺；女人持家，恩夫旺子，精打細算。
乙未坐庫通根，財星入庫，主富，但愛財卻小氣，再逢命局或大運流年沖庫，主發財。
乙木居未土，土中含木火，氣勢溫厚。命主柔中存毅，心靜而志恆。多才多藝，勤奮進取，喜文雅之事。財旺而身強，宜勤儉持家。適合設計、服務、教育、醫療行業。健康防脾胃與筋骨，安於內修則吉。''',
    
    '丙申': '''
丙火為太陽之火，火主禮，坐下偏財、食神、七殺。丙申日生衣食豐足，利路亨通，技能生財；早年勞祿，女人持家，勤儉節約，旺相發達。
丙申日柱身弱無根，妙在丙火太陽，坐下食神生財，財生殺，壬水殺旺，映照太陽光輝，主人聰明靈氣。但殺旺攻身，老來孤獨，一輩子辛苦，不能坐享其成。
丙火坐申金，為"火制金成器"。申中藏庚壬戊，生剋交融。此日生人外熱內謹，性情明亮。食神制殺，若組合得宜，主有奇思與靈慧；若火弱被金制，則多勞多思。宜從事科技、醫藥、文化、管理等業。感情有熱有冷，需誠以相待。健康防心臟與呼吸道疾。''',
    
    '丁酉': '''
丁火為燈燭之火，火主禮，坐下偏財。丁酉日生喜好面子，多情重恩，緣份奇特；利官近貴，初年勞累，身閒心苦。晚年興隆，子女有為；女人清秀吉昌，半夫半財，自立成功。
丁酉坐長生偏財、夜貴、文昌，主人高貴聰明，見識超群，受人欽敬，另有叛逆創新性格。
丁火臨酉金，為火得財之象。火照金輝，明而不烈，主福祿豐。性格精明節度，為人熱心且知分。坐下偏財，善理財運，貴人相扶。宜商業、金融、設計等行。婚緣美滿，然性急好思。健康防眼與血脈；樂觀行善則久安。''',
    
    '戊戌': '''
戊土為城牆之土，土主信，坐下比肩、正印、傷官。戊戌日生為人和氣，獨立自營；早年顛倒運程，是非耗財；中年貪求，欲望高昂，遭人妒嫉。自重；苦學技藝，學有工夫之命。女人育養，中平之命運。
戊戌為魁罡日，坐庫通根，土太燥，吉中帶凶。魁罡主人心直口快，臨事果斷，也主聰明，文章振發，但處理事情不夠委婉，所以常得罪人。
戊土坐戌土，土重氣厚，藏辛丁戊。此為"傷官佩印"之象。性剛果敢，才華外顯。若火土適中，則文質並茂；若土壅火熾，易倔好強。宜管理、建築、策劃、學術工作；少說多行為福。健康防皮膚與消化。''',
    
    '己亥': '''
己土為田園之土，土主信，坐下正財、正官。己亥日生計巧伶俐，衣食安穩，骨肉少力，六親冷淡，兒女早見刑克，遲到稍好；夫妻和順。女人清閒，晚年好。
乙亥日坐正財、正官，為財官雙美，主貴。女命己亥，也可嫁貴夫。
己土坐亥水，水潤土柔。命主聰明穩重，操行謙厚。得"財生官"之氣，志在事業，凡事堅忍。配偶多助，行動務實。宜管理、教育、金融及實業。健康防腎水與脾胃寒濕；靜心則長富。''',
    
    '庚子': '''
庚金為斧鉞之金，金主義，坐下傷官。庚子日生持重，安穩，衣祿無虧，妻子賢慧，持家有方，建交貴人，提拔機遇，逢凶化吉。女人興旺，福蔭家庭。
庚子日坐傷官，女命克夫。干支金水相生，人秀麗、聰明，但耿直，講義氣。做官宜檢調、法務部門。
庚金據子水，金生水旺，才思聰慧。氣象寒靜，心性敏銳。若火來煉金則成器，無火則冷峭孤傲。適合技術、藝術、教育、科技與研究事業。感情理智，但需溫情調和。健康宜護腰骨與血氣。''',
    
    '辛丑': '''
辛金為首飾之金，金主義，坐下偏印、食神、比肩。辛丑日生心性溫和，早年須防驚恐，意外之厄；雖有衣祿，骨肉少力，晚年好，女人旺家，事多發達。
辛丑日通根，坐下有印、比、食神，主人靈秀，女命辛丑身材好，秀氣，守家。
辛金臨丑土，土金相生，為質厚而堅之象。性情沉穩而明理，言行有度。身旺若得火水調氣，則可貴顯；若偏於剛寒，則孤高。宜金融、工業、設計、審計類工作。健康防呼吸與關節；平和待人為佳。''',
    
    '壬寅': '''
壬水為江河之水，水主智，坐下食神、偏財、偏官。壬寅日生為人口快心直，男女都不能早結婚，若早結婚夫妻便相剋。兒女宜遲，初年顛倒，中年興旺。女人如意，發福之命。
壬寅日柱，身坐食神生偏財再生殺，又為壬騎虎背，主富貴雙全，干支相生，家庭圓滿。
壬水坐寅木，水生木、木生火，氣脈流通，吉象居多。性情仁厚，智慧兼容，行事踏實。宜教育、經商、服務業皆利。家庭和諧，子女有成。健康宜節食護肝，心平則安。''',
    
    '癸卯': '''
癸水為雨露之水，水主智，坐下食神。癸卯日生衣食不少，凶中化吉，早年不順，財來財去，晚年好。女人操持之命，遭遇妒嫉，好事難全，少年弱，中年勞祿，老有歡樂。
癸卯日坐長生、日貴，食神吐秀，主人聰明有文才，個性溫和善良、斯文，忠厚圓滿，人緣佳，易受人歡迎、賞識。女命癸卯，生子讀書有成。夫妻多恩愛，家庭幸福。
癸水居卯木，為"長生"之地，水木相生而氣質清秀。主性情溫柔、思敏而有文采。為人誠淨，重情義。適宜文化、教育、藝術、心理等行業。感情平和，家庭順遂。健康防目疾與寒濕。''',
    
    '甲辰': '''
甲木為棟樑之木，木主仁，坐下偏財、劫財、正印。甲辰日生衣食豐足，清閒心情；早年弱，中年勤奮，情感有波折，事業發達，晚結婚，子女宜遲，幫助多。
甲辰日柱得氣通根，坐下有偏財破印，缺少貴氣，前半生不太好，後半生平安，財祿豐足。
甲木臨辰庫，木得水潤兼遇土。聰敏且志廣，然易多思。財氣深藏，宜以勤勞致富。若火助，則光顯；若水過，則憂懷。事業以實業、教學、規劃為宜。感情厚重，需理解包容；防脾胃宿疾。''',
    
    '乙巳': '''
乙木為花果之木，木主仁，坐下傷官、正財、正官。乙巳日生為人好面子，救人無功；好事莫望；早年子女刑克，晚年安寧。女人助夫愛子。
乙木向陽，英華外發，主人聰明，但泄氣，只利他人，不利己。坐下傷官、正財、正官順生，有錢，富裕。男命乙巳，多晚婚，可得賢妻，但支中傷官見官，過於剛強，不守紀律。
乙木居巳火，木得火榮，含有"食神生財"之理。氣場活潑、思維靈敏。性情善感，具藝術氣質。然火多則易躁，需靜養以平。宜文化設計、教育、科技行業。健康防眼與心火；適度運動可調氣。''',
    
    '丙午': '''
丙火為太陽之火，火主禮，坐下劫財、傷官、羊刃。丙午日生身閒心不空，初年耗財，宜做基礎，技能工夫，求名不利，事多爭端，兄弟各方。女人清秀，思維奇妙。
丙午日坐羊刃，過剛，人聰明有文才。男命克妻，女命克夫，不論男女生於丙午，容易受傷，或致殘。武官則不善終。
丙火臨午火，火炎照天。志氣昂揚，性格直爽。此日生人熱誠豪爽，宜領導創業、科技文化之職。火旺則易急，當節氣以和人。婚姻宜柔化剛。健康防血壓與眼疾；養心寡欲福自長。''',
    
    '丁未': '''
丁火為燈燭之火，火主禮，坐下食神、比肩、偏印。丁未日生喜怒無常，口舌能言，名利不缺，骨肉疏遠，子息遲到；衣祿豐足；女人有旺運，勤儉能興家。
丁未日生得庫通根，羊刃在支，坐下食神旺，也主人漂亮，但好吃，女命賢慧。
丁火坐未土，土藏乙丁己，印比並見。氣勢祥和，性婉而堅。此日生人溫文勤謹，處事有條理，喜靜而思深。宜教育、醫療、管理及文職。感情圓融，家庭安穩。防脾胃虛弱與思慮過度。''',
    
    '戊申': '''
戊土為城牆之土，土主信，坐下食神、偏財、比肩。戊申日生為人性急，易反覆無常；一生勞祿，利官見貴，兒女刑傷，財庫富足，女人有旺運，勤儉能興家。
戊申日土猴孤獨，女命早婚者易離婚，或孤身；男命稍好。不論年、月何柱出現，亦均漂亮，但愛情不專，作風不正。
戊土居申金，土生金旺，財氣通達。性格厚實誠樸，志行穩健。主有謀略，善理項目與財務。若火見則顯達。宜實業、金融、礦業、交通等。感情敦厚而需體恤。健康防腸胃、皮膚與筋骨。''',
    
    '己酉': '''
己土為田園之土，土主信，坐下食神。己酉日生為人聰明，衣祿豐足，六親少靠，兒女早見；凡事寬量，百事通達，女人技巧多變，少災之命。
己酉日坐長生、文昌，主人好文學，聰明有文才，且土金相生，主人身體好，但干生支，畢竟泄氣，故得失都有。
己土坐酉金，金生助力，氣厚而潤。性情溫順謙實，內智外靜。日主偏印轉生財氣，行運得宜則富。宜金融、建築、教育及服務業。情感平緩，家道安；健康防肺弱與耳疾。''',
    
    '庚戌': '''
庚金為斧鉞之金，金主義，坐下偏印、正官、劫財。庚戌日生利官近貴，敏捷聰明，福氣晚年，救人無義；女人心賢，勤奮方能興家。
庚戌日柱，坐庫通根身強，為「魁罡」，聰明剛毅，有文才，忠義雙全。此日生人，個性較為倔強、固執，在中國古社會對魁罡日出生的人，評語普遍認為是大成大敗，因為堅持力、執著力強，所以較常人更具成功的條件。
庚金據戌，火土生金，剛正中含柔。理智強健，具組織能力。正官制劫而印生身，此日多能執政理事。宜公務、軍警、機構管理之職。健康宜護肝肌；感情重信義，婚姻需互諒。''',
    
    '辛亥': '''
辛金為首飾之金，金主義，坐下傷官、正財。辛亥日生不惹閒事，清靜守中；早年不聚財，晚景榮華富貴。女人勤儉，福豐，助立家業。
辛亥日柱干支相生，金水相連，文才好（女命稍差）。坐沐浴，女命不貞，坐下傷官旺不利夫。男命可得妻財，或漂亮之妻。
辛金臨亥水，為"傷官生財"之象。性秀而聰慧，才思敏捷。以金水之智取財，宜從商、創意、藝術或顧問業。感情豐而專，婚姻需溝通。健康防腎臟與神經緊張；修心則安吉。''',
    
    '壬子': '''
壬水為江河之水，水主智，坐下劫財。壬子日生幼年顯災，中年衣食豐足，男有好妻，身閒心勞，多喜多憂，奔波事業；兄弟少力，六親冷淡，勤奮自立；女人賢能，防止嫉妒。
壬子日坐刃、坐劫財，水太旺，漂亮。女命不會持家，有多少花多少，花心；男命好色，若經商發財，發多少失多少。
壬水坐子水，水旺生聰。智性高遠，思維靈活。若土制有度則富貴，水泛則多奔波。宜教育、科技、流通與旅運。感情深遠而遷變多，慎理情志；健康防腰腎與血壓。''',
    
    '癸丑': '''
癸水為雨露之水，水主智，坐下偏官、偏印、比肩。癸丑日生衣祿不少，凶中化吉，早年不順，財來財去，晚年好。女人操持之命，遭遇妒嫉，好事難全，少年弱，中年勞祿，老有歡樂。
癸丑日生坐庫通根臨羊刃，人秀氣，坐下殺印生比肩，利兄弟，做事吃力不討好，勞累奔波。癸水日主之人如果旁干多癸水必然記憶力極強，但如致身強必較保守，膽小而節儉。
癸水居丑土，水潤而藏。性柔而堅，心思細膩。日主能化殺而生印，主聰明有恒，勤於規劃。宜金融、工程、管理或醫學。感情穩定，配偶助力。健康防寒濕與胃氣。''',
    
    '甲寅': '''
甲木為棟樑之木，木主仁，坐下比肩、食神、偏印。甲寅日生為人誠實，利官見貴，家道興盛，父母有利，重拜雙親，男人怕妻，命硬三分。女人管夫，子息長。
甲寅日柱身坐建祿，木旺身強，主人正直，性格仁慈。坐下比肩幫身，食神泄秀，偏印生身，一片順生，主富貴。女命甲寅，克夫，需配強者方能和諧。
甲木居寅木，木氣專旺，為"建祿"之象。性情剛正，志氣高昂，具領導與開創精神。此日生人重義輕財，處事果決。若火來生身則光顯；若水多則木浮，宜守穩。宜實業、教育、管理之職。感情厚重，需互諒包容；健康防筋骨與肝膽。''',
    
    '乙卯': '''
乙木為花果之木，木主仁，坐下比肩。乙卯日生志氣軒昂，衣祿豐足，計巧精妙，言行有詐，有成有敗；文武兩業，坎坷難免，金石為開，一事可成，女人福祿，勤儉添壽。
乙卯日坐建祿，木旺身強，主人秀氣，性格溫和。坐下比肩幫身，主自立。若四柱有財官透干，主貴。女命乙卯，美麗，但易有感情波折。
乙木居卯木，木氣專旺，為"建祿"之地。性情溫柔而堅韌，心靈手巧，具藝術與創造天賦。此日生人處事細膩，善於溝通。若金來制木則貴顯；若火多則木焦，宜適度。宜文化、設計、教育、服務業。感情細膩而需誠意；健康防肝膽與筋骨。''',
    
    '丙辰': '''
丙火為太陽之火，火主禮，坐下食神、正官、正印。丙辰日生聰明才智，手足伶俐，衣祿無虧；身閒心勞，愛交朋友，中年興隆，女人犧牲利益，持家方興旺。
丙辰日坐冠帶，火旺身強，主人聰明，性格開朗。坐下食神生財，正官制身，正印生身，一片順生，主富貴。女命丙辰，旺夫益子。
丙火居辰土，火生土旺，為"食神制殺"之象。性情開朗，熱情洋溢，具領導與表現能力。此日生人重情重義，處事明快。若水來制火則貴顯；若木多則火熾，宜平衡。宜教育、管理、文化、能源業。感情熱烈而需節制；健康防眼疾與心火。''',
    
    '丁巳': '''
丁火為燈燭之火，火主禮，坐下劫財、傷官、正財。丁巳日生為人剛烈，聰明伶俐，但喜怒無常；一生奔波，難享祖業，全靠自立，白手成家，人緣關係好。
丁巳日坐帝旺，火旺身強，主人聰明，性格剛烈。坐下劫財幫身，傷官泄秀，正財生身，主富貴。但火過旺，需水調候。女命丁巳，美麗，但易有感情波折。
丁火居巳火，火炎照天，為"帝旺"之象。性情剛烈，志氣昂揚，具創新與突破精神。此日生人處事果決，敢於冒險。若水來調候則貴顯；若火過旺則急躁，宜修養。宜科技、能源、文化、管理之職。感情熱烈而需穩重；健康防血壓與眼疾。''',
    
    '戊午': '''
戊土為城牆之土，土主信，坐下正印、劫財。戊午日生為人溫和，重義輕財；六親和睦，兄弟相幫，早年波折，中晚年興旺；女人持家方興旺，男人顧家多利業。
戊午日坐帝旺，土旺身強，主人穩重，性格溫和。坐下正印生身，劫財幫身，主富貴。但土過旺，需木疏土。女命戊午，旺夫益子。
戊土居午火，火生土旺，為"正印生身"之象。性情穩重，誠實可靠，具責任與包容能力。此日生人處事踏實，重信守諾。若木來疏土則貴顯；若土過旺則固執，宜靈活。宜實業、金融、教育、管理之職。感情穩重而需體恤；健康防脾胃與血壓。''',
    
    '己未': '''
己土為田園之土，土主信，坐下比肩、偏印、偏財。己未日生口快心硬，衣祿小有，得貴人幫，體重勤儉，工作認真；女人賢慧持家，兒女晚見，辛苦中求發展，晚年對眼疾，應注意。
己未日坐冠帶，土旺身強，主人穩重，性格溫和。坐下比肩幫身，偏印生身，偏財生身，主富貴。女命己未，美麗，旺夫益子。
己土居未土，土氣專旺，為"比肩幫身"之象。性情穩重，勤奮踏實，具持家與理財能力。此日生人處事細心，重實際。若木來疏土則貴顯；若火來生土則富厚，宜平衡。宜實業、金融、教育、服務業。感情穩重而需溝通；健康防脾胃與筋骨。''',
    
    '庚申': '''
庚金為斧鉞之金，金主義，坐下比肩、食神、偏印。庚申日生手足不停，為人清高，利官近貴；夫妻口角，煩多愛少，做好事難得好報，救人無功，遭遇妒嫉；女人興旺，勤儉持家。
庚申日坐建祿，金旺身強，主人剛強，性格正直。坐下比肩幫身，食神泄秀，偏印生身，主富貴。女命庚申，美麗，但易有感情波折。
庚金居申金，金氣專旺，為"建祿"之象。性情剛強，正直無私，具開創與突破能力。此日生人處事果決，重義輕財。若火來煉金則成器；若水多則金沉，宜適度。宜軍警、工程、科技、管理之職。感情剛烈而需柔化；健康防肺與筋骨。''',
    
    '辛酉': '''
辛金為首飾之金，金主義，坐下比肩。辛酉日生為人伶俐，面氣清爽，艱辛創業，自謀高見，口舌能言，高人敬重，財力廣大，六親冷淡，骨肉情疏，女人賢達。
辛酉日坐建祿，金旺身強，主人聰明，性格溫和。坐下比肩幫身，主自立。若四柱有財官透干，主貴。女命辛酉，美麗，但易有感情波折。
辛金居酉金，金氣專旺，為"建祿"之地。性情溫和，聰明伶俐，具藝術與審美能力。此日生人處事細膩，善於溝通。若火來煉金則成器；若水多則金沉，宜適度。宜文化、藝術、金融、設計之職。感情細膩而需誠意；健康防肺與牙齒。''',
    
    '壬戌': '''
壬水為江河之水，水主智，坐下偏官、偏印、劫財。壬戌日生好行善事，四處不停，心勞尤多，衣食不缺，結交貴人，提拔機遇，早年平，中年奔波，老年豐隆。女人助夫，勤儉持家。
壬戌日坐冠帶，水旺身強，主人聰明，性格溫和。坐下偏官制身，偏印生身，劫財幫身，主富貴。女命壬戌，美麗，旺夫益子。
壬水居戌土，水土交融，為"偏官制身"之象。性情聰明，善於應變，具智慧與謀略能力。此日生人處事靈活，重情重義。若土來制水則貴顯；若水過旺則泛濫，宜節制。宜教育、科技、流通、服務業。感情深遠而需穩定；健康防腎與脾胃。''',
    
    '癸亥': '''
癸水為雨露之水，水主智，坐下傷官、劫財。癸亥日生為人剛直，言語坦然，不順人情；六親疏遠，交往淡淡；自立家業，女人緣旺，機會屢屢，但多不相對，晚景發達。
癸亥日坐帝旺，水旺身強，主人聰明，性格剛直。坐下傷官泄秀，劫財幫身，主富貴。但水過旺，需土制水。女命癸亥，美麗，但易有感情波折。
癸水居亥水，水氣專旺，為"帝旺"之象。性情剛直，聰明伶俐，具創造與表達能力。此日生人處事靈活，善於溝通。若土來制水則貴顯；若水過旺則泛濫，宜節制。宜文化、藝術、教育、服務業。感情豐富而需穩定；健康防腎與脾胃。'''
}

_day_pillar = ''.join(zhus[2])  # 例如：'丙寅'
if _day_pillar in day_pillar_detail:
    _orig_print("="*120)
    _orig_print("日柱解讀：【{}】".format(_day_pillar))
    # 直接输出详细内容，移除空行
    detail_content = day_pillar_detail[_day_pillar].strip()
    # 移除空行（连续的换行符）
    detail_content = re.sub(r'\n\s*\n+', '\n', detail_content)
    _orig_print(detail_content)
    _orig_print("="*120)

print("-"*120)
print("{1:{0}^15s}{2:{0}^15s}{3:{0}^15s}{4:{0}^15s}".format(chr(12288), '【年】{}:{}{}{}'.format(temps[gans.year],temps[zhis.year],ten_deities[gans.year].inverse['建'], gan_zhi_he(zhus[0])), 
    '【月】{}:{}{}{}'.format(temps[gans.month],temps[zhis.month], ten_deities[gans.month].inverse['建'], gan_zhi_he(zhus[1])),
    '【日】{}:{}{}'.format(temps[me], temps[zhis.day], gan_zhi_he(zhus[2])), 
    '【时】{}:{}{}{}'.format(temps[gans.time], temps[zhis.time], ten_deities[gans.time].inverse['建'], gan_zhi_he(zhus[3]))))
print("-"*120)


print("\033[1;36;40m{1:{0}<15s}{2:{0}<15s}{3:{0}<15s}{4:{0}<15s}\033[0m".format(
    chr(12288),
    '{}{}{}【{}】{}'.format(
        gans.year, yinyang(gans.year), gan5[gans.year], ten_deities[me][gans.year], check_gan(gans.year, gans)),
    '{}{}{}【{}】{}'.format(
        gans.month, yinyang(gans.month), gan5[gans.month], ten_deities[me][gans.month], check_gan(gans.month, gans)),
    '{}{}{}{}'.format(me, yinyang(me),gan5[me], check_gan(me, gans)),
    '{}{}{}【{}】{}'.format(gans.time, yinyang(gans.time), gan5[gans.time], ten_deities[me][gans.time], check_gan(gans.time, gans)),
))

print("\033[1;36;40m{1:{0}<15s}{2:{0}<15s}{3:{0}<15s}{4:{0}<15s}\033[0m".format(
    chr(12288),
    "{}{}{}{}【{}】{}{}".format(
        zhis.year, yinyang(zhis.year), ten_deities[gans.year][zhis.year], ten_deities[gans.month][zhis.year],ten_deities[me][zhis.year], ten_deities[gans.time][zhis.year], get_empty(zhus[2],zhis.year)),
    "{}{}{}{}【{}】{}{}".format(
        zhis.month, yinyang(zhis.month), ten_deities[gans.year][zhis.month], ten_deities[gans.month][zhis.month],ten_deities[me][zhis.month], ten_deities[gans.time][zhis.month], get_empty(zhus[2],zhis.month)),
    "{}{}{}{}【{}】{}".format(zhis.day, yinyang(zhis.day),  ten_deities[gans.year][zhis.day], ten_deities[gans.month][zhis.day], ten_deities[me][zhis.day], ten_deities[gans.time][zhis.day],),   
    "{}{}{}{}【{}】{}{}".format(
        zhis.time, yinyang(zhis.time), ten_deities[gans.year][zhis.time], ten_deities[gans.month][zhis.time],ten_deities[me][zhis.time], ten_deities[gans.time][zhis.time], get_empty(zhus[2],zhis.time)),
))

 

statuses = [ten_deities[me][item] for item in zhis]


for seq, item in enumerate(zhis):
    out = ''
    multi = 2 if item == zhis.month and seq == 1 else 1

    for gan in zhi5[item]:
        out = out + "{}{}{}　".format(gan, gan5[gan], ten_deities[me][gan])
    print("\033[1;36;40m{1:{0}<15s}\033[0m".format(chr(12288), out.rstrip('　')), end='')

print()
# 输出地支关系
for seq, item in enumerate(zhis):

    output = ''
    others = zhis[:seq] + zhis[seq+1:] 
    for type_ in zhi_atts[item]:
        flag = False
        if type_ in ('害',"破","会",'刑'):
            continue
        for zhi in zhi_atts[item][type_]:
            if zhi in others:
                if not flag:
                    output = output + "　" + type_ + "：" if type_ not in ('冲','暗') else output + "　" + type_
                    flag = True
                if type_ not in ('冲','暗'):
                    output += zhi
        output = output.lstrip('　')
    print("\033[1;36;40m{1:{0}<15s}\033[0m".format(chr(12288), output), end='')

print()

# 输出地支minor关系
for seq, item in enumerate(zhis):

    output = ''
    others = zhis[:seq] + zhis[seq+1:] 
    for type_ in zhi_atts[item]:
        flag = False
        if type_ not in ('害',"破","会",'刑'):
            continue
        for zhi in zhi_atts[item][type_]:
            if zhi in others:
                if not flag:
                    output = output + "　" + type_ + "："
                    flag = True
                output += zhi
    output = output.lstrip('　')
    print("\033[1;36;40m{1:{0}<15s}\033[0m".format(chr(12288), output), end='')

print()

# 输出根
for  item in gans:
    output = output.lstrip('　')
    print("\033[1;36;40m{1:{0}<15s}\033[0m".format(chr(12288), get_gen(item, zhis)), end='')

print()

for seq, item in enumerate(zhus):

    # 检查空亡 
    result = "{}－{}".format(nayins[item], '亡') if zhis[seq] == wangs[zhis[0]] else nayins[item]
    
    # 天干与地支关系
    result = relations[(gan5[gans[seq]], zhi_wuhangs[zhis[seq]])] + result
        
    # 检查劫杀 
    result = "{}－{}".format(result, '劫杀') if zhis[seq] == jieshas[zhis[0]] else result
    # 检查元辰
    result = "{}－{}".format(result, '元辰') if zhis[seq] == Zhi[(Zhi.index(zhis[0]) + direction*-1*5)%12] else result    
    print("{1:{0}<15s} ".format(chr(12288), result), end='')

print()

all_ges = []

# 神煞计算

strs = ['','','','',]

all_shens = set()
all_shens_list = []

for item in year_shens:
    for i in (1,2,3):
        if zhis[i] in year_shens[item][zhis.year]:    
            strs[i] = item if not strs[i] else strs[i] + chr(12288) + item
            all_shens.add(item)
            all_shens_list.append(item)
            
for item in month_shens:
    for i in range(4):
        if gans[i] in month_shens[item][zhis.month] or zhis[i] in month_shens[item][zhis.month]:     
            strs[i] = item if not strs[i] else strs[i] + chr(12288) + item
            if i == 2 and gans[i] in month_shens[item][zhis.month]:
                strs[i] = strs[i] + "●"
            all_shens.add(item)
            all_shens_list.append(item)
            
for item in day_shens:
    for i in (0,1,3):
        if zhis[i] in day_shens[item][zhis.day]:     
            strs[i] = item if not strs[i] else strs[i] + chr(12288) + item    
            all_shens.add(item)
            all_shens_list.append(item)
            
for item in g_shens:
    for i in range(4):
        if zhis[i] in g_shens[item][me]:    
            strs[i] = item if not strs[i] else strs[i] + chr(12288) + item
            all_shens.add(item)
            all_shens_list.append(item)
            
# print(all_shens_list)
#print(strs)           
for seq in range(2):
    print("{1:{0}<15s} ".format(chr(12288), strs[seq]), end='')
for seq in range(2,4):
    print("{1:{0}<14s} ".format(chr(12288), strs[seq]), end='')
    


# 计算六合:相邻的才算合

zhi_6he = [False, False, False, False]

for i in range(3):
    if zhi_atts[zhis[i]]['六'] == zhis[i+1]:
        zhi_6he[i] = zhi_6he[i+1] = True
        
# 计算六冲:相邻的才算合

zhi_6chong = [False, False, False, False]

for i in range(3):
    if zhi_atts[zhis[i]]['冲'] == zhis[i+1]:
        zhi_6chong[i] = zhi_6chong[i+1] = True
        
# 计算干合:相邻的才算合

gan_he = [False, False, False, False]
for i in range(3):
    if (gans[i],gans[i+1]) in set(gan_hes) or (gans[i+1],gans[i]) in set(gan_hes):
        gan_he[i] = gan_he[i+1] = True
        
# 计算刑:相邻的才算

zhi_xing = [False, False, False, False]

for i in range(3):
    if zhi_atts[zhis[i]]['刑'] == zhis[i+1] or zhi_atts[zhis[i+1]]['刑'] == zhis[i]:
        zhi_xing[i] = zhi_xing[i+1] = True
print()
print("-"*120)       


if options.b:
    print("大运：", end=' ')
    for item in dayuns:
        print(item, end=' ')
    print()

else:
    for dayun in yun.getDaYun()[1:]:
        gan_ = dayun.getGanZhi()[0]
        zhi_ = dayun.getGanZhi()[1]
        fu = '*' if (gan_, zhi_) in zhus else " "
        zhi5_ = ''
        for gan in zhi5[zhi_]:
            zhi5_ = zhi5_ + "{}{}　".format(gan, ten_deities[me][gan]) 
        
        zhi__ = set() # 大运地支关系
        
        for item in zhis:
        
            for type_ in zhi_atts[zhi_]:
                if item in zhi_atts[zhi_][type_]:
                    zhi__.add(type_ + ":" + item)
        zhi__ = '  '.join(zhi__)
        
        empty = chr(12288)
        if zhi_ in empties[zhus[2]]:
            empty = '空'        
        
        jia = ""
        if gan_ in gans:
            for i in range(4):
                if gan_ == gans[i]:
                    if abs(Zhi.index(zhi_) - Zhi.index(zhis[i])) == 2:
                        jia = jia + "  --夹：" +  Zhi[( Zhi.index(zhi_) + Zhi.index(zhis[i]) )//2]
                    if abs( Zhi.index(zhi_) - Zhi.index(zhis[i]) ) == 10:
                        jia = jia + "  --夹：" +  Zhi[(Zhi.index(zhi_) + Zhi.index(zhis[i]))%12]
                
        out = "{1:<4d}{2:<5s}{3} {15} {14} {13}  {4}:{5}{8}{6:{0}<6s}{12}{7}{8}{9} - {10:{0}<10s} {11}".format(
            chr(12288), dayun.getStartAge(), '', dayun.getGanZhi(),ten_deities[me][gan_], gan_,check_gan(gan_, gans), 
            zhi_, yinyang(zhi_), ten_deities[me][zhi_], zhi5_, zhi__,empty, fu, nayins[(gan_, zhi_)], ten_deities[me][zhi_]) 
        gan_index = Gan.index(gan_)
        zhi_index = Zhi.index(zhi_)
        out = out + jia + get_shens(gans, zhis, gan_, zhi_)
        
        print(out)
        zhis2 = list(zhis) + [zhi_]
        gans2 = list(gans) + [gan_]

print("-"*120)

me_lu = ten_deities[me].inverse['建']

me_jue = ten_deities[me].inverse['绝']
me_tai = ten_deities[me].inverse['胎']
me_di = ten_deities[me].inverse['帝']
shang = ten_deities[me].inverse['伤']
shang_lu = ten_deities[shang].inverse['建']
shang_di = ten_deities[shang].inverse['帝']
yin = ten_deities[me].inverse['印']
yin_lu = ten_deities[yin].inverse['建']
xiao = ten_deities[me].inverse['枭']
xiao_lu = ten_deities[xiao].inverse['建']
cai = ten_deities[me].inverse['财']
cai_lu = ten_deities[cai].inverse['建']
cai_di = ten_deities[cai].inverse['帝']
piancai = ten_deities[me].inverse['才']
piancai_lu = ten_deities[piancai].inverse['建']
piancai_di = ten_deities[piancai].inverse['帝']
guan = ten_deities[me].inverse['官']
guan_lu = ten_deities[guan].inverse['建']
guan_di = ten_deities[guan].inverse['帝']
sha = ten_deities[me].inverse['杀']
sha_lu = ten_deities[sha].inverse['建']
sha_di = ten_deities[sha].inverse['帝']

jie = ten_deities[me].inverse['劫']
shi = ten_deities[me].inverse['食']
shi_lu = ten_deities[shi].inverse['建']
shi_di = ten_deities[shi].inverse['帝']

me_ku = ten_deities[me]['库'][0]
cai_ku = ten_deities[cai]['库'][0]
guan_ku = ten_deities[guan]['库'][0]
yin_ku = ten_deities[yin]['库'][0]
shi_ku = ten_deities[shi]['库'][0]



print("调候：", tiaohous['{}{}'.format(me, zhis[1])], "\t##金不换大运：", jinbuhuan['{}{}'.format(me, zhis[1])])
print("金不换大运：说明：", jins['{}'.format(me)])
print("格局选用：", ges[ten_deities[me]['本']][zhis[1]])
if len(set('寅申巳亥')&set(zhis)) == 0:
    print("缺四生/寅申巳亥：一生不敢作为")
if len(set('子午卯酉')&set(zhis)) == 0:
    print("缺四柱地支缺四正/子午卯酉，一生避是非")
if len(set('辰戌丑未')&set(zhis)) == 0:
    print("四柱地支缺四库/辰戌丑未，一生没有潜伏性凶灾。")
if ( '甲', '戊', '庚',) in (tuple(gans)[:3], tuple(gans)[1:]):
    print("地上三奇：白天生有申佳，需身强四柱有贵人。")
if ( '辛', '壬', '癸',) in (tuple(gans)[:3], tuple(gans)[1:]):
    print("人间三奇，需身强四柱有贵人。")
if ( '乙', '丙', '丁',) in (tuple(gans)[:3], tuple(gans)[1:]):
    print("天上三奇：晚上生有亥佳，需身强四柱有贵人。")
    
if zhi_shens2.count('亡神') > 1:
    print("二重亡神，先丧母；")
    
if get_empty(zhus[2],zhis.time):
    print("时坐空亡，子息少。 母法P24-41 母法P79-4：损破祖业，后另再成就。")
    
if zhis.count(me_jue) + zhis.count(me_tai) > 2:
    print("胎绝超过3个：夭或穷。母法P24-44 丁未 壬子 丙子 戊子")
       
if not_yang() and zhi_ku(zhis[2], (me,jie)) and zhi_ku(zhis[3], (me,jie)):
    print("阴日主时日支入比劫库：性格孤独，难发达。母法P28-112 甲申 辛未 辛丑 己丑 母法P55-11 为人孤独，且有灾疾")

#print(cai_lu, piancai_lu)
if zhis[1:].count(piancai_lu) + zhis[1:].count(cai_lu) + zhis[1:].count(piancai_di) + zhis[1:].count(cai_di) == 0:
    print("月日时支没有财或偏财的禄旺。")
    
if zhis[1:].count(guan_lu) + zhis[1:].count(guan_di) == 0:
    print("月日时支没有官的禄旺。")
    
if '辰' in zhis and ('戌' not in zhis) and options.n: 
    print("女命有辰无戌：孤。")
if '戌' in zhis and ('辰' not in zhis) and options.n: 
    print("女命有戌无辰：带禄。")
    
if emptie4s.get(zhus[2], 0) != 0:
    if scores[emptie4s.get(zhus[2], 0)] == 0:
        print("四大空亡：33岁以前身体不佳！")

for item in all_shens:
    print(item, ":",  shens_infos[item])
    
if options.n:
    print("#"*20, "女命")
    if all_shens_list.count("驿马") > 1:
        print("二逢驿马，母家荒凉。P110 丙申 丙申 甲寅 丁卯")
    if gan_shens[0] == '伤':
        print("年上伤官：带疾生产。P110 戊寅 戊午 丁未 丁未")    

print("-"*120)
            


children = ['食','伤'] if options.n else ['官','杀']

liuqins = bidict({'才': '父亲',"财":'财' if options.n else '妻', "印": '母亲', "枭": '偏印' if options.n else '祖父',
                  "官":'丈夫' if options.n else '女儿', "杀":'情夫' if options.n else '儿子', "劫":'兄弟' if options.n else '姐妹', "比":'姐妹' if options.n else '兄弟', 
                  "食":'女儿' if options.n else '下属', "伤":'儿子' if options.n else '孙女'})

# 六亲分析
for item in Gan:
    print("{}:{} {}-{} {} {} {}".format(item, ten_deities[me][item], liuqins[ten_deities[me][item]],  ten_deities[item][zhis[0]] ,ten_deities[item][zhis[1]], ten_deities[item][zhis[2]], ten_deities[item][zhis[3]]), end='  ')
    if Gan.index(item) == 4:
        print()
    
print()
print()

# 计算上运时间，有年份时才适用



gongs = get_gong(zhis)
zhis_g = set(zhis) | set(gongs)

jus = []
for item in zhi_hes:
    if set(item).issubset(zhis_g):
        print("三合局", item)
        jus.append(ju[ten_deities[me].inverse[zhi_hes[item]]])
        
        
for item in zhi_huis:
    if set(item).issubset(zhis_g):
        print("三会局", item)
        jus.append(ju[ten_deities[me].inverse[zhi_huis[item]]])

for item in gan_scores:  
    print("{}[{}]-{} ".format(
        item, ten_deities[me][item], gan_scores[item]),  end='  ')    
print()
print("-"*120)
yinyangs(zhis)
shen_zhus = list(zip(gan_shens, zhi_shens))

minggong = Zhi[::-1][(Zhi.index(zhis[1]) + Zhi.index(zhis[3]) -6  )%12 ]
print(minggong, minggongs[minggong])
print("坐：", rizhus[me+zhis.day])



# 地网
if '辰' in zhis and '巳' in zhis:
    print("地网：地支辰巳。天罗：戌亥。天罗地网全凶。")
    
# 天罗
if '戌' in zhis and '亥' in zhis:
    print("天罗：戌亥。地网：地支辰巳。天罗地网全凶。")

# 魁罡格
if zhus[2] in (('庚','辰'), ('庚','戌'),('壬','辰'), ('戊','戌'),):
    print("魁罡格：基础96，日主庚辰,庚戌,壬辰, 戊戌，重叠方有力。日主强，无刑冲佳。")
    print("魁罡四柱曰多同，贵气朝来在此中，日主独逢冲克重，财官显露祸无穷。魁罡重叠是贵人，天元健旺喜临身，财官一见生灾祸，刑煞俱全定苦辛。")

# 金神格
if zhus[3] in (('乙','丑'), ('己','巳'),('癸','酉')):
    print("金神格：基础97，时柱乙丑、己巳、癸酉。只有甲和己日，甲日为主，甲子、甲辰最突出。月支通金火2局为佳命。不通可以选其他格")
    
# 六阴朝阳
if me == '辛' and zhis.time == '子':
    print("六阴朝阳格：基础98，辛日时辰为子。")
    
# 六乙鼠贵
if me == '乙' and zhis.time == '子':
    print("六阴朝阳格：基础99，乙日时辰为子。忌讳午冲，丑合，不适合有2个子。月支最好通木局，水也可以，不适合金火。申酉大运有凶，午也不行。夏季为伤官。入其他格以格局论。")

# 从格
if max(scores.values()) > 25:
    print("有五行大于25分，需要考虑专格或者从格。")
    print("从旺格：安居远害、退身避位、淡泊名利,基础94;从势格：日主无根。")
    
    
if zhi_6he[3]:
    if abs(Gan.index(gans[3]) - Gan.index(gans[2])) == 1:
        print("日时干邻支合：连珠得合：妻贤子佳，与事业无关。母法总则P21-11")
        
for i,item in enumerate(zhis):
    if item == me_ku:
        if gan_shens[i] in ('才','财'):
            print("财坐劫库，大破败。母法P61-4 戊寅 丙辰 壬辰 庚子")
            
#print(zhi_6chong[3], gans, me)
if zhi_6chong[3] and  gans[3] == me:
    print("日时天比地冲：女为家庭辛劳，男艺术宗教。 母法P61-5 己丑 丙寅 甲辰 甲戌")
    
#print(zhi_6chong[3], gans, me)
if zhi_xing[3] and  gan_ke(me, gans[3]):
    print("日时天克地刑：破败祖业、自立发展、后无终局。 母法P61-7 己丑 丙寅 甲午 庚午") 
    
if (cai,yin_lu) in zhus and (cai not in zhi_shens2):
    print("浮财坐印禄:破祖之后，自己也败。 母法P78-29 辛丑 丁酉 壬寅 庚子") 
    
    
for i in range(3):
    if is_yang():
        break
    if zhi_xing[i] and zhi_xing[i+1] and gan_ke(gans[i], gans[i+1]):
        print("阴日主天克地刑：孤独、双妻。 母法P61-7 己丑 丙寅 甲午 庚午") 


# 建禄格
if zhi_shens[1] == '比':
    all_ges.append('建')
    print("建禄格：最好天干有财官。如果官杀不成格，有兄弟，且任性。有争财和理财的双重性格。如果创业独自搞比较好，如果合伙有完善的财务制度也可以。")
    if gan_shens[0] in '比劫':
        print("\t建禄年透比劫凶")
    elif '财' in gan_shens and '官' in gan_shens:
        print("\t建禄财官双透，吉")
    if me in ('甲','乙'):
        print("\t甲乙建禄四柱劫财多，无祖财，克妻，一生不聚财，做事虚诈，为人大模大样，不踏实。乙财官多可为吉。甲壬申时佳；乙辛巳时佳；")

    if me in ('丙'):
        print("\t丙：己亥时辰佳；")        
    if me in ('丁'):
        print("\t丁：阴男克1妻，阳男克3妻。财官多可为吉。庚子时辰佳；")
    if me in ('戊'):
        print("\t戊：四柱无财克妻，无祖业，后代多事端。如合申子辰，子息晚，有2子。甲寅时辰佳；")       
    if me in ('己'):
        print("\t己：即使官财出干成格，妻也晚。偏财、杀印成格为佳。乙丑时辰佳；")    
    if me in ('庚'):
        print("\t庚：上半月生难有祖财，下半月较好，财格比官杀要好。丙戌时辰佳；")   
    if me in ('辛'):
        print("\t辛：干透劫财，妻迟财少；丁酉时辰佳；")      
    if me in ('壬'):
        print("\t 壬：戊申时辰佳；")  
    if me in ('癸'):
        print("\t 癸：己亥时辰佳")      
                

        
# 甲分析 

if me == '甲':
    if zhis.count('辰') > 1 or zhis.count('戌') > 1:
        print("甲日：辰或戌多、性能急躁不能忍。")
    if zhis[2] == '子':
        print("甲子：调候要火。")
    if zhis[2] == '寅':
        print("甲寅：有主见之人，需要财官旺支。")        
    if zhis[2] == '辰':
        print("甲辰：印库、性柔和而有实权。")   
    if zhis[2] == '午':
        print("甲午：一生有财、调候要水。")        
    if zhis[2] == '戌':
        print("甲戌：自坐伤官，不易生财，为人仁善。")      
        
if me in ('庚', '辛') and zhis[1] == '子' and zhis.count('子') >1:
    print("冬金子月，再有一子字，孤克。 母法P28-106 甲戌 丙子 庚子 丁丑")  
    

# 比肩分析
if '比' in gan_shens:
    print("比：同性相斥。讨厌自己。老是想之前有没有搞错。没有持久性，最多跟你三五年。 散财，月上比肩，做事没有定性，不看重钱，感情不持久。不怀疑人家，人心很好。善意好心惹麻烦。年上问题不大。")
    
    if gan_shens[0] == '比' and gan_shens[1] == '比':
        print("比肩年月天干并现：不是老大，出身平常。女仪容端庄，有自己的思想；不重视钱财,话多不能守秘。30随以前是非小人不断。")

    if gan_shens[1] == '比' and '比' in zhi_shen3[1]:
        print("月柱干支比肩：争夫感情丰富。30岁以前钱不够花。")
        
    if gan_shens[0] == '比':
        print("年干比：與同輩之間有較多的合作或競爭。")
        
    if zhi_shens[2] == '比':
        print("基52女坐比透比:夫妻互恨 丙辰 辛卯 辛酉 甲午。")  
                
        
    if gan_shens.count('比') > 1:
        print("""----基51:天干2比
        自我排斥，易后悔、举棋不定、匆促决定而有失；男倾向于群力，自己决策容易孤注一掷，小事谨慎，大事决定后不再重复考虑。
        女有自己的思想、容貌佳，注意细节，喜欢小孩重过丈夫。轻视老公。对丈夫多疑心，容易吃醋冲动。
        男不得女欢心.
        难以保守秘密，不适合多言；
        地支有根，一生小是非不断。没官杀制，无耐心。 END""")
    
                
    # 比肩过多
    if shens2.count('比') > 2 and '比' in zhi_shens:
        #print(shens2, zhi_shens2)
        print('''----比肩过多：
        女的爱子女超过丈夫；轻易否定丈夫。 换一种说法：有理想、自信、贪财、不惧内。男的双妻。
        兄弟之间缺乏帮助。夫妻有时不太和谐。好友知交相处不会很久。
        即使成好格局，也是劳累命，事必躬亲。除非有官杀制服。感情烦心。
        基53：善意多言，引无畏之争；难以保守秘密，不适合多言；易犯无事忙的自我表现；不好意思拒绝他人;累积情绪而突然放弃。
        比肩过多，女：你有帮夫运，多协助他的事业，多提意见，偶尔有争执，问题也不大。女：感情啰嗦
        对人警惕性低，乐天知命;情感过程多有波折
        ''') 
        
        if (not '官' in shens) and  (not '杀' in shens):
            print("基51: 比肩多，四柱无正官七杀，性情急躁。")            
            

        if '劫' in gan_shens:
            print("天干比劫并立，比肩地支专位，女命感情丰富，多遇争夫。基52")    
            
        if gan_shens[0] == '比':
            print("年干为比，不是长子，父母缘较薄，晚婚。")  
            
        if gan_shens[3] == '比':
            print("母法总则P21-6：时干为比，如日时地支冲，男的对妻子不利，女的为夫辛劳，九流艺术、宗教则关系不大。")              
            
        if gan_shens[1] == '比':
            if zhi_shens[1] == '食':
                print("月柱比坐食，易得贵人相助。")
            if zhi_shens[1] == '伤':
                print("月柱比坐伤，一生只有小财气，难富贵。")    
            if zhi_shens[1] == '比':
                print("月柱比坐比，单亲家庭，一婚不能到头。地支三合或三会比，天干2比也如此。")
            if zhi_shens[1] == '财':
                print("月柱比坐财，不利妻，也主父母身体不佳。因亲友、人情等招财物的无谓损失。")      
            if zhi_shens[1] == '杀':
                print("月柱比坐杀，稳重。")                   
        
        
    for seq, gan_ in enumerate(gan_shens):
        if gan_ != '比':
            continue
        if zhis[seq] in  empties[zhus[2]]:
            print("基51:比肩坐空亡，不利父亲与妻。年不利父，月不利父和妻，在时则没有关系。甲戌 丙寅 甲子 己巳\n\t基52女：夫妻缘分偏薄，在年只是不利父，在月30岁以前夫妻缘薄 E")
        if zhi_shens[seq] == '比':
            print("比坐比-平吉：与官杀对立，无主权。养子：克偏财，泄正印。吉：为朋友尽力；凶：受兄弟朋友拖累。父缘分薄，自我孤僻，男多迟婚")   
        if zhi_shens[seq] == '劫':
            print("女比肩坐劫:夫妻互恨，基52丁丑 壬子 壬戌 壬寅。\n\t还有刑冲且为羊刃，女恐有不测之灾：比如车祸、开刀和意外等。基52丙午 庚子 丙戌 丙申")     
            print("比坐劫-大凶：为忌亲友受损，合作事业中途解散，与妻子不合。如年月3见比，父缘薄或已死别。")   
            if ten_deities[gans[seq]][zhis[seq]] == '绝' and seq < 2:
                print("比肩坐绝，兄弟不多，或者很难谋面。戊己和壬癸的准确率偏低些。")   
        if zhi_shens[seq] == '财':
            print("比肩坐财：因亲人、人情等原因引起无谓损失。")  
        if zhi_shens[seq] == '杀':
            print("比肩坐杀:稳重。")    
        if zhi_shens[seq] == '枭':
            print("比肩坐偏印：三五年发达，后面守成。")    
        if zhi_shens[seq] == '劫' and Gan.index(me) % 2 == 0:
            print("比肩坐阳刃：父亲先亡，基于在哪柱判断时间。基51：丙午 丙申 丙申 丁酉。E在年不利父，在其他有刀伤、车祸、意外灾害。\t基52女命年克父亲，月若30岁以前结婚不利婚姻")    
        if zhi_shens[seq] in ('劫','比') and'劫' in gan_shens:
            print("天干比劫并立，比肩又坐比劫，女多遇争夫，个性强，不易协调。")   
        if  zhi_xing[seq]:
            print("比肩坐刑(注意不是半刑)，幼年艰苦，白手自立长。 甲申 己巳 甲寅 庚午 基51")
            if zhi_shens[seq] == '劫':
                print("比肩坐刑劫,兄弟不合、也可能与妻子分居。")      
        if zhi_6chong[seq]:
            print("比肩冲，手足不和，基于柱定时间 甲申 己巳 甲寅 庚午 基51。女命忌讳比劫和合官杀，多为任性引发困难之事。")                
                        
if zhi_shens[2] == '比':
    print("日支比：1-39对家务事有家长式领导；钱来得不容易且有时有小损财。e 自我，如有刑冲，不喜归家！")
if zhi_shens[3] == '比':
    print("时支比：子女为人公正倔强、行动力强，能得资产。")    
if zhi_shens[1] == '比':
    print("月柱比：三十岁以前难有成就。冒进、不稳定。女友不持久、大男子主义。")
if '比' in (gan_shens[3],zhi_shens[3]):
    print("时柱比：与亲人意见不合。")

if shens.count('比') + shens.count('劫') > 1:
    print("比劫大于2，男：感情阻碍、事业起伏不定。")
    

# 日坐禄   
if me_lu == zhis[2]:
    
    if zhis.count(me_lu) > 1:
        if yin_lu in zhis:
            if '比' in gan_shens or '劫' in gan_shens:
                
                print("双禄带比印（专旺）、孤克之命。比论孤，劫论凶。母法总则P20-3。比禄印劫不可合见四位")
                
    if zhi_6he[2] and '比' in gan_shens:
        if yin_lu in zhis:   
            print("透比，坐禄六合，有印专旺：官非、残疾。六合近似劫财，如地支会印，法死。 母法总则P20-4")
          
        print("透比，坐禄六合，如地支会印，法死。 母法总则P20-4")    
        

    if (zhi_xing[3] and gan_he[3] and gan_shens[3] == '财') or (zhi_xing[2] and gan_he[2] and zhi_xing[1] and gan_he[1] and gan_shens[1] == '财'):
          
        print("日禄与正财干合支刑：克妻子，即便是吉命，也无天伦之乐。 母法总则P22-21")    
        
if zhis.count(me_lu) > 2:
    print("禄有三，孤。 母法总则P23-36")
    
    
if zhis[3] == me_ku:
    if '财' in gan_shens or '才' in gan_shens:
        print("时支日库，透财：清高、艺术九流。 母法总则P59-5 己未 辛未 丁巳 庚戌 P61-8 丁未 壬寅 癸卯 丙辰")
        
    if piancai_lu == zhis[2]:
        print("时支日库，坐偏财：吉祥近贵，但亲属淡薄。 母法总则P59-6 辛未 辛卯 丁酉 庚戌")
    


    
# 时坐禄   
if me_lu == zhis[3]:
    if '伤' in gan_shens and '伤' in zhi_shens2:   
        print("时禄，伤官格，晚年吉。 母法总则P56-26 己未 丙寅 乙丑 己卯")
    if '杀' == gan_shens[3]:   
        print("杀坐时禄：为人反复不定。 母法总则P56-28 己未 丙寅 乙丑 己卯")
    
# 自坐劫库
if  zhis[2] == me_ku: 
    if gan_shens[3] == '杀' and '杀' in zhi_shen3[3]:
        print("自坐劫库,时杀格，贵！母法总则P30-143 辛未 辛卯 壬辰 戊申 母法总则P55-14 P60-22")  
        
    if gan_shens[3] == '官' and '官' in zhi_shen3[3]:
        print("自坐劫库,正官格，孤贵！母法总则P56-24 辛未 辛卯 壬辰 戊申 母法总则P55-14")   
            
    if zhi_ku(zhis[3], (cai,piancai)):
        print("自坐劫库,时财库，另有刃禄孤刑艺术，无者辛劳！母法总则P30-149 母法总则P56-17 56-18") 
        
    if gan_shens[3] == '财' and '财' in zhi_shen3[3]:
        print("自坐劫库，时正财格，双妻，丧妻。 母法总则P55-13 己酉 戊寅 壬辰 丁未 P61-6 乙酉 戊寅 壬辰 丁未")
        
    if (yin, me_lu) in zhus:
        print("自坐劫库,即便吉，也会猝亡 母法总则P61-9 丁丑 甲辰 壬辰 辛亥")


# 劫财分析
if '劫' in gan_shens:
    print("劫财扶助，无微不至。劫财多者谦虚之中带有傲气。凡事先理情，而后情理。先细节后全局。性刚强、精明干练、女命不适合干透支藏。")
    print("务实，不喜欢抽象性的空谈。不容易认错，比较倔。有理想，但是不够灵活。不怕闲言闲语干扰。不顾及别人面子。")
    print("合作事业有始无终。太重细节。做小领导还是可以的。有志向，自信。杀或食透干可解所有负面。女命忌讳比劫和合官杀，多为任性引发困难之事。")
    
    if gan_shens[0] == '劫' and gan_shens[1] == '劫':
        print("劫年月天干并现：喜怒形于色，30岁以前大失败一次。过度自信，精明反被精明误。")

    if gan_shens[1] == '劫':
        if  '劫' in zhi_shen3[1]:
            print("月柱干支劫：与父亲无缘，30岁以前任性，早婚防分手，自我精神压力极其重。")
        if  zhis[1] == cai_lu and zhis.count(yin_lu) > 1:
            print("月干劫：月支财禄，如地支2旺印，旺财不敌，官非、刑名意外。")            
          
        
    if shens2.count('劫') > 2:
        print('----劫财过多, 婚姻不好')
    if zhi_shens[2] == '劫':
        print("日坐劫财，透天干。在年父早亡，在月夫妻关系不好。比如财产互相防范；鄙视对方；自己决定，哪怕对方不同意；老夫少妻；身世有差距；斤斤计较；敢爱敢恨的后遗症\n\t以上多针对女。男的一般有双妻。天干有杀或食可解。基54丁未 己酉 丙午 己丑") 
            
if zhus[2] in (('壬','子'),('丙','午'), ('戊','午')):
    print("日主专位劫财，壬子和丙午，晚婚。不透天干，一般是眼光高、独立性强。对配偶不利，互相轻视；若刑冲，做事立场不明遭嫉妒，但不会有大灾。女性婚后通常还有自己的事业,能办事。") 
if ('劫','伤') in shen_zhus or ('伤','劫',) in shen_zhus:
        print("同一柱中，劫财、阳刃伤官都有，外表华美，富屋穷人，婚姻不稳定，富而不久；年柱不利家长，月柱不利婚姻，时柱不利子女。伤官的狂妄。基55丙申 丁酉 甲子 丁卯")      

if gan_shens[0] == '劫':
    print("年干劫财：家运不济。克父，如果坐劫财，通常少年失父；反之要看地支劫财根在哪一柱子。")
        
if '劫' in (gan_shens[1],zhi_shens[1]):
    print("月柱劫：容易孤注一掷，30岁以前难稳定。男早婚不利。")
if '劫' in (gan_shens[3],zhi_shens[3]):
    print("时柱劫：只要不是去经济大权还好。")   
if zhi_shens[2] == '劫':
    print("日支劫：男的克妻，一说是家庭有纠纷，对外尚无重大损失。如再透月或时天干，有严重内忧外患。")
    
if '劫' in shens2 and  '比' in zhi_shens and '印' in shens2 and not_yang():
    print("阴干比劫印齐全，单身，可入道！")
    
if zhi_shens[0] == '劫' and is_yang(): 
    print("年阳刃：得不到长辈福；不知足、施恩反怨。")
if zhi_shens[3] == '劫' and is_yang(): 
    print("时阳刃：与妻子不和，晚无结果，四柱再有比刃，有疾病与外灾。")
    
# 阳刃格        
if zhi_shens[1] == '劫' and is_yang():
    all_ges.append('刃')
    print("阳刃格：喜七杀或三四个官。基础90 甲戊庚逢冲多祸，壬丙逢冲还好。")  
    if me in ('庚', '壬','戊'):
        print("阳刃'庚', '壬','午'忌讳正财运。庚逢辛酉凶，丁酉吉，庚辰和丁酉六合不凶。壬逢壬子凶，戊子吉；壬午和戊子换禄不凶。")
    else:
        print("阳刃'甲', '丙',忌讳杀运，正财偏财财库运还好。甲：乙卯凶，辛卯吉；甲申与丁卯暗合吉。丙：丙午凶，壬午吉。丙子和壬午换禄不凶。")
        
    if zhis.count(yin_lu) > 0 and gan_shens[1] == '劫': # 母法总则P20-1
        print("阳刃格月干为劫：如果印禄位有2个，过旺，凶灾。不透劫财，有一印禄,食伤泄，仍然可以吉。 母法总则P20-1")
        
    if gan_shens[3] == '枭' and '枭' in zhi_shen3[3]:
        
        print("阳刃格:时柱成偏印格，贫、夭、带疾。 母法总则P28-107 癸未 辛酉 庚寅 戊寅")
                
        
if zhi_shens.count('劫') > 1 and Gan.index(me) % 2 == 0:
    if zhis.day == yin_lu:
        print("双阳刃，自坐印专位：刑妻、妨子。凶终、官非、意外灾害。母法总则P21-13")
        
if zhi_shens[1:].count('劫') > 0 and Gan.index(me) % 2 == 0:
    if zhis.day == yin_lu and ('劫' in gan_shens or '比' in gan_shens):
        print("阳刃，自坐印专位，透比或劫：刑妻。母法总则P36-8 己酉 丁卯 甲子 乙亥")
        
if zhis[2] in (me_lu,me_di) and zhis[3] in (me_lu,me_di):
    print("日时禄刃全，如没有官杀制，刑伤父母，妨碍妻子。母法总则P30-151 丁酉 癸卯 壬子 辛亥 母法总则P31-153 ")
    
#print(gan_shens)
for seq, gan_ in enumerate(gan_shens):
    if gan_ != '劫':
        continue    
    if zhis[seq] in (cai_lu, piancai_lu):
        print("劫财坐财禄，如逢冲，大凶。先冲后合和稍缓解！母法总则P21-7 书上实例不准！")
        
        if zhi_shens[seq] == '财' and zhi_6he[seq]:
            print("劫财坐六合财支：久疾暗病！母法总则P28-113 乙未 丙戌 辛亥 庚寅！")

if gan_shens[1] == '劫' and zhis[1] in (cai_lu, piancai_lu)  and zhis.count(yin_lu) > 1 and '劫' in gan_shens:
    print("月干劫坐财禄，有2印禄，劫透，财旺也败：官非、刑名、意外灾害！  母法总则P20-2")
    
# 自坐阳刃
if '劫' in zhi_shen3[2] and is_yang() and zhis[2] in zhengs:  
    if zhis[3] in (cai_lu, piancai_lu):
        print("坐阳刃,时支财禄，吉祥但是妻子性格不受管制！母法总则P30-137 丁未 庚戌 壬子 乙巳")
    if zhi_ku(zhis[3], (cai, piancai)):
        print("坐阳刃,时支财库，名利时进时退！母法总则P30-148 丙寅 壬寅 壬子 庚戌")
            
    if gan_shens[3] == '杀' and '杀' in zhi_shen3[3]:
        print("坐阳刃,时杀格，贵人提携而富贵！母法总则P30-143 甲戌 丙寅 壬子 戊申")
    
 
# 偏印分析    
if '枭' in gan_shens:
    print("----偏印在天干如成格：偏印在前，偏财(财次之)在后，有天月德就是佳命(偏印格在日时，不在月透天干也麻烦)。忌讳倒食，但是坐绝没有这能力。")
    print("经典认为：偏印不能扶身，要身旺；偏印见官杀未必是福；喜伤官，喜财；忌日主无根；   女顾兄弟姐妹；男六亲似冰")
    print("偏印格干支有冲、合、刑，地支是偏印的绝位也不佳。")
    
    #print(zhi_shen3)  
    if (gan_shens[1] == '枭' and '枭' in zhi_shen3[1]):        
        print("枭月重叠：福薄慧多，青年孤独，有文艺宗教倾向。")
        
    if zhi_shens2.count('枭') > 1:
        print("偏印根透2柱，孤独有色情之患难。做事有始无终，女声誉不佳！pd40")

    if  zhi_shens2.count('枭'):
        print("偏印成格基础89生财、配印；最喜偏财同时成格，偏印在前，偏财在后。最忌讳日时坐实比劫刃。")
        all_ges.append('枭')
              
    if shens2.count('枭') > 2:
        print("偏印过多，性格孤僻，表达太含蓄，要别人猜，说话有时带刺。偏悲观。有偏财和天月德贵人可以改善。有艺术天赋。做事大多有始无终。如四柱全阴，女性声誉不佳。")
        print("对兄弟姐妹不错。男的因才干受子女尊敬。女的偏印多，子女不多。第1克伤食，第2艺术性。")
        if '伤' in gan_shens: 
            print("女命偏印多，又与伤官同透，夫离子散。有偏财和天月德贵人可以改善。")
        
    if gan_shens.count('枭') > 1:
        print("天干两个偏印：迟婚，独身等，婚姻不好。三偏印，家族人口少，亲属不多建。基56甲午 甲戌 丙午 丙申")
        
    if shen_zhus[0] == ('枭', '枭'):
        print("偏印在年，干支俱透，不利于长辈。偏母当令，正母无权，可能是领养，庶出、同父异母等。 基56乙卯 甲申 丁丑 丁未")

    if zhi_shen3[1] == ['枭']:
        print("月专位偏印：有手艺。坐衰其貌不扬。")
        
    
for seq, zhi_ in enumerate(zhi_shens):
    if zhi_ != '枭' and gan_shens[seq] != '枭':
        continue   

    if ten_deities[gans[seq]][zhis[seq]] == '绝':
        print("偏印坐绝，或者天干坐偏印为绝，难以得志。费力不讨好。基56辛酉 辛卯 丁巳 甲辰  丁卯 丁未 己丑 丁卯")    

    if  gan_shens[seq] == '枭':
        if '枭' in zhi_shen3[seq] :
            print("干支都与偏印，克夫福薄！")  

        if '比' in zhi_shen3[seq] :
            print("偏印坐比：劳心劳力，常遇阴折 pd41")   

        if zhi_shens[seq] == '伤':
            print("偏印坐伤官：克夫丧子 pd41")        

    
if zhi_shens[3]  == '枭' and gan_shens[0]  == '枭':
    print("偏印透年干-时支，一直受家里影响。")
    
if '枭' in (gan_shens[0],zhi_shens[0]):
    print("偏印在年：少有富贵家庭；有宗教素养，不喜享乐，第六感强。")
if '枭' in (gan_shens[1],zhi_shens[1]):
    print("偏印在月：有慧少福，能舍己为人。")
    if zhi_shens[1]  == '枭' and zhis[1] in "子午卯酉":
        print("偏印专位在月支：比较适合音乐，艺术，宗教等。子午卯酉。22-30之间职业定型。基56：壬午 癸卯 丁丑 丁未")
        if gan_shens[1] == '枭':
            print("干支偏印月柱，专位入格，有慧福浅，不争名利。基57:戊子 辛酉 癸未 丁巳")    
if '枭' in (gan_shens[3],zhi_shens[3]):
    print("偏印在时：女与后代分居；男50以前奠定基础，晚年享清福。")     
if zhi_shens[2] == '枭' or zhis.day == xiao_lu:
    print("偏印在日支：家庭生活沉闷")
    if zhi_6chong[2] or zhi_xing[2]:
        print("偏印在日支(专位？),有冲刑：孤独。基57：甲午 癸酉 丁卯 丁未 母法总则P55-5： 辛丑 辛卯 癸酉 戊午 P77-13")
    if zhus[2] in (('丁','卯'),('癸','酉')):
        print("日专坐偏印：丁卯和癸酉。婚姻不顺。又刑冲，因性格而起争端而意外伤害。 基56")   
    if zhis[3] == me_jue:
        print("日坐偏印，日支绝：无亲人依靠，贫乏。 母法总则P55-5：丙辰 丙申 丁卯 壬子。pd41 专位偏印：男女姻缘都不佳。")  
    
    if '枭' in gan_shens and is_yang() and zhis.time == me_di:
        
        print("日坐偏印成格，时支阳刃：不利妻子，自身有疾病。 母法总则P55-6：甲子 甲戌 丙寅 甲午")  
    if gan_shens[3] == zhi_shens[3] == '劫':
        print("日坐偏印，时干支劫：因自己性格而引灾。 母法总则P57-34：甲子 甲戌 丙寅 甲午")
        
    if zhis.count(me_di) > 1 and is_yang():
        print("日坐偏印，地支双阳刃：性格有极端倾向。 母法总则P57-35：甲申 庚午 丙寅 甲午")

        
if zhis.time == xiao_lu:
    if zhi_shens[3] == '枭' and '枭' in gan_shens:
        if '财' in shens2 or '才' in shens2:
            print("时支偏印成格有财：因机智引凶。 母法总则P60-18：甲申 乙亥 丁亥 癸卯")        
        else:
            print("时支偏印成格无财：顽固引凶。 母法总则P60-17：甲子 乙亥 丁亥 癸卯")
        

# 印分析    
if '印' in gan_shens:
    if '印' in zhi_shens2:
        print("基础82，成格喜官杀、身弱、忌财克印。合印留财，见利忘义.透财官杀通关或印生比劫；合冲印若无他格或调候破格。日主强凶，禄刃一支可以食伤泄。")
        all_ges.append('印')
        
    if (gan_shens[1] == '印' and '印' in zhi_shen3[1]):        
        print("印月重叠：女迟婚，月阳刃者离寡，能独立谋生，有修养的才女。")

    if gan_shens[0] == '印' :        
        print("若年干印为喜且未受刑克：出身于富贵之家。")
            
    if shens2.count('印') > 2:
        print("正印多的：聪明有谋略，比较含蓄，不害人，识时务。正印不怕日主死绝，反而怕太强。日主强，正印多，孤寂，不善理财。 pd41男的克妻，子嗣少。女的克母。")
    for seq, gan_ in enumerate(gan_shens):
        if gan_ != '印':
            continue   
        if ten_deities[gans[seq]][zhis[seq]] in ('绝', '死'):
            if seq <3:
                print("正印坐死绝，或天干正印地支有冲刑，不利母亲。时柱不算。")   
        if zhi_shens[seq] == '财':
            print("男正印坐正财，夫妻不好。月柱正印坐正财专位，必离婚。在时柱，50多岁才有正常婚姻。(男) 基59 乙酉 己卯 庚子 丁亥  庚申 庚辰 庚午 己卯")   
        if zhi_shens[seq] == '印':
            print("正印坐正印，专位，过于自信。基59：戊辰 乙卯 丙申 丙申。务实，拿得起放得下。女的话大多晚婚。母长寿；女子息迟，头胎恐流产。女四柱没有官杀，没有良缘。男的搞艺术比较好，经商则孤僻，不聚财。")          

        if zhi_shens[seq] == '枭' and len(zhi5[zhis[seq]]) == 1:
            print("正印坐偏印专位：基59壬寅 壬子 乙酉 甲申。有多种职业;家庭不吉：亲人有疾或者特别嗜好。子息迟;财务双关。明一套，暗一套。女的双重性格。")   
            
        if zhi_shens[seq] == '伤':
            print("正印坐伤官：适合清高的职业。不适合追逐名利，女的婚姻不好。基59辛未 丁酉 戊子 丙辰")    
            
        if zhi_shens[seq] == '劫' and me in ('甲','庚','壬'):
            print("正印坐阳刃，身心多伤，心疲力竭，偶有因公殉职。主要指月柱。工作看得比较重要。")    
                        
            
    if '杀' in gan_shens and '劫' in zhi_shens and me in ('甲','庚','壬'):
        print("正印、七杀、阳刃全：基60癸巳 庚申 甲寅 丁卯：女命宗教人，否则独身，清高，身体恐有隐疾，性格狭隘缺耐心。男小疾多，纸上谈兵，婚姻不佳，恐非婚生子女，心思细腻对人要求也高。")    
            
    if '官' in gan_shens or '杀' in gan_shens: 
        print("身弱官杀和印都透天干，格局佳。")
    else:
        print("单独正印主秀气、艺术、文才。性格保守")  
    if '官' in gan_shens or '杀' in gan_shens or '比' in gan_shens: 
        print("正印多者，有比肩在天干，不怕财。有官杀在天干也不怕。财不强也没关系。")  
    else:
        print("正印怕财。") 
    if '财' in gan_shens:     
        print("印和财都透天干，都有根，最好先财后印，一生吉祥。先印后财，能力不错，但多为他人奔波。(男)") 
       
       
if zhi_shens[1]  == '印':
    print("月支印：女命觉得丈夫不如自己，分居是常态，自己有能力。")  
    if gan_shens[1]  == '印':
        print("月干支印：男权重于名，女命很自信，与夫平权。pd41:聪明有权谋，自我")    
        if '比' in gan_shens:
            print("月干支印格，透比，有冲亡。")
            
if zhi_shens[2]  == '印':
    if gan_shens[3] == '才' and '才' in zhi_shen3[3]:
        print("坐印，时偏财格：他乡发迹，改弦易宗，妻贤子孝。 母法总则：P55-1 丁丑 丁未 甲子 戊辰") 
        
    if gan_shens[3] == '财' and ('财' in zhi_shen3[3] or zhis[3] in (cai_di, cai_lu)):
        print("坐印，时财正格：晚年发达，妻贤子不孝。 母法总则：P55-2 乙酉 丙申 甲子 己巳") 

            
if zhi_shens[3]  == '印' and zhis[3] in zhengs:
    print("时支专位正印。男忙碌到老。女的子女各居一方。亲情淡薄。")  
    
if gan_shens[3]  == '印' and '印' in zhi_shen3[3]:
    print("时柱正印格，不论男女，老年辛苦。女的到死都要控制家产。子女无缘。")   
    
if gan_shens.count('印') + gan_shens.count('枭') > 1:
    print("印枭在年干月干，性格迂腐，故作清高，女子息迟，婚姻有阻碍。印枭在时干，不利母子，性格不和谐。")  
    

if zhis[1] in (yin_lu, xiao_lu) :
    print("印或枭在月支，有压制丈夫的心态。")  
    
if zhis[3] in (yin_lu, xiao_lu) :
    print("印或枭在时支，夫灾子寡。")  
 
# 坐印库   
if zhi_ku(zhis[2], (yin, xiao)):
    if shens2.count('印') >2:
        print("母法总则P21-5: 日坐印库，又成印格，意外伤残，凶终。过旺。")
    if zhi_shens[3] == '劫':
        print("自坐印库，时阳刃。带比禄印者贫，不带吉。 母法总则P21-14")  

if zhis.count("印") > 1:
    if gan_shens[1] == "印" and zhi_shens[1] == "印" and '比' in gan_shens:
        print("月干支印，印旺，透比，旺而不久，冲亡。母法总则P21-8") 
        
if zhis[1] == yin_lu:
    if ('财' in gan_shens and '财' in zhi_shens) or ('才' in gan_shens and '才' in zhi_shens):
        print("母法总则P22-18 自坐正印专旺，成财格，移他乡易宗，妻贤子孝。") 
        
        
# 偏财分析    
if '才' in gan_shens:
    print("偏财明现天干，不论是否有根:财富外人可见;实际财力不及外观一半。没钱别人都不相信;协助他人常超过自己的能力")
    print("偏财出天干，如与天月德贵人同一天干者，在年月有声明远扬的父亲，月时有聪慧的红颜知己。喜奉承。")
    print("偏财透天干，四柱没有刑冲，长寿。女子为孝顺女，主要针对年月。时柱表示中年以后有自己的事业，善于理财。")
    if '才' in zhi_shens2:
        print("财格基础80:比劫用食伤通关或官杀制；身弱有比劫仍然用食伤通关。如果时柱坐实比劫，晚年破产。")  
        all_ges.append('才')
    print("偏财透天干，讲究原则，不拘小节。喜奉承，善于享受。财格基础80")
    
    if '比' in gan_shens or '劫' in gan_shens and gan_shens[3] == '才':
        print("年月比劫，时干透出偏财。祖业凋零，再白手起家。有刑冲为千金散尽还复来")
    if '杀' in gan_shens and '杀' in zhi_shens:
        print("偏财和七杀并位，地支又有根，父子外合心不合。因为偏财生杀攻身。偏财七杀在日时，则为有难伺候的女朋友。 基62壬午 甲辰 戊寅 癸亥")
        
    if zhi_shens[0]  == '才':
        print("偏财根透年柱，家世良好，且能承受祖业。")
        
    for seq, gan_ in enumerate(gan_shens):
        if gan_ != '才':
            pass
        if '劫' in zhi_shen3[seq] and zhis[seq] in zhengs:
            print("偏财坐阳刃劫财,可做父缘薄，也可幼年家贫。也可以父先亡，要参考第一大运。偏财坐专位阳刃劫财,父亲去他乡.基61壬午 壬寅 戊子 丁巳")   
        if get_empty(zhus[2],zhis[seq]) == '空':
            print("偏财坐空亡，财官难求。")                    
                
if shens2.count('才') > 2:
    print("偏财多的人慷慨，得失看淡。花钱一般不会后悔。偏乐观，甚至是浮夸。生活习惯颠倒。适应能力强。有团队精神。得女性欢心。小事很少失信。")
    print("乐善好施，有团队精神，女命偏财，听父亲的话。时柱偏财女，善于理财，中年以后有事业。")
if (zhi_shens[2]  == '才' and len(zhi5[zhis[2]]) == 1) or (zhi_shens[3]  == '才' and len(zhi5[zhis[3]]) == 1):
    print("日时地支坐专位偏财。不见刑冲，时干不是比劫，大运也没有比劫刑冲，晚年发达。")
    
    
    
# 财分析    

if (gan_shens[0] in ('财', '才')  and gan_shens[1]  in ('财', '才')) or (gan_shens[1] in ('财', '才') and ('财' in zhi_shen3[1] or '才' in zhi_shen3[1])):
    print("财或偏财月重叠：女职业妇女，有理财办事能力。因自己理财能力而影响婚姻。一财得所，红颜失配。男的双妻。")
    

if '财' in gan_shens:
    if '财' in zhi_shens2:
        all_ges.append('财')
        
    if is_yang():        
        print("男日主合财星，夫妻恩爱。如果争合或天干有劫财，双妻。")
    if '财' in zhi_shens:
        print("财格基础80:比劫用食伤通关或官杀制；身弱有比劫仍然用食伤通关。")
        
    if '官' in gan_shens:
        print("正官正财并行透出，(身强)出身书香门第。")
    if '官' in gan_shens or '杀' in gan_shens:
        print("官或杀与财并行透出，女压夫，财生官杀，老公压力大。")
    if gan_shens[0] == '财':
        print("年干正财若为喜，富裕家庭，但不利母亲。")
    if '财' in zhi_shens:
        if '官' in gan_shens or '杀' in gan_shens:
            print("男财旺透官杀，女厌夫。")
    if gan_shens.count('财') > 1:
        print("天干两正财，财源多，大多做好几种生意，好赶潮流，人云亦云。有时会做自己外行的生意。")
        if '财' not in zhi_shens2:
            print("正财多而无根虚而不踏实。重财不富。")
            
for seq, gan_ in enumerate(gan_shens):
    if gan_ != '财' and zhis[seq] != '财':
        continue   
    if zhis[seq] in day_shens['驿马'][zhis.day] and seq != 2:
        print("女柱有财+驿马，动力持家。")
    if zhis[seq] in day_shens['桃花'][zhis.day] and seq != 2:
        print("女柱有财+桃花，不吉利。")        
    if zhis[seq] in empties[zhus[2]]:
        print("财坐空亡，不持久。")    
    if ten_deities[gans[seq]][zhis[seq]] in ('绝', '墓'):
        print("男财坐绝或墓，不利婚姻。")
            
if shens2.count('财') > 2:
    print("正财多者，为人端正，有信用，简朴稳重。")
    if '财' in zhi_shens2 and (me not in zhi_shens2):
        print("正财多而有根，日主不在生旺库，身弱惧内。")   
        
if zhi_shens[1] == '财' and options.n:
    print("女命月支正财，有务实的婚姻观。")
    
if zhi_shens[1] == '财':
    print("月令正财，无冲刑，有贤内助，但是母亲与妻子不和。生活简朴，多为理财人士。")
if zhi_shens[3] == '财' and len(zhi5[zhis[3]]) == 1:
    print("时支正财，一般两个儿子。")
if zhus[2] in (('戊','子'),) or zhus[3] in (('戊','子'),):
    print("日支专位正财，得勤俭老婆。日时专位支正财，又透正官，中年以后发达，独立富贵。") 
    
if zhus[2] in (('壬','午'),('癸','巳'),):
    print("坐财官印，只要四柱没有刑冲，大吉！") 
    
if zhus[2] in (('甲','戌'),('乙','亥'),):
    print("女('甲','戌'),('乙','亥'） 晚婚 -- 不准！") 
    
if '财' == gan_shens[3] or  '财' == zhi_shens[3]:
    
    print("未必准确：时柱有正财，口快心直，不喜拖泥带水，刑冲则浮躁。阳刃也不佳.反之有美妻佳子") 
if (not '财' in shens2) and (not '才' in shens2):
    print("四柱无财，即便逢财运，也是虚名虚利. 男的晚婚")
    

#print("shang", shang, ten_deities[shang].inverse['建'], zhi_shens)
#if ten_deities[shang].inverse['建'] in zhis:
    #print("女命一财得所，红颜失配。")  
    
if zhis.day in (cai_lu, cai_di):
    if (zhi_shens[1] == '劫' or zhi_shens[3] == '劫' ) and Gan.index(me) % 2 == 0:
        print("自坐财禄，月支或时支为阳刃，凶。无冲是非多，冲刑主病灾。 母法总则P22-15  母法总则P36-4 丙寅 戊戌 甲午 丁卯 P56-32 己未 丙寅 丙申 甲午")   
    if ('劫' in zhi_shens ) and Gan.index(me) % 2 == 0 and '劫' in gan_shens :
        print("自坐财禄，透劫财，有阳刃，刑妻无结局。 母法总则P36-7 戊子 乙卯 甲午 乙亥") 
    if me in ('甲', '乙') and ('戊' in gans or '己' in gans):
        print("火土代用财，如果透财，多成多败，早年灰心。 母法总则P22-19 辛未 癸巳 甲午 戊辰") 
        
    if gan_shens[3] == '枭':
        print("财禄时干偏印：主亲属孤独 母法总则P31-158 丁丑 丙午 甲辰 己巳")
        if '枭' in zhi_shen3[3]:
            print("财禄时干偏印格：财虽吉、人丁孤单、性格艺术化 母法总则P56-20 己巳 丙辰 甲午 壬申")
            
    if zhis[3] == yin_lu:
        print("坐财禄，时支印禄：先难后易 母法总则P30-147 甲申 己巳 壬午 己酉 母法总则P55-16")
                  
     
if (gan_he[3] and gan_shens[3] == '财' and jin_jiao(zhis[2], zhis[3]) ) or (gan_he[2] and gan_he[1] and gan_shens[1] == '财' and jin_jiao(zhis[1], zhis[2])):
      
    print("日主合财且进角合：一生吉祥、平安有裕！ 母法总则P22-22 丁丑 丙午 甲辰 己巳")    
    
    
if zhis.day == cai_lu or zhi_shens[2] == '财':
    if gan_shens[3] == '枭' and ('枭' in zhi_shen3[3] or zhis[3] == xiao_lu ):
        print("日坐财，时偏印格：他乡有成，为人敦厚。母法总则P55-4 甲寅 辛未 甲午 壬申")
    if zhi_6chong[2] or zhi_xing[2]:
        print("日坐财，有冲或刑：财吉而有疾。母法总则P55-10 丙寅 戊戌 甲午 甲子")    

        
if gan_shens[3] == '财' and zhi_ku(zhis[3], (me,jie)):
    print("正财坐日库于时柱:孤独、难为父母，但事业有成。 母法总则P31-156 丁丑 丙午 甲辰 己巳")

# 自坐财库    
if zhis[2] == cai_ku: 
    if zhis[3] == me_ku :
        print("自坐财库,时劫库：有财而孤单。 母法总则P30-136 丁丑 丙午 甲辰 己巳 母法总则P55-11 P61-5 甲子 己巳 壬戌 甲辰")
        
    if zhis[2] == zhis[3]:
        print("自坐财库,时坐财库：妻有灾，妻反被妾制服。 母法总则P30-150 辛酉 乙未 壬戌 庚戌 母法总则P56-19")
    
        
    if gan_shens[3] == '杀' and '杀' in zhi_shen3[3]:
        print("自坐财库,时杀格，财生杀，凶！母法总则P30-147 甲寅 己巳 壬戌 戊申 有可能是时柱有杀就算。 母法总则P55-15")    
    
# 时坐财库    
if zhi_ku(zhis[3], (cai,piancai)): 
    if '伤' in gan_shens and '伤' in zhi_shens:
        print("时坐财库,伤官生财:财好，体弱，旺处寿倾倒！母法总则P59-8 戊申 辛酉 戊子 丙辰")

if gan_shens[3] == '财' and '财' in zhi_shen3[3]:
    print("时上正财格:不必财旺，因妻致富。 母法总则P30-140 丙午 戊戌 壬寅 丁未 母法总则P60-21") 
    
    if zhis[3] == me_ku:
        print("时上正财格坐比劫库，克妻。 母法总则P30-141 丙午 戊戌 壬寅 丁未")
    if zhis[2] == cai_ku:
        print("时上正财格自坐财库，妻佳，中年丧妻，续弦也佳。 母法总则P30-142 庚子 辛巳 壬戌 丁未 P61-7")

#print(cai_di, cai_lu, zhis, gan_he)        
if zhis[3] in (cai_di, cai_lu):
    if gan_he[3]:
        print("时财禄，天干日时双合，损妻家财。 母法总则P31-157 庚戌 戊寅 癸酉 戊午")
    if '伤' == gan_shens[3] and '伤' in zhi_shens2:
        print("时支正财时干伤成格：虽富有也刑克。 母法总则P59-1 丁丑 壬寅 丁巳 戊申")
    #print(zhi_ku(zhis[1], (shi,shang)) , (shi,shang), zhis[3] == cai_lu)
    if zhi_ku(zhis[1], (shi,shang)) and zhis[3] == cai_lu:
        print("时支正财禄，月支伤入墓：生财极为辛勤。 母法总则P59-4 甲子 戊辰 庚戌 己卯")
        
# print(cai_di, cai_lu, zhis, gan_he)        
if zhis[3] == cai_lu:
    if zhi_xing[3] or zhi_6chong[3]:
        print("时支正财禄有冲刑：得女伴且文学清贵。 母法总则P60-11 丁丑 辛亥 己巳 乙亥")
    if any(zhi_xing[:3]) or any(zhi_6chong[:3]):
        print("时支正财禄,它支有冲刑：刑妻、孤高、艺术、近贵人。 母法00总则P60-19 乙未 己丑 庚寅 己卯")
    if gan_shens.count('财') >1 :
        print("时支正财禄,天干财星多：孤雅、九流、表面风光。 母法总则P60-20 乙酉 乙酉 庚辰 己卯")
    

# 官分析    
if '官' in gan_shens:
    if '官' in zhi_shens2:
        print("官若成格：忌伤；忌混杂；基础78。有伤用财通关或印制。混杂用合或者身官两停。日主弱则不可扶。")
        all_ges.append('官')
        
        if '比' in gan_shens or '劫' in gan_shens:
            print("官格透比或劫：故做清高或有洁癖的文人。")

        if '伤' in gan_shens:
            print("官格透伤：表里不一。")    
            
        if '财' in gan_shens or '才' in gan_shens:
            print("官格透财：聚财。")     
            
        if '印' in gan_shens:
            print("官格透印：人品清雅。")   
            
        if not ('印' in gan_shens or '财' in gan_shens or '才' in gan_shens):
            print("官独透成格：敦厚人。")               

        
    if (gan_shens[0] == '官' and gan_shens[1] == '官') or (gan_shens[1] == '官' and '官' in zhi_shen3[1]):
        print("官月重叠：女易离婚，早婚不吉利。为人性格温和。")
            
    if gan_shens[3] == '官' and len(zhi5[zhis[3]]) == 1:
        print("官专位时坐地支，男有得力子息。")
    if gan_shens[0] == '官' :
        print("年干为官，身强有可能出身书香门第。")
        if gan_shens[3] == '官':
            print("男命年干，时干都为官，对后代和头胎不利。")
    if (not '财' in gan_shens) and (not '印' in gan_shens):
        print("官独透天干成格，四柱无财或印，为老实人。")
    if '伤' in gan_shens:
        print("正官伤官通根透，又无其他格局，失策。尤其是女命，异地分居居多，婚姻不美满。基64:辛未 丁酉 甲戌 辛未 ")
    if '杀' in gan_shens:
        print("年月干杀和偏官，30以前婚姻不稳定。月时多为体弱多病。")
        
    if '印' in gan_shens and '印' in zhi_shens2 and '官' in zhi_shens2:
        print("官印同根透，无刑冲合，吉。")
        if '财' in gan_shens and '财' in zhi_shens2:
            print("财官印同根透，无刑冲合，吉。")
        
    if gan_shens[1] == '官' in ten_deities[me][zhis[1]] in ('绝', '墓'):
        print("官在月坐墓绝，不是特殊婚姻就是迟婚。如果与天月德同柱，依然不错。丈夫在库中：1，老夫少妻；2，不为外人所知的亲密感情；3，特殊又合法的婚姻。")
    if zhi_shens[1] == '官' and gan_shens[1] == '官':
        print("月柱正官坐正官，婚变。月柱不宜通。坐禄的。")  

    
    for seq, gan_ in enumerate(gan_shens):
        if gan_ != '官':
            continue   
        if zhi_shens[seq] in ('劫','比') :
            print("天干正官，地支比肩或劫财，亲友之间不适合合作，但是他适合经营烂摊子。")
        if zhi_shens[seq] == '杀' :
            print("正官坐七杀，男命恐有诉讼之灾。女命婚姻不佳。月柱尤其麻烦，二度有感情纠纷。年不算，时从轻。 基64 壬子 壬子 丁丑 癸卯")
        if zhi_shens[seq] == '劫' and Gan.index(me) % 2 == 0:
            print("官坐羊刃：要杀才能制服阳刃，有力不从心之事情。 辛卯 丁酉 庚午 庚辰 基65")   
        if zhi_shens[seq] == '印':
            print("官坐印，无刑冲合，吉")   
        
            
if shens2.count('官') > 2 and '官' in gan_shens and '官' in zhi_shens2:
    print("正官多者，虚名。为人性格温和，比较实在。做七杀看")
if zhis.day == guan_lu or zhi_shens[2] == '官':
    print("日坐正官专位，淑女。 基65 庚申 癸未 丙子 乙未")
    if is_yang() and zhis.time == me_di:
        print("日坐正官，时支阳刃：先富后败，再东山再起。 子平母法 P55-7")
    
if gan_shens.count('官') > 2 :
    print("天干2官，女下有弟妹要照顾，一生为情所困。")   
    

if zhi_shens[1] == '官' and '伤' in zhi_shens2:
    print("月支正官，又成伤官格，难做真正夫妻。有实，无名。 基66辛丑 辛卯 戊子 辛酉")
    
    
# 杀分析    
if '杀' in gan_shens:
    print("七杀是非多。但是对男人有时是贵格。成格基础85可杀生印或食制印、身杀两停、阳刃驾杀。")
    if '杀' in zhi_shens2:
        print("杀格：喜食神制，要食在前，杀在后。阳刃驾杀：杀在前，刃在后。身杀两停：比如甲寅日庚申月。杀印相生，忌食同成格。")
        all_ges.append('杀')
        
        if '比' in gan_shens or '劫' in gan_shens:
            print("杀格透比或劫：性急但还有分寸。")

        if '杀' in gan_shens:
            print("杀格透官：精明琐屑，不怕脏。")    
            
        if '食' in gan_shens or '伤' in gan_shens:
            print("杀格透食伤：外表宁静，内心刚毅。")     
            
        if '印' in gan_shens:
            print("杀格透印：圆润、精明干练。")   
        
    if (gan_shens[0] == '杀' and gan_shens[1] == '杀') :
        print("杀月干年干重叠：不是老大，出身平常，多灾，为人不稳重。")
        
    if (gan_shens[1] == '杀' and '杀' in zhi_shen3[1]):        
        print("杀月重叠：女易离婚，其他格一生多病。")
        
    if gan_shens[0] == '杀':
        print("年干七杀，早年不好。或家里穷或身体不好。")
        if gan_shens[1] == '杀':
            print("年月天干七杀，家庭复杂。")
    if '官' in gan_shens:
        print("官和杀同见天干不佳。女在年干月干，30以前婚姻不佳，或体弱多病。基65 甲寅 乙亥 戊子 丙辰")
    if gan_shens[1] == '杀' and zhi_shens[1] == '杀':
        print("月柱都是七杀，克得太过。有福不会享。六亲福薄。时柱没关系。")
        if '杀' not in zhi_shens2 :
            print("七杀年月浮现天干，性格好变，不容易定下来。30岁以前不行。")        
    if '杀' in zhi_shens and '劫' in zhi_shens:
        print("七杀地支有根时要有阳刃强为佳。杀身两停。")
    if gan_shens[1] == '杀' and gan_shens[3] == '杀':
        print("月时天干为七杀：体弱多病")    
    if gan_shens[0] == '杀' and gan_shens[3] == '杀':
        print("七杀年干时干：男头胎麻烦（概率），女婚姻有阻碍。")  
    if gan_shens[3] == '杀':
        print("七杀在时干，固执有毅力。基67")       
    if '印' in gan_shens:
        print("身弱杀生印，不少是精明练达的商人。")  
    if '财' in gan_shens or '才' in gan_shens:
        print("财生杀，如果不是身弱有印，不佳。")  
        for zhi_ in zhis: 
            if set((ten_deities[me].inverse['杀'], ten_deities[me].inverse['财'])) in set(zhi5[zhi_]):
                print("杀不喜与财同根透出，这样杀的力量太强。")  


for seq, gan_ in enumerate(gan_shens):
    if gan_ != '杀' and zhi_shens[seq] != '杀':
        continue   
    if gan_ == '杀' and '杀' in zhi_shen3[seq] and seq != 3:
        print("七杀坐七杀，六亲福薄。")
    if get_empty(zhus[2],zhis[seq]) == '空':
        print("七杀坐空亡，女命夫缘薄。 基68 壬申 庚戌 甲子 丙寅")
    if zhis[seq] == '食':
        print("七杀坐食：易有错误判断。")
    if zhi_xing[seq] or zhi_6chong[seq]:
        print("七杀坐刑或对冲，夫妻不和。")
        
            
if shens2.count('杀') > 2:
    print("杀多者如果无制，性格刚强。打抱不平，不易听人劝。女的喜欢佩服的人。")
if zhi_shens[2]  == '杀' and len(zhi5[zhis[2]]) == 1:
    print("天元坐杀：乙酉，己卯，如无食神，阳刃，性急，聪明，对人不信任。如果七杀还透出月干无制，体弱多病，甚至夭折。如果在时干，晚年不好。")
    
if zhus[2] in (('丁', '卯'), ('丁', '亥'), ('丁', '未')) and zhis.time == '子':
    print("七杀坐桃花，如有刑冲，引感情引祸。忌讳午运。")
    
if gan_shens.count('杀') > 2 :
    print("天干2杀，不是老大、性格浮躁不持久。")   

if ten_deities[shang].inverse['建'] in zhis and options.n:
    print("女地支有杀的禄：丈夫条件还可以。对外性格急，对丈夫还算顺从。")  
    
    
    
if zhis[2] == me_jue:
    print("#"*10, "自坐绝")
    if zhi_6he[2]:
        
        print("自己坐绝（天元坐杀）：日支与它支合化、双妻，子息迟。母法总则P21-9 P56-30 d第10点暂未编码。") 
        
    print("自己坐绝支，绝支合会，先贫后富。母法总则P57-3 母法总则P23-33")  
    if zhis[3] == zhis[2]:
        print("日主日时绝，旺达则有刑灾。母法总则P57-2 母法总则P24-43 戊午 癸亥 乙酉 乙酉")  
        
    if zhis[3] == zhis[2] == zhis[1]:
        print("日主月日时绝，旺达则有刑灾，平常人不要紧。母法总则P57-1")  
    if zhi_shens.count('比') + zhi_shens.count('劫') > 1 :
        print("自坐绝，地支比劫大于1，旺衰巨变，凶：母法总则P22-16。 母法总则P36-5月支或时支都为阳刃，凶。")
    
    if zhis[1] == me_jue:
        print("日主月日绝，有格也疾病夭。母法总则P23-35")  
        
    if zhis[3] == cai_lu:
        print(" 母法总则P59-2  自坐绝，月支财禄:身弱财旺有衰困时，克妻子。书上例子不对")   
        
    if zhis[3] == cai_di:
        print(" 母法总则P59-3  自坐绝，月支偏财禄:有困顿时娶背景不佳妻。书上例子不对")   



        
if zhis[3] == me_jue:
    print("#"*10, "自己时坐绝: 母法总则P57-4: 若成伤官格，难求功名，适合艺术九流。")
    if zhi_shens[2] == '枭':
        print("母法总则P57-5: 自时支坐绝，自坐枭: 不是生意人，清贫艺术九流人士。")
    #print(zhi_shens, cai_di, cai_lu)
    if zhis[1] in (cai_di, cai_lu):
        print(" 母法总则P57-6  自时支坐绝，月支坐财:先富，晚年大败，刑破。 癸未 庚申 丁巳 庚子")    

    if zhis[1] in (me_lu, me_di):
        print(" 母法总则P28-114  自时支坐绝，月支帝:刑妻克子。 甲子 癸酉 辛丑 辛卯 -- 阴干也算阳刃？")   
        
    if zhis[3] in (cai_di,cai_lu):
        print(" 母法总则P57-8  自时支坐绝，时支财:中年发后无作为。 甲子 癸酉 辛丑 辛卯")   
        

if zhis[2] == sha_lu:
    if zhi_ku(zhis[3], (guan, sha)):
        print("自坐杀禄，时支为官杀库，一生有疾，生计平常。 母法总则P21-12 母法总则P55-8 甲子 丙寅 乙酉 己丑 P56-31")    
        
if zhis[3] == sha_lu:
    if zhi_xing[3] or zhi_6chong[3]:
        
        print("时支杀禄带刑冲：纵然吉命也带疾不永寿。 母法总则P60-15 乙未 乙酉 戊申 甲寅")  

if gan_shens[3] == '杀' and zhis[3] in (cai_di, cai_lu):
    print("七杀时柱坐财禄旺：性格严肃。 母法总则P59-7 母法总则P79-3 双妻，子息迟。 ")  

#print(sha_lu, zhi_6chong,zhi_xing )    
if zhis[3] == sha_lu:
    if (zhi_6chong[3] or zhi_xing[3]):
        print("七杀时禄旺：遇刑冲寿夭带疾。 母法总则P28-118 冲别的柱也算？ 乙未 戊寅 辛丑 甲午 ") 
    if zhis[1] == sha_lu:
        print("七杀时月禄旺：体疾。 母法总则P28-119 甲寅 庚午 辛丑 甲午  母法总则P60-16")
 
#print(zhi_ku(zhis[2], (guan,sha)),set(zhis), set('辰戌丑未'))      
if zhi_ku(zhis[2], (guan,sha)):
    if set(zhis).issubset(set('辰戌丑未')):
        print("自坐七杀入墓：地支都为库，孤独艺术。 母法总则P57-33  丙辰 戊戌 乙丑 庚辰") 
        
if '杀' in gan_shens and zhi_shens.count('杀') > 1:
    print("七杀透干，地支双根，不论贫富，亲属离散。母法总则P79-6 乙未 丙戌 戊寅 甲寅") 
    
if  '杀' in jus + all_ges:

    if '比' in gan_shens or '劫' in gan_shens:
        print("杀格透比或劫：性急但还有分寸。")
    
    if '杀' in gan_shens:
        print("杀格透官：精明琐屑，不怕脏。")    
        
    if '食' in gan_shens or '伤' in gan_shens:
        print("杀格透食伤：外表宁静，内心刚毅。")     
        
    if '印' in gan_shens:
        print("杀格透印：圆润、精明干练。")   
     
# 食分析    
if '食' in gan_shens:
    if '食' in zhi_shens2:
        print("食神成格的情况下，寿命比较好。食神和偏财格比较长寿。食神厚道，为人不慷慨。食神有口福。成格基础84，喜财忌偏印(只能偏财制)。")
        print("食神无财一生衣食无忧，无大福。有印用比劫通关或财制。")
        all_ges.append('食')
        
        
    if (gan_shens[0] == '食' and gan_shens[1] == '食') or (gan_shens[1] == '食' and '食' in zhi_shen3[1]):
        print("食月重叠：生长安定环境，性格仁慈、无冲刑长寿。女早年得子。无冲刑偏印者是佳命。")


    if '枭' in gan_shens:
        print("男的食神碰到偏印，身体不好。怕偏印，正印要好一点。四柱透出偏财可解。")
        if '劫' in gan_shens:
            print("食神不宜与劫财、偏印齐出干。体弱多病。基69")
        if '杀' in gan_shens:
            print("食神不宜与杀、偏印齐成格。体弱多病。")
    if '食' in zhi_shens:
        print("食神天透地藏，女命阳日主适合社会性职业，阴日主适合上班族。")
    if (not '财' in gan_shens) and (not '才' in gan_shens):
        print("食神多，要食伤生财才好，无财难发。")
    if '伤' in gan_shens:
        print("食伤混杂：食神和伤官同透天干：志大才疏。")
    if '杀' in gan_shens:
        print("食神制杀，杀不是主格，施舍后后悔。")



    for seq, gan_ in enumerate(gan_shens):
        if gan_ != '食':
            continue   
        if zhi_shens[seq] =='劫':
            print("食神坐阳刃，辛劳。基69 戊申 戊午 丙子 丙申")
        
            
if shens2.count('食') > 2:
    print("食神四个及以上的为多，做伤官处理。食神多，要食伤生财才好，无财难发。")
    if '劫' in gan_shens or '比' in gan_shens:
        print("食神带比劫，好施舍，乐于做社会服务。")
        
if ('杀', '食') in shen_zhus or ( '食', '杀') in shen_zhus:
    print("食神与七杀同一柱，易怒。食神制杀，最好食在前。有一定概率。基69辛未 丁酉 乙未 戊寅")
    
if ('枭', '食') in shen_zhus or ( '食', '枭') in shen_zhus:
    print("女命最怕食神偏印同一柱。不利后代，时柱尤其重要。基69庚午 己卯 丁未 丁未")
    
if '食' in zhi_shen3[2] and zhis[2] in zhengs:
    print("日支食神专位容易发胖，有福。只有2日：癸卯，己酉。男命有有助之妻。")
if zhi_shens[2]  == '食' and zhi_shens[2]  == '杀':
    print("自坐食神，时支杀专，二者不出天干，多成败，最后失局。")  
    
if zhi_shens[2]  == '食':
    print("自坐食神，相敬相助，即使透枭也无事，不过心思不定，做事毅力不足，也可能假客气。专位容易发胖，有福。")
 
    
if zhis[2]  == shi_lu:
    if zhis[3]  == sha_lu and (sha not in gan_shens):
        print("自坐食，时支专杀不透干：多成败，终局失制。母法总则P56-22 丙子 庚寅 己酉 丁卯")

if '食' in zhi_shen3[3] and '枭' in zhi_shen3[3] + gan_shens[3]:
    print("时支食神逢偏印：体弱，慢性病，女的一婚不到头。")  
    
if zhis[2] in kus and zhi_shen3[2][2] in ('食', '伤'):
    print("自坐食伤库：总觉得钱不够。")
    
if  '食' in (gan_shens[0], zhi_shens[0]):
    print("年柱食：可三代同堂。")

if zhi_ku(zhis[3], (shi, shang)) and ('食' in zhi_shen3[1] or '伤' in zhi_shen3[1]):
    print("时食库，月食当令，孤克。")

# 自坐食伤库
if zhi_ku(zhis[2], (shi, shang)):  
    if zhis[3] == guan_lu:
        print("坐食伤库：时支官，发达时接近寿终。 母法总则P60-13 乙丑 丙戌 庚辰 壬午")

# 自坐食伤库
if zhi_ku(zhis[3], (shi, shang)):  
        
    if zhis[1] in (shi_di, shi_lu):
        print("坐食伤库：月支食伤当令，吉命而孤克。 母法总则P60-14 甲戌 丙子 辛卯 壬辰")
    

# 伤分析    
if '伤' in gan_shens:
    print("伤官有才华，但是清高。要生财，或者印制。")
    if '伤' in zhi_shens2:
        print("食神重成伤官，不适合伤官配印。金水、土金、木火命造更高。火土要调候，容易火炎土燥。伤官和七杀的局不适合月支为库。")
        all_ges.append('伤')
        print("伤官成格基础87生财、配印。不考虑调候逆用比顺用好，调候更重要。生正财用偏印，生偏财用正印。\n伤官配印，如果透杀，透财不佳。伤官七杀同时成格，不透财为上好命局。")

    if (gan_shens[0] == '伤' and gan_shens[1] == '伤') or (gan_shens[1] == '伤' and '伤' in zhi_shen3[1]):
        print("父母兄弟均无缘。孤苦，性刚毅好掌权。30岁以前有严重感情苦重，适合老夫少妻，继室先同居后结婚。")


    if '印' in gan_shens and ('财' not in gan_shens):
        print("伤官配印，无财，有手艺，但是不善于理财。有一定个性")
    if gan_shens[0] == '伤' and gan_shens[1] == '伤' and (not '伤' in zhi_shens2):
        print("年月天干都浮现伤官，亲属少。")

    if zhi_shens[1]  == '伤' and len(zhi5[zhis[1]]) == 1 and gan_shens[1] == '伤':
        print("月柱：伤官坐专位伤官，夫缘不定。假夫妻。比如老板和小蜜。")


    for seq, gan_ in enumerate(gan_shens):
        if gan_ != '伤':
            continue   
        if zhi_shens[seq] =='劫':
            print("伤官地支坐阳刃，力不从心 基70己酉 丁卯 甲午 辛未。背禄逐马，克官劫财。影响15年。伤官坐劫财：只适合纯粹之精明商人或严谨掌握财之人。")       
            
if shens2.count('伤') > 2:
    if options.n:        
        print("女命伤官多，即使不入伤官格，也缘分浅，多有苦情。")
    if gan_shens.count('伤') > 2:
        print("天干2伤官：性骄，六亲不靠。婚前诉说家人，婚后埋怨老公。30岁以前为婚姻危机期。")
        
    
if zhi_shens[2]  == '伤' and len(zhi5[zhis[2]]) == 1:
    print("女命婚姻宫伤官：强势克夫。男的对妻子不利。只有庚子日。")
    
if gan_shens[3]  == '伤' and me_lu == zhis[3]:
    print("伤官坐时禄：六亲不靠，无冲刑晚年发，有冲刑不发。 母法P27-96己未 壬申 己亥 庚午, 可以参三命。")

if zhis[3]  in (shang_lu, shang_di) and  zhis[1]  in (shang_lu, shang_di):
    print("月支时支食伤当令：日主无根，泄尽日主，凶。 母法P28-104 甲午 乙亥 庚戌 丙子  母法P60-104")
    
#print("shang", shang, ten_deities[shang].inverse['建'], zhi_shens)
if ten_deities[shang].inverse['建'] in zhis and options.n:
    print("女命地支伤官禄：婚姻受不得穷。")        
    
print("局", jus, "格", all_ges, )

print("\n\n《六十日用法口诀》")    
print("=========================")      
print(days60[me+zhis.day])

if me+zhis.month in months:
    print("\n\n《穷通宝鉴》")    
    print("=========================")      
    print(months[me+zhis.month])


sum_index = ''.join([me, '日', *zhus[3]])
if sum_index in summarys:
    print("\n\n《三命通会》")    
    print("=========================")      
    _block = summarys[sum_index]
    # 僅輸出通論與詩句；遇到任何「..日..时」開頭行(逐日條目)即停止
    import re as _re
    _per_day_re = _re.compile(
        r'^[甲乙丙丁戊己庚辛壬癸][子丑寅卯辰巳午未申酉戌亥]日'
        r'[甲乙丙丁戊己庚辛壬癸][子丑寅卯辰巳午未申酉戌亥]时'
    )
    _out_lines = []
    for _ln in _block.splitlines(True):
        _s = _ln.strip()
        if _s and _per_day_re.match(_s):
            break
        _out_lines.append(_ln)
    # 將段落逐行去除行首空白，統一向左對齊（保留空行）
    _normalized = ''.join((ln.lstrip() if ln.strip() else ln) for ln in _out_lines).strip()
    if _normalized:
        print(_normalized)

print("\n\n《十二时辰（初中末）出生吉凶》")    
print("=========================")      
print(chens[zhis.time])

if not options.b:
    print("\n\n大运")    
    print("="*120)  
    for dayun in yun.getDaYun()[1:]:
        gan_ = dayun.getGanZhi()[0]
        zhi_ = dayun.getGanZhi()[1]
        fu = '*' if (gan_, zhi_) in zhus else " "
        zhi5_ = ''
        for gan in zhi5[zhi_]:
            zhi5_ = zhi5_ + "{}{}　".format(gan, ten_deities[me][gan]) 
        
        zhi__ = set() # 大运地支关系
        
        for item in zhis:
        
            for type_ in zhi_atts[zhi_]:
                if item in zhi_atts[zhi_][type_]:
                    zhi__.add(type_ + ":" + item)
        zhi__ = '  '.join(zhi__)
        
        empty = chr(12288)
        if zhi_ in empties[zhus[2]]:
            empty = '空'        
        
        jia = ""
        if gan_ in gans:
            for i in range(4):
                if gan_ == gans[i]:
                    if abs(Zhi.index(zhi_) - Zhi.index(zhis[i])) == 2:
                        jia = jia + "  --夹：" +  Zhi[( Zhi.index(zhi_) + Zhi.index(zhis[i]) )//2]
                    if abs( Zhi.index(zhi_) - Zhi.index(zhis[i]) ) == 10:
                        jia = jia + "  --夹：" +  Zhi[(Zhi.index(zhi_) + Zhi.index(zhis[i]))%12]
                
        out = "{1:<4d}{2:<5s}{3} {15} {14} {13}  {4}:{5}{8}{6:{0}<6s}{12}{7}{8}{9} - {10:{0}<10s} {11}".format(
            chr(12288), dayun.getStartAge(), '', dayun.getGanZhi(),ten_deities[me][gan_], gan_,check_gan(gan_, gans), 
            zhi_, yinyang(zhi_), ten_deities[me][zhi_], zhi5_, zhi__,empty, fu, nayins[(gan_, zhi_)], ten_deities[me][zhi_]) 
        gan_index = Gan.index(gan_)
        zhi_index = Zhi.index(zhi_)
        out = out + jia + get_shens(gans, zhis, gan_, zhi_)
        
        print(out)
        zhis2 = list(zhis) + [zhi_]
        gans2 = list(gans) + [gan_]
        for liunian in dayun.getLiuNian():
            gan2_ = liunian.getGanZhi()[0]
            zhi2_ = liunian.getGanZhi()[1]
            fu2 = '*' if (gan2_, zhi2_) in zhus else " "
            #print(fu2, (gan2_, zhi2_),zhus)
            
            zhi6_ = ''
            for gan in zhi5[zhi2_]:
                zhi6_ = zhi6_ + "{}{}　".format(gan, ten_deities[me][gan])        
            
            # 大运地支关系
            zhi__ = set() # 大运地支关系
            for item in zhis2:
            
                for type_ in zhi_atts[zhi2_]:
                    if type_ == '破':
                        continue
                    if item in zhi_atts[zhi2_][type_]:
                        zhi__.add(type_ + ":" + item)
            zhi__ = '  '.join(zhi__)
            
            empty = chr(12288)
            if zhi2_ in empties[zhus[2]]:
                empty = '空'       
            out = "{1:>3d} {2:<5d}{3} {15} {14} {13}  {4}:{5}{8}{6:{0}<6s}{12}{7}{8}{9} - {10:{0}<10s} {11}".format(
                chr(12288), liunian.getAge(), liunian.getYear(), gan2_+zhi2_,ten_deities[me][gan2_], gan2_,check_gan(gan2_, gans2), 
                zhi2_, yinyang(zhi2_), ten_deities[me][zhi2_], zhi6_, zhi__,empty, fu2, nayins[(gan2_, zhi2_)], ten_deities[me][zhi2_]) 
            
            jia = ""
            if gan2_ in gans2:
                for i in range(5):
                    if gan2_ == gans2[i]:
                        zhi1 = zhis2[i]
                        if abs(Zhi.index(zhi2_) - Zhi.index(zhis2[i])) == 2:
                            # print(2, zhi2_, zhis2[i])
                            jia = jia + "  --夹：" +  Zhi[( Zhi.index(zhi2_) + Zhi.index(zhis2[i]) )//2]
                        if abs( Zhi.index(zhi2_) - Zhi.index(zhis2[i]) ) == 10:
                            # print(10, zhi2_, zhis2[i])
                            jia = jia + "  --夹：" +  Zhi[(Zhi.index(zhi2_) + Zhi.index(zhis2[i]))%12]  

                        if (zhi1 + zhi2_ in gong_he) and (gong_he[zhi1 + zhi2_] not in zhis):
                            jia = jia + "  --拱：" + gong_he[zhi1 + zhi2_]
                            
            out = out + jia + get_shens(gans, zhis, gan2_, zhi2_)
            all_zhis = set(zhis2) | set(zhi2_)
            if set('戌亥辰巳').issubset(all_zhis):
                out = out + "  天罗地网：戌亥辰巳"
            if set('寅申巳亥').issubset(all_zhis) and len(set('寅申巳亥')&set(zhis)) == 2 :
                out = out + "  四生：寅申巳亥"   
            if set('子午卯酉').issubset(all_zhis) and len(set('子午卯酉')&set(zhis)) == 2 :
                out = out + "  四败：子午卯酉"  
            if set('辰戌丑未').issubset(all_zhis) and len(set('辰戌丑未')&set(zhis)) == 2 :
                out = out + "  四库：辰戌丑未"             
            print(out)
            
        
    
    # 计算星宿
    d2 = datetime.date(1, 1, 4)
    print("星宿", lunar.getXiu(), lunar.getXiuSong())
    
    # 计算建除
    seq = 12 - Zhi.index(zhis.month)
    print(jianchus[(Zhi.index(zhis.day) + seq)%12])        
    
# 检查三会 三合的拱合
result = ''
#for i in range(2):
    #result += check_gong(zhis, i*2, i*2+1, me, gong_he)
    #result += check_gong(zhis, i*2, i*2+1, me, gong_hui, '三会拱')

result += check_gong(zhis, 1, 2, me, gong_he)
result += check_gong(zhis, 1, 2, me, gong_hui, '三会拱')
    
if result:
    print(result)

print("="*120)   



# 格局分析
ge = ''
if (me, zhis.month) in jianlus:
    print(jianlu_desc)
    print("-"*120)
    print(jianlus[(me, zhis.month)]) 
    print("-"*120 + "\n")
    ge = '建'
#elif (me == '丙' and ('丙','申') in zhus) or (me == '甲' and ('己','巳') in zhus):
    #print("格局：专财. 运行官旺 财神不背,大发财官。忌行伤官、劫财、冲刑、破禄之运。喜身财俱旺")
elif (me, zhis.month) in (('甲','卯'), ('庚','酉'), ('壬','子')):
    ge = '月刃'
else:
    zhi = zhis[1]
    if zhi in wuhangs['土'] or (me, zhis.month) in (('乙','寅'), ('丙','午'),  ('丁','巳'), ('戊','午'), ('己','巳'), ('辛','申'), ('癸','亥')):
        for item in zhi5[zhi]:
            if item in gans[:2] + gans[3:]:
                ge = ten_deities[me][item]
    else:
        d = zhi5[zhi]
        ge = ten_deities[me][max(d, key=d.get)]

# 天乙贵人
flag = False
for items in tianyis[me]:
    for item in items:
        if item in zhis:
            if not flag:
                print("| 天乙贵人：", end=' ')
                flag = True
            print(item, end=' ')
            
# 玉堂贵人
flag = False
for items in yutangs[me]:
    for item in items:
        if item in zhis:
            if not flag:
                print("| 玉堂贵人：", end=' ')
                flag = True
            print(item, end=' ')            

# 天罗
if  nayins[zhus[0]][-1] == '火':			
    if zhis.day in '戌亥':
        print("| 天罗：{}".format(zhis.day), end=' ') 

# 地网		
if  nayins[zhus[0]][-1] in '水土':			
    if zhis.day in '辰巳':
        print("| 地网：{}".format(zhis.day), end=' ') 		



# 学堂分析
for seq, item in enumerate(statuses):
    if item == '长':
        print("学堂:", zhis[seq], "\t", end=' ')
        if  nayins[zhus[seq]][-1] == ten_deities[me]['本']:
            print("正学堂:", nayins[zhus[seq]], "\t", end=' ')


#xuetang = xuetangs[ten_deities[me]['本']][1]
#if xuetang in zhis:
    #print("学堂:", xuetang, "\t\t", end=' ')
    #if xuetangs[ten_deities[me]['本']] in zhus:
        #print("正学堂:", xuetangs[ten_deities[me]['本']], "\t\t", end=' ')

# 学堂分析

for seq, item in enumerate(statuses):
    if item == '建':
        print("| 词馆:", zhis[seq], end=' ')
        if  nayins[zhus[seq]][-1] == ten_deities[me]['本']:
            print("- 正词馆:", nayins[zhus[seq]], end=' ')


ku = ten_deities[me]['库'][0]    
if ku in zhis:
    print("库：",ku, end=' ')

    for item in zhus: 
        if ku != zhus[1]:
            continue
        if nayins[item][-1] == ten_deities[me]['克']:
            print("库中有财，其人必丰厚")
        if nayins[item][-1] == ten_deities[me]['被克']:
            print(item, ten_deities[me]['被克'])
            print("绝处无依，其人必滞")    

print()

# 天元分析
for item in zhi5[zhis[2]]:    
    name = ten_deities[me][item]
    print(self_zuo[name])
print("-"*120)


# 出身分析
cai = ten_deities[me].inverse['财']
guan = ten_deities[me].inverse['官']
jie = ten_deities[me].inverse['劫']
births = tuple(gans[:2])
if cai in births and guan in births:
    birth = '不错'
#elif cai in births or guan in births:
    #birth = '较好'
else:
    birth = '一般'

guan_num = shens.count("官")
sha_num = shens.count("杀")
cai_num = shens.count("财")
piancai_num = shens.count("才")
jie_num = shens.count("劫")
bi_num = shens.count("比")
yin_num = shens.count("印")





# 食神分析
if ge == '食':
    print("\n****食神分析****: 格要日主食神俱生旺，无冲破。有财辅助财有用。  食神可生偏财、克杀")
    print(" 阳日食神暗官星，阴日食神暗正印。食神格人聪明、乐观、优雅、多才多艺。食居先，煞居后，功名显达。")
    print("======================================")  
    print('''
    喜:身旺 宜行财乡 逢食看财  忌:身弱 比 倒食(偏印)  一名进神　　二名爵星　　三名寿星
    月令建禄最佳，时禄次之，更逢贵人运
    ''')

    shi_num = shens.count("食")
    if shi_num > 2:
        print("食神过多:食神重见，变为伤官，令人少子，纵有，或带破拗性. 行印运",end=' ')
    if set(('财','食')) in set(gan_shens[:2] + zhi_shens[:2]):
        print("祖父荫业丰隆", end=' ')
    if set(('财','食')) in set(gan_shens[2:] + zhi_shens[2:]):
        print("妻男获福，怕母子俱衰绝，两皆无成", end=' ')
    if cai_num >1:
        print("财多则不清，富而已", end=' ')

    for seq, item in enumerate(gan_shens):
        if item == '食':
            if ten_deities[gans[seq]][zhis[seq]] == '墓':
                print("食入墓，即是伤官入墓，住寿难延。")  


    for seq, item in enumerate(gan_shens):
        if item == '食' or zhi_shens[seq] == '食':
            if get_empty(zhus[2],zhis[seq]):
                print("大忌空亡，更有官煞显露，为太医师巫术数九流之士，若食神逢克，又遇空亡，则不贵，再行死绝或枭运，则因食上气上生灾，翻胃噎食，缺衣食，忍饥寒而已")                     

    # 倒食分析
    if '枭' in shens and (me not in ['庚', '辛','壬']) and ten_deities[me] != '建':
        flag = True
        for item in zhi5[zhis.day]:
            if ten_deities[me]['合'] == item:
                flag = False
                break
        if flag:
            print("倒食:凡命带倒食，福薄寿夭，若有制合没事，主要为地支为天干的杀;日支或者偏印的坐支为日主的建禄状态。偏印和日支的主要成分天干合")  
            print("凡命有食遇枭，犹尊长之制我，不得自由，作事进退悔懒，有始无终，财源屡成屡败，容貌欹斜，身品琐小，胆怯心虚，凡事无成，克害六亲，幼时克母，长大伤妻子") 
            print("身旺遇此方为福")
    print()
    print("-"*120)

# 伤官分析
if ge == '伤':
    print("\n****伤官分析****: 喜:身旺,财星,印绶,伤尽 忌:身弱,无财,刑冲,入墓枭印　")
    print(" 多材艺，傲物气高，心险无忌惮，多谋少遂，弄巧成拙，常以天下之人不如己，而人亦惮之、恶之。 一名剥官神　　二名羊刃煞")
    print(" 身旺用财，身弱用印。用印不忌讳官煞。用印者须去财方能发福")
    print("官星隐显，伤之不尽，岁运再见官星，官来乘旺，再见刑冲破害，刃煞克身，身弱财旺，必主徒流死亡，五行有救，亦残疾。若四柱无官而遇伤煞重者，运入官乡，岁君又遇，若不目疾，必主灾破。")
    print("娇贵伤不起、谨慎过头了略显胆小，节俭近于吝啬")
    print("======================================")  

    if '财' in shens or '才' in shens:
        print("伤官生财")
    else:
        print("伤官无财，主贫穷")
        
    if '印' in shens or '枭' in shens:
        print('印能制伤，所以为贵，反要伤官旺，身稍弱，始为秀气;印旺极深，不必多见，偏正叠出，反为不秀，故伤轻身重而印绶多见，贫穷之格也。')   
        if '财' in shens or '才' in shens:
            print('财印相克，本不并用，只要干头两清而不相碍；又必生财者，财太旺而带印，佩印者印太重而带财，调停中和，遂为贵格')
    if ('官' in shens) :
        print(shang_guans[ten_deities[me]['本']])   
        print('金水独宜，然要财印为辅，不可伤官并透。若冬金用官，而又化伤为财，则尤为极秀极贵。若孤官无辅，或官伤并透，则发福不大矣。')
    if ('杀' in shens) :
        print("煞因伤而有制，两得其宜，只要无财，便为贵格")   
    if gan_shens[0] == '伤':
        print("年干伤官最重，谓之福基受伤，终身不可除去，若月支更有，甚于伤身七煞")

    for seq, item in enumerate(gan_shens):
        if item == '伤':
            if ten_deities[gans[seq]][zhis[seq]] == '墓':
                print("食入墓，即是伤官入墓，住寿难延。")  


    for seq, item in enumerate(gan_shens):
        if item == '食' or zhi_shens[seq] == '食':
            if get_empty(zhus[2],zhis[seq]):
                print("大忌空亡，更有官煞显露，为太医师巫术数九流之士，若食神逢克，又遇空亡，则不贵，再行死绝或枭运，则因食上气上生灾，翻胃噎食，缺衣食，忍饥寒而已")                     
    print()
    print("-"*120)    

# 劫财分析
if ge == '劫':
    print("\n****劫财(阳刃)分析****：阳刃冲合岁君,勃然祸至。身弱不作凶。")
    print("======================================")  
    if "劫" == gan_shens[3] or "劫" == zhi_shens[3]:
        print("劫财阳刃,切忌时逢,岁运并临,灾殃立至,独阳刃以时言,重于年月日也。")

    shi_num = shens.count("食")
    print("-"*120)

# 财分析

if ge == '财' or ge == '才':
    print("\n****财分析 **** 喜:旺,印,食,官 忌:比 羊刃 空绝 冲合   财星,天马星,催官星,壮志神")
    if gan_shens.count('财') + gan_shens.count('才') > 1:
        print('财喜根深，不宜太露，然透一位以清用，格所最喜，不为之露。即非月令用神，若寅透乙、卯透甲之类，一亦不为过，太多则露矣。')
        print('财旺生官，露亦不忌，盖露不忌，盖露以防劫，生官则劫退，譬如府库钱粮，有官守护，即使露白，谁敢劫之？')
    if '伤' in gan_shens:
        print("有伤官，财不能生官")    
    if '食' in shens:
        print("有财用食生者，身强而不露官，略带一位比劫，益觉有情")     
        if '印' in shens or '枭' in 'shens':
            print("注意印食冲突")  
    if '比' in shens:
        print("比不吉，但是伤官食神可化!")   
    if '杀' in shens:
        print("不论合煞制煞，运喜食伤身旺之方!")          
    
    if "财" == zhi_shens[0]:
        print("岁带正马：月令有财或伤食，不犯刑冲分夺，旺祖业丰厚。同类月令且带比，或遇运行伤劫 贫")
    if "财" == zhi_shens[3]:
        print("时带正马：无冲刑破劫，主招美妻，得外来财物，生子荣贵，财产丰厚，此非父母之财，乃身外之财，招来产业，宜俭不宜奢。")      
    if "财" == zhi_shens[2] and (me not in ('壬','癸')):
        print("天元坐财：喜印食 畏官煞，喜月令旺 ")              
    if ('官' not in shens) and ('伤' not in shens) and ('食' not in shens):
        print("财旺生官:若月令财无损克，亦主登科")


    if cai_num > 2 and ('劫' not in shens) and ('比' not in shens) \
       and ('比' not in shens) and ('印' not in shens):
        print("财　不重叠多见　财多身弱，柱无印助; 若财多身弱，柱无印助不为福。")

    if '印' in shens:
        print("先财后印，反成其福，先印后财，反成其辱是也?")      
    if '官' in gan_shens:
        print("官星显露，别无伤损，或更食生印助日主健旺，富贵双全")          
    if '财' in gan_shens and (('劫' not in shens) and ('比' not in shens)):
        print("财不宜明露")  
    for seq, item in enumerate(gan_shens):
        if item == '财':
            if ten_deities[gans[seq]][zhis[seq]] == '墓':
                print("财星入墓，必定刑妻")  
            if ten_deities[gans[seq]][zhis[seq]] == '长':   
                print("财遇长生，田园万顷")  

    if ('官' not in shens) and (('劫' in shens) or ('比' in shens)):
        print("切忌有姊妹兄弟分夺，柱无官星，祸患百出。")

    if bi_num + jie_num > 1:
        print("兄弟辈出: 纵入官乡，发福必渺.")        

    for seq, item in enumerate(zhi_shens):
        if item == '才' or ten_deities[me][zhis[seq]] == '才':
            if get_empty(zhus[2],zhis[seq]):
                print("空亡 官将不成，财将不住")  

    print("-"*120)         

# 财库分析
if ten_deities[ten_deities[me].inverse["财"]]['库'][-1] in zhis:
    print("财临库墓: 一生财帛丰厚，因财致官, 天干透土更佳")   
if cai_num < 2 and strong > 29 and (('劫' in shens) or ('比' in shens)):
    print("财少身强，柱有比劫，不为福")   




# 官分析
if ge == "官":
    print("\n**** 官分析 ****\n 喜:身旺 财印   忌：身弱 偏官 伤官 刑冲 泄气 贪合 入墓")
    print("一曰正官 二曰禄神 最忌刑冲破害、伤官七煞，贪合忘官，劫财比等等，遇到这些情况便成为破格 财印并存要分开")
    print("运：财旺印衰喜印，忌食伤生财；旺印财衰喜财，喜食伤生财；带伤食用印制；")
    print("带煞伤食不碍。劫合煞财运可行，伤食可行，身旺，印绶亦可行；伤官合煞，则伤食与财俱可行，而不宜逢印")
    print("======================================")  
    if guan_num > 1:
        print("官多变杀，以干为准")
    if "财" in shens and "印" in shens and ("伤" not in shens) and ("杀" not in shens):
        print("官星通过天干显露出来，又得到财、印两方面的扶持，四柱中又没有伤煞，行运再引到官乡，是大富大贵的命。")
    if "财" in shens or '才' in shens:
        print("有财辅助")       
    if "印" in shens or "枭" in shens:
        print("有印辅助　正官带伤食而用印制，运喜官旺印旺之乡，财运切忌。若印绶叠出，财运亦无害矣。")   
    if "食" in shens:
        print("又曰凡论官星，略见一位食神坐实，便能损局，有杀则无妨。惟月令隐禄，见食却为三奇之贵。因为食神和官相合。")    
    if "伤" in shens:
        print("伤官需要印或偏印来抑制，　有杀也无妨")         
    if "杀" in shens:
        print("伤官需要印或偏印来抑制。用劫合煞，则财运可行，伤食可行，身旺，印绶亦可行，只不过复露七煞。若命用伤官合煞，则伤食与财俱可行，而不宜逢印矣。")        

    if zhi_shens[2] in ("财","印"):
        print("凡用官，日干自坐财印，终显")           
    if zhi_shens[2] in ("伤","杀"):
        print("自坐伤、煞，终有节病")   



    # 检查天福贵人
    if (guan, ten_deities[guan].inverse['建']) in zhus:
        print("天福贵人:主科名巍峨，官职尊崇，多掌丝纶文翰之美!")

    # 天元坐禄    
    if guan in zhi5[zhis[2]]:
        print("天元作禄: 日主与官星并旺,才是贵命。大多不贵即富,即使是命局中有缺点,行到好的大运时,便能一发如雷。")
        print(tianyuans[ten_deities[me]['本']])         

    # 岁德正官
    if gan_shens[0] == '官' or zhi_shens[0] == '官':
        print("岁德正官: 必生宦族,或荫袭祖父之职,若月居财官分野,运向财官旺地,日主健旺,贵无疑矣。凡年干遇官,福气最重,发达必早。")    

    # 时上正官
    if gan_shens[0] == '官' or zhi_shens[0] == '官':
        print("时上正官: 正官有用不须多，多则伤身少则和，日旺再逢生印绶，定须平步擢高科。")        

    print()
    print("-"*120)  
# 官库分析
if ten_deities[ten_deities[me].inverse["官"]]['库'][-1] in zhis:
    print("官临库墓")   
    if lu_ku_cai[me] in zhis:
        print("官印禄库: 有官库，且库中有财")

# 杀(偏官)分析
if ge == "杀":
    print("\n杀(偏官)分析 **** 喜:身旺  印绶  合煞  食制 羊刃  比  逢煞看印及刃  以食为引   忌：身弱  财星  正官  刑冲  入墓")
    print("一曰偏官 二曰七煞 三曰五鬼 四曰将星 五曰孤极星 原有制伏,煞出为福,原无制伏,煞出为祸   性情如虎，急躁如风,尤其是七杀为丙、丁火时。")
    print("坐长生、临官、帝旺,更多带比同类相扶,则能化鬼为官,化煞为权,行运引至印乡,必发富贵。倘岁运再遇煞地,祸不旋踵。")
    print("七杀喜酒色而偏争好斗、爱轩昂而扶弱欺强")
    print("======================================")  
    if "财" in shens:
        print("逢煞看财,如身强煞弱,有财星则吉,身弱煞强,有财引鬼盗气,非贫则夭;")
    if "比" in shens:
        print("如果比比自己弱，可以先挨杀。")        
    if "食" in shens:
        print("有食神透制,即《经》云:一见制伏,却为贵本")   
        if "财" in shens or "印" in shens or '才' in shens or "枭" in shens:
            print("煞用食制，不要露财透印，以财能转食生煞，而印能去食护煞也。然而财先食后，财生煞而食以制之，或印先食后，食太旺而印制，则格成大贵。")   
    if "劫" in shens:
        print("有阳刃配合,即《经》云:煞无刃不显,逢煞看刃是也。")    
    if "印" in shens:
        print("印: 则煞生印，印生身")           
    if sha_num > 1:
        print("七煞重逢") 
        if weak:
            print("弃命从煞，须要会煞从财.四柱无一点比印绶方论，如遇运扶身旺，与煞为敌，从煞不专，故为祸患")
            print("阴干从地支，煞纯者多贵，以阴柔能从物也。阳干从地支，煞纯者亦贵，但次于阴，以阳不受制也。")
            print("水火金土皆从，惟阳木不能从，死木受斧斤，反遭其伤故也。")
            print("古歌曰：五阳坐日全逢煞，弃命相从寿不坚，如是五阴逢此地，身衰煞旺吉堪言。")            
    if "杀" == zhi_shens[2]:
        print("为人心多性急，阴险怀毒，僭伪谋害，不近人情")      
    if "杀" == zhi_shens[3] or "杀" == gan_shens[3]:
        print(" 时杀：月制干强，其煞反为权印。《经》云：时上偏官身要强，阳刃、冲刑煞敢当，制多要行煞旺运，煞多制少必为殃。")   
        print(" 一位为妙，年、月、日重见，反主辛苦劳碌。若身旺，煞制太过，喜行煞旺运，或三合煞运，如无制伏，要行制伏运方发。但忌身弱，纵得运扶持发福，运过依旧不济。")   
        print("《独步》云：时上一位，贵藏在支中，是日，主要旺强名利，方有气。")   
        print("《古歌》云：时上偏官喜刃冲，身强制伏禄丰隆。正官若也来相混，身弱财多主困穷。") 
        print("时上偏官一位强，日辰自旺喜非常。有财有印多财禄，定是天生作栋梁。") 
        print("煞临子位，必招悖逆之儿。")

    if "杀" == zhi_shens[0]:
        print(" 年上七煞：出身寒微，命有贵子。")   
        print("岁煞一位不宜制，四柱重见却宜制，日主生旺，制伏略多，喜行煞旺地，制伏太过，或煞旺身衰，官煞混杂，岁运如之，碌碌之辈。若制伏不及，运至身衰煞旺乡，必生祸患。")   
        print("《独步》云：时上一位，贵藏在支中，是日，主要旺强名利，方有气。")   
        print("《古歌》云：时上偏官喜刃冲，身强制伏禄丰隆。正官若也来相混，身弱财多主困穷。") 
        print("时上偏官一位强，日辰自旺喜非常。有财有印多财禄，定是天生作栋梁。")         
    if ('官' in shens) :
        print("官煞混杂：身弱多夭贫")

    for seq, item in enumerate(gan_shens):
        if item == '杀':
            if ten_deities[gans[seq]][zhis[seq]] == '长':   
                print("七煞遇长生乙位，女招贵夫。")  
    print()
    print("-"*120)      

# 印分析
if ge == "印":
    print("\n印分析 **** 喜:食神 天月德 七煞 逢印看煞 以官为引   忌： 刑冲 伤官 死墓 辰戊印怕木 丑未印不怕木")
    print("一曰正印 二曰魁星 三曰孙极星")
    print("以印绶多者为上,月最要,日时次之,年干虽重,须归禄月、日、时,方可取用,若年露印,月日时无,亦不济事。")
    print("======================================")  
    if "官" in shens:
        print("官能生印。身旺印强，不愁太过，只要官星清纯")      
    if "杀" in shens:
        print("喜七煞,但煞不可太多,多则伤身。原无七煞,行运遇之则发;原有七煞,行财运,或印绶死绝,或临墓地,皆凶。")    
    if "伤" in shens or "食" in shens:
        print("伤食：身强印旺，恐其太过，泄身以为秀气；若印浅身轻，而用层层伤食，则寒贫之局矣。")     
    if "财" in shens or "才" in shens:
        print("有印多而用财者，印重身强，透财以抑太过，权而用之，只要根深，无防财破。 若印轻财重，又无劫财以救，则为贪财破印，贫贱之局也。")             

    if yin_num > 1:
        print("印绶复遇拱禄、专禄、归禄、鼠贵、夹贵、时贵等格,尤为奇特,但主少子或无子,印绶多者清孤。")  
    if "劫" in shens:
        print("化印为劫；弃之以就财官")              
    print()
    print("-"*120)         
    
# 偏印分析
if ge == "枭":
    print("\n印分析 **** 喜:食神 天月德 七煞 逢印看煞 以官为引   忌： 刑冲 伤官 死墓 辰戊印怕木 丑未印不怕木")
    print("一曰正印 二曰魁星 三曰孙极星")
    print("以印绶多者为上,月最要,日时次之,年干虽重,须归禄月、日、时,方可取用,若年露印,月日时无,亦不济事。")
    print("======================================")  
    if "官" in shens:
        print("官能生印。身旺印强，不愁太过，只要官星清纯")      
    if "杀" in shens:
        print("喜七煞,但煞不可太多,多则伤身。原无七煞,行运遇之则发;原有七煞,行财运,或印绶死绝,或临墓地,皆凶。")    
    if "伤" in shens or "食" in shens:
        print("伤食：身强印旺，恐其太过，泄身以为秀气；若印浅身轻，而用层层伤食，则寒贫之局矣。")     
    if "财" in shens or "才" in shens:
        print("弃印就财。")             

    if yin_num > 1:
        print("印绶复遇拱禄、专禄、归禄、鼠贵、夹贵、时贵等格,尤为奇特,但主少子或无子,印绶多者清孤。")  
    if "劫" in shens:
        print("化印为劫；弃之以就财官")              
    print()
    print("-"*120)         



gan_ = tuple(gans)
for item in Gan:
    if gan_.count(item) == 3:
        print("三字干：", item, "--", gan3[item])
        break

gan_ = tuple(gans)
for item in Gan:
    if gan_.count(item) == 4:
        print("四字干：", item, "--", gan4[item])
        break    

zhi_ = tuple(zhis)
for item in Zhi:
    if zhi_.count(item) > 2:
        print("三字支：", item, "--", zhi3[item])
        break

print("="*120)  
print("你属:", me, "特点：--", gan_desc[me],"\n")
print("年份:", zhis[0], "特点：--", zhi_desc[zhis[0]],"\n")





# 羊刃分析
key = '帝' if Gan.index(me)%2 == 0 else '冠'

if ten_deities[me].inverse[key] in zhis:
    print("\n羊刃:", me, ten_deities[me].inverse[key])  
    print("======================")  
    if ten_deities[me].inverse['冠']:
        print("羊刃重重又见禄，富贵饶金玉。 官、印相助福相资。")  
    else:
        print("劳累命！")




# 将星分析
me_zhi = zhis[2]
other_zhis = zhis[:2] + zhis[3:]
flag = False
tmp_list = []
if me_zhi in ("申", "子", "辰"):
    if "子" in other_zhis:
        flag = True
        tmp_list.append((me_zhi, '子'))
elif me_zhi in ("丑", "巳", "酉"):
    if "酉" in other_zhis:
        flag = True   
        tmp_list.append((me_zhi, '酉'))
elif me_zhi in ("寅", "午", "戌"):
    if "午" in other_zhis:
        flag = True     
        tmp_list.append((me_zhi, '午'))
elif me_zhi in ("亥", "卯", "未"):
    if "卯" in other_zhis:
        flag = True   
        tmp_list.append((me_zhi, '卯'))

if flag:
    print("\n\n将星: 常欲吉星相扶，贵煞加临乃为吉庆。")  
    print("=========================")   
    print('''《理愚歌》云：将星若用亡神临，为国栋梁臣。言吉助之为贵，更夹贵库墓纯粹而
    不杂者，出将入相之格也，带华盖、正印而不夹库，两府之格也；只带库墓而带正印，员郎
    以上，既不带墓又不带正印，止有华盖，常调之禄也；带华印而正建驿马，名曰节印，主旌节
    之贵；若岁干库同库为两重福，主大贵。''')
    print(tmp_list)

# 华盖分析
flag = False
if me_zhi in ("申", "子", "辰"):
    if "辰" in other_zhis:
        flag = True
elif me_zhi in ("丑", "巳", "酉"):
    if "丑" in other_zhis:
        flag = True   
elif me_zhi in ("寅", "午", "戌"):
    if "戌" in other_zhis:
        flag = True     
elif me_zhi in ("亥", "卯", "未"):
    if "未" in other_zhis:
        flag = True   

if flag:
    print("\n\n华盖: 多主孤寡，总贵亦不免孤独，作僧道艺术论。")  
    print("=========================")   
    print('''《理愚歌》云：华盖虽吉亦有妨，或为孽子或孤孀。填房入赘多阙口，炉钳顶笠拔缁黄。
    又云：华盖星辰兄弟寡，天上孤高之宿也；生来若在时与胎，便是过房庶出者。''')    


# 咸池 桃花
flag = False
taohuas = []
year_zhi = zhis[0]
if me_zhi in ("申", "子", "辰") or year_zhi in ("申", "子", "辰"):
    if "酉" in zhis:
        flag = True
        taohuas.append("酉")
elif me_zhi in ("丑", "巳", "酉") or year_zhi in ("丑", "巳", "酉"):
    if "午" in other_zhis:
        flag = True   
        taohuas.append("午")
elif me_zhi in ("寅", "午", "戌") or year_zhi in ("寅", "午", "戌"):
    if "卯" in other_zhis:
        flag = True    
        taohuas.append("卯")
elif me_zhi in ("亥", "卯", "未") or year_zhi in ("亥", "卯", "未"):
    if "子" in other_zhis:
        flag = True   
        taohuas.append("子")

if flag:
    print("\n\n咸池(桃花): 墙里桃花，煞在年月；墙外桃花，煞在日时；")  
    print("=========================")   
    print('''一名败神，一名桃花煞，其神之奸邪淫鄙，如生旺则美容仪，耽酒色，疏财好欢，
    破散家业，唯务贪淫；如死绝，落魄不检，言行狡诈，游荡赌博，忘恩失信，私滥奸淫，
    靡所不为；与元辰并，更临生旺者，多得匪人为妻；与贵人建禄并，多因油盐酒货得生，
    或因妇人暗昧之财起家，平生有水厄、痨瘵之疾，累遭遗失暗昧之灾。此人入命，有破无成，
    非为吉兆，妇人尤忌之。
    咸池非吉煞，日时与水命遇之尤凶。''')  
    print(taohuas, zhis)

# 禄分析
flag = False
for item in zhus:
    if item in lu_types[me]:
        if not flag:
            print("\n\n禄分析:")  
            print("=========================")	    
        print(item,lu_types[me][item])
 

# 文星贵人
if wenxing[me] in zhis:
    print("文星贵人: ", me,  wenxing[me])  

# 天印贵人
if tianyin[me] in zhis:
    print("天印贵人: 此号天印贵，荣达受皇封", me,  tianyin[me])  


short = min(scores, key=scores.get)
# 五行建議（替代外部連結，使用內建文本，繁體顯示）
wu_xing_advices = {
    '木': (
        "1. 缺「木」\n"
        "能量象徵：顏色：綠色、青色\n"
        "方位：東方\n"
        "植物：竹子、富貴樹、萬年青等綠植\n"
        "飲食：菠菜、芹菜、韭菜等綠色蔬菜\n"
        "名字：林、森、樹、榮、松等與木相關的字\n"
        "職業：園藝、木材、教育、出版等行業"
    ),
    '火': (
        "2. 缺「火」\n"
        "能量象徵：顏色：紅色、橙色、紫色\n"
        "方位：南方\n"
        "植物：紅掌、火鶴花、太陽花\n"
        "飲食：辣椒、生薑、紅棗、肉桂等溫熱食物\n"
        "名字：炎、煜、燊、曦、晶等與火相關的字\n"
        "職業：餐飲、燈光設計、電力、電子科技等行業"
    ),
    '土': (
        "3. 缺「土」\n"
        "能量象徵：顏色：黃色、棕色、米色、咖啡色\n"
        "方位：中央、東北、西南\n"
        "植物：黃金葛、仙人掌、多肉植物\n"
        "飲食：土豆、紅薯、南瓜、胡蘿蔔、穀物等大地食物\n"
        "名字：山、峰、岩、坤、堅、田等與土相關的字\n"
        "職業：農業、房地產、建築、陶藝、環保等行業"
    ),
    '金': (
        "4. 缺「金」\n"
        "能量象徵：顏色：白色、金色、銀色\n"
        "方位：西方、西北\n"
        "植物：白蘭花、銀杏樹、金錢樹\n"
        "飲食：洋蔥、白蘿蔔、蘿蔔乾、杏仁等辛味食物\n"
        "名字：鋒、鈴、鑫、銘、鎮等與金相關的字\n"
        "職業：金融、金屬加工、珠寶設計、法律等行業"
    ),
    '水': (
        "5. 缺「水」\n"
        "能量象徵：顏色：黑色、藍色\n"
        "方位：北方\n"
        "植物：水仙花、蓮花、綠藻類植物\n"
        "飲食：西瓜、冬瓜、梨、魚類等高水分食物\n"
        "名字：泉、海、江、洋、淼等與水相關的字\n"
        "職業：航運、漁業、飲料產業、物流等行業"
    ),
}
advice_text = wu_xing_advices.get(short)
if advice_text:
    print("\n\n" + advice_text)

    
    
print("======================================")  
if '杀' in shens:
    if yinyang(me) == '+':
        print("阳杀:话多,热情外向,异性缘好")
    else:
        print("阴杀:话少,性格柔和")
if '印' in shens and '才' in shens and '官' in shens:
    print("印,偏财,官:三奇 怕正财")
if '才' in shens and '杀' in shens:
    print("男:因女致祸、因色致祸; 女:赔货")
    
if '才' in shens and '枭' in shens:
    print("偏印因偏财而不懒！")    
    
